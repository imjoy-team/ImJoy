(function(e){function t(t){for(var i,r,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)r=s[u],o[r]&&p.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={app:0},a=[];function r(e){return s.p+"static/js/"+({}[e]||e)+"."+{"chunk-2d0a3149":"7fee636a","chunk-2d0a3577":"15b80f4c","chunk-2d0a43df":"2e00c125","chunk-2d0a4b4f":"cf2112b2","chunk-2d0a4f3d":"65eb83ae","chunk-2d0aab07":"ec9eaa41","chunk-2d0aabd6":"025d95f4","chunk-2d0aba0f":"c2b07e3f","chunk-2d0abc00":"1e61764e","chunk-2d0ae937":"22b2ec66","chunk-2d0aeb45":"c571eeac","chunk-2d0afa49":"65108fc0","chunk-2d0b16cd":"b4ad1ca0","chunk-2d0b218a":"8dc69e64","chunk-2d0b2725":"10bc8cf6","chunk-2d0b2762":"7faa5aa3","chunk-2d0b5f38":"081c6449","chunk-2d0b5fd1":"52bdc432","chunk-2d0b6187":"1b01ea3f","chunk-2d0b654b":"c843792d","chunk-2d0ba136":"08ad9b83","chunk-2d0bb267":"7da55a18","chunk-2d0bcec1":"eed4b121","chunk-2d0bff92":"5eac84e3","chunk-2d0c0494":"b82491b3","chunk-2d0c06a5":"d064e94b","chunk-2d0c0a09":"ab666bda","chunk-2d0c1ed0":"c7612dd8","chunk-2d0c4313":"734ea760","chunk-2d0c46d1":"a90d3520","chunk-2d0c4db7":"4a86a74f","chunk-2d0c512b":"c2655e61","chunk-2d0c8612":"331b63ce","chunk-2d0cb76d":"ad46dcdd","chunk-2d0cf16e":"c3e2c753","chunk-2d0d056d":"34332182","chunk-2d0d0645":"5ba0a827","chunk-2d0d2b72":"e2b2cc57","chunk-2d0d2e88":"e96f4bfb","chunk-2d0d2f22":"0b0ad9f9","chunk-2d0d7804":"04ef9c4b","chunk-2d0d7e63":"967be54e","chunk-2d0daf4f":"821c9d4e","chunk-2d0db816":"a1e610fc","chunk-2d0dd64f":"2e23f35b","chunk-2d0dd7df":"2b3f72b5","chunk-2d0e1b57":"9ca83b35","chunk-2d0e1fbe":"085b36f1","chunk-2d0e22d6":"f15418dd","chunk-2d0e4510":"2835cd80","chunk-2d0e542a":"f9c1a461","chunk-2d0e57ec":"db5e2796","chunk-2d0e59b0":"d1207ecf","chunk-2d0e6553":"e43be0ff","chunk-2d0e8e3f":"8b90862a","chunk-2d0e9af6":"c32ab859","chunk-2d0ea098":"59254529","chunk-2d2076e9":"e79885ab","chunk-2d207ba3":"102cac06","chunk-2d208ac5":"b30c459d","chunk-2d208d9e":"51893d8f","chunk-2d209408":"f92607b1","chunk-2d20ee04":"507e0f0c","chunk-2d20f745":"2c8189f8","chunk-2d20ff23":"57e1f9e1","chunk-2d212fb6":"4310f723","chunk-2d2138c7":"4a97aa4a","chunk-2d21449a":"5225da90","chunk-2d217118":"23c7bd9a","chunk-2d2172c8":"587f289a","chunk-2d2174db":"aff55619","chunk-2d217aa9":"a4faecb0","chunk-2d217e5b":"40de0dd2","chunk-2d21b84a":"4bfe2261","chunk-2d21dc90":"691229f1","chunk-2d21dcd2":"64e0a422","chunk-2d21f327":"4df1e469","chunk-2d2214b3":"4f3fe061","chunk-2d221a34":"7ff16b79","chunk-2d2244a1":"7ed8779e","chunk-2d22502a":"f9b13f63","chunk-2d225f5a":"765c0a06","chunk-2d22691a":"ede69139","chunk-2d228ca6":"741b4c1c","chunk-2d2295e9":"599758ba","chunk-2d22c171":"55accc8a","chunk-2d22c2b8":"fef13e00","chunk-2d22ca58":"fe58906c","chunk-2d22d0b0":"1c2d27cd","chunk-2d23055f":"d4a713f6","chunk-2d230c43":"c09e28fb","chunk-2d2311f7":"3c951f38","chunk-2d2371be":"37f19019","chunk-2d237ee7":"3cd1af21","chunk-2d238465":"3860df71","chunk-2d238498":"2d17f147","chunk-7532b3ea":"d6aa1a5e","chunk-7a049648":"6179cd2f"}[e]+".js"}function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise(function(t,i){n=o[e]=[t,i]});t.push(n[2]=i);var a,l=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=r(e),a=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+i+": "+a+")");r.type=i,r.request=a,n[1](r)}o[e]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:c})},12e4);c.onerror=c.onload=a,l.appendChild(c)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"025e":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return assert}),__webpack_require__.d(__webpack_exports__,"c",function(){return compareVersions}),__webpack_require__.d(__webpack_exports__,"h",function(){return url_regex}),__webpack_require__.d(__webpack_exports__,"d",function(){return debounce}),__webpack_require__.d(__webpack_exports__,"g",function(){return randId}),__webpack_require__.d(__webpack_exports__,"a",function(){return _clone}),__webpack_require__.d(__webpack_exports__,"f",function(){return githubUrlRaw}),__webpack_require__.d(__webpack_exports__,"e",function(){return githubImJoyManifest});var core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_1__),_home_travis_build_oeway_ImJoy_web_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("3835"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("c5f6"),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_5__),_home_travis_build_oeway_ImJoy_web_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("53ca"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("3b2b"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9__);function assert(e,t){if(!e){if(t=t||"Assertion failed","undefined"!==typeof Error)throw new Error(t);throw t}}function compareVersions(v1,comparator,v2){if(comparator="="==comparator?"==":comparator,-1==["==","===","<","<=",">",">=","!=","!=="].indexOf(comparator))throw new Error("Invalid comparator. "+comparator);for(var v1parts=v1.split("."),v2parts=v2.split("."),maxLen=Math.max(v1parts.length,v2parts.length),part1,part2,cmp=0,i=0;i<maxLen&&!cmp;i++)part1=parseInt(v1parts[i],10)||0,part2=parseInt(v2parts[i],10)||0,part1<part2&&(cmp=1),part1>part2&&(cmp=-1);return eval("0"+comparator+cmp)}function pathJoin(){for(var e=[],t=0,n=arguments.length;t<n;t++)e=e.concat(arguments[t].split("/"));var i=[];for(t=0,n=e.length;t<n;t++){var o=e[t];o&&"."!==o&&(".."===o?i.pop():i.push(o))}return""===e[0]&&i.unshift(""),i.join("/")||(i.length?"/":".")}function dirName(e){return pathJoin(e,"..")}var arrAnimals=["Aardvark","Albatross","Alligator","Alpaca","Ant","Anteater","Antelope","Ape","Armadillo","Ass_Donkey","Baboon","Badger","Barracuda","Bat","Bear","Beaver","Bee","Bison","Boa","Buffalo","Butterfly","Camel","Capybara","Caribou","Cassowary","Cat","Caterpillar","Cattle","Chamois","Cheetah","Chicken","Chimpanzee","Chinchilla","Chough","Clam","Cobra","Cockroach","Cod","Cormorant","Coyote","Crab","Crane","Crocodile","Crow","Curlew","Deer","Dinosaur","Dog","Dogfish","Dolphin","Donkey","Dotterel","Dove","Dragonfly","Duck","Dugong","Dunlin","Eagle","Echidna","Eel","Eland","Elephant","Elephantseal","Elk","Emu","Falcon","Ferret","Finch","Fish","Flamingo","Fox","Frog","Gaur","Gazelle","Gerbil","GiantPanda","Giraffe","Gnat","Gnu","Goat","Goose","Goldfinch","Goldfish","Gorilla","Goshawk","Grasshopper","Grouse","Guanaco","Guineafowl","Guineapig","Gull","Hamster","Hare","Hawk","Hedgehog","Heron","Herring","Hippopotamus","Hornet","Horse","Human","Hummingbird","Hyena","Ibex","Ibis","Jackal","Jaguar","Jay","Jellyfish","Kangaroo","Kingfisher","Koala","Komodo","Kookabura","Kouprey","Kudu","Lapwing","Lark","Lemur","Leopard","Lion","Llama","Lobster","Locust","Loris","Louse","Lyrebird","Magpie","Mallard","Manatee","Mandrill","Mantis","Marten","Meerkat","Mink","Mole","Mongoose","Monkey","Moose","Mouse","Mosquito","Mule","Narwhal","Newt","Nightingale","Octopus","Okapi","Opossum","Oryx","Ostrich","Otter","Owl","Ox","Oyster","Panther","Parrot","Partridge","Peafowl","Pelican","Penguin","Pheasant","Pig","Pigeon","PolarBear","Pony","Porcupine","Porpoise","PrairieDog","Quail","Quelea","Quetzal","Rabbit","Raccoon","Rail","Ram","Rat","Raven","Reddeer","Redpanda","Reindeer","Rhinoceros","Rook","Salamander","Salmon","SandDollar","Sandpiper","Sardine","Scorpion","Sealion","SeaUrchin","Seahorse","Seal","Shark","Sheep","Shrew","Skunk","Snail","Snake","Sparrow","Spider","Spoonbill","Squid","Squirrel","Starling","Stingray","Stinkbug","Stork","Swallow","Swan","Tapir","Tarsier","Termite","Tiger","Toad","Trout","Turkey","Turtle","Vicuï¿½a","Viper","Vulture","Wallaby","Walrus","Wasp","Waterbuffalo","Weasel","Whale","Wolf","Wolverine","Wombat","Woodcock","Woodpecker","Worm","Wren","Yak","Zebra"],arrColours=["almond","amaranthine","amber","amethyst","antique","apple","apricot","aqua","aquamarine","argent","auburn","avocado","azure","babyblue","banana","battleshipgray","bay","beige","Bermudagreen","beryl","biceblue","bicegreen","bice","biscuit","bisque","black","blanchedalmond","blazeorange","blonde","bloodred","bluegreen","blueviolet","blue","blueberry","bone","bottlegreen","brass","brickred","bronzeyellow","bronze","brown","buckskin","buff","burgundy","burlywood","burntorange","burntsienna","burntumber","butterscotch","cadetblue","Cambridgeblue","canary","cardinal","carmine","carnation","carnelian","carroty","celadon","cerise","cerulean","chamois","champagne","charcoal","chartreuse","cherryred","chestnut","Chinesered","chocolate","cinereous","cinnabar","cinnamon","citrine","clairdelune","claret","coalblack","cobaltblue","cocoa","coffee","coolgray","Copenhagenblue","copper","coral","cornflowerblue","cornflower","cornsilk","cream","crimson","cupreous","cyan","daffodil","damask","dandelion","dovegray","duckeggblue","dun","Dodgerblue","eaudenil","ebony","ecru","eggshellblue","eggshell","electricblue","emeraldgreen","emerald","fawn","federalyellow","firebrick","fireenginered","flame","flamingo","flaxen","flesh","floralwhite","forestgreen","fuchsia","fuscous","gainsboro","gamboge","garnet","gentianblue","gentianviolet","geranium","ginger","glaucous","gold","goldenbrown","goldenrod","goldochre","grape","grassgreen","gray","green","grizzle","gules","gunmetalgray","hazel","heather","heliotrope","henna","hepatic","hoar","honey","honeydew","hotpink","huntergreen","iceblue","incarnadine","Indianred","indigo","internationalorange","irongray","ivory","jadegreen","jade","jet","jonquil","kellygreen","Kendalgreen","khaki","khakigreen","lapislazuli","laurelgreen","lavender","lemonchiffon","lemon","lilac","lime","Lincolngreen","linen","liver","loden","lovat","macaroniandcheese","madder","magenta","magicmint","magnolia","mahogany","malachite","maroon","mauve","mazarine","melon","midnightblue","mignonette","militarygrey","mint","mintcream","mistyrose","moccasin","mocha","mossgreen","mulberry","mustard","natural","navajowhite","navy","Nileblue","Nilegreen","oak","oatmeal","oceangrey","ochre","offwhite","oldgold","oldlace","olivedrab","olive","orange","orchid","outerspace","oxblood","Oxfordblue","oyster","pansy","paprika","Parisgreen","patina","peagreen","peach","peacockblue","pearlgray","pearly","periwinkle","perse","petrolblue","petunia","pewter","pillarboxred","pinegreen","pink","pistachiogreen","platinumblond","platinum","plum","Pompeianred","poppy","powderblue","primrose","Prussianblue","puce","puke","purple","purpure","quartz","quince","raspberry","rawsienna","redviolet","red","reseda","riflegreen","robin_seggblue","rose","rouge","royalblue","royalpurple","ruby","russet","rust","sable","saddlebrown","safetyorange","saffron","sagegreen","salmon","sand","sandy","sanguine","sapphire","sard","saxeblue","scarlet","schoolbusyellow","seagreen","seashell","sepia","shockingpink","sienna","silver","silvergray","skyblue","slate","slateblack","slateblue","slategray","smoke","snow","sorrel","springgreen","stammel","steelblue","stone","straw","strawberry","sulfur","sunflower","tan","tangerine","taupe","taxiyellow","teak","teal","terracotta","timberwolf","titian","topaz","towcolored","Turkeyred","turquoise","Tyrianpurple","ultramarine","umber","Vandykebrown","venetianred","verdant","vermilion","vert","violetred","violet","virid","viridian","vividorange","walnut","Wedgewoodblue","wheat","wheaten","white","wine","xanthic","yellow","zaffre"],expression=/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,url_regex=new RegExp(expression);function debounce(e,t,n){var i;return function(){var o=this,a=arguments,r=function(){i=null,n||e.apply(o,a)},s=n&&!i;clearTimeout(i),i=setTimeout(r,t),s&&e.apply(o,a)}}function animalGenerator(){var e=arrAnimals[Math.floor(Math.random()*arrAnimals.length)].toLowerCase();return e}function colourGenerator(){var e=arrColours[Math.floor(Math.random()*arrColours.length)].toLowerCase();return e}function randId(){return Math.random().toString(36).substr(2,10)}function _clone(e){if(!e)return e;var t,n,i;for(i in t=Array.isArray(e)?[]:{},e)n=e[i],t[i]="object"===Object(_home_travis_build_oeway_ImJoy_web_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_6__["a"])(n)?_clone(n):n;return t}var Filters={getPixels:function(e){var t=e,n=t.getContext("2d");return n.getImageData(0,0,t.width,t.height)},filterImage:function(e,t){for(var n=[e],i=2;i<arguments.length;i++)n.push(arguments[i]);return t.apply(null,n)},grayscale:function(e){for(var t=e.data,n=0;n<t.length;n+=4){var i=t[n],o=t[n+1],a=t[n+2],r=.2126*i+.7152*o+.0722*a;t[n]=t[n+1]=t[n+2]=r}return e},brightness:function(e,t,n){for(var i,o=e.data,a=0;a<o.length;a+=4)i=parseInt((o[a]-t)*n),i>255?i=255:i<0&&(i=0),o[a]=i,o[a+1]=i,o[a+2]=i,o[a+3]=255;return e},min_max:function(e){for(var t=e.data,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=0,a=0;a<t.length;a+=4)t[a]<n&&(n=t[a]),t[a]>i&&(i=t[a]),o+=t[a]/(t.length/4);return{min:n,max:i,avg:o}},lut:function(e,t){for(var n,i=e.data,o=0;o<i.length;o+=4)n=i[o],i[o]=t[n][0],i[o+1]=t[n][1],i[o+2]=t[n][2],i[o+3]=255;return e}},protocolAndDomainRE=/^(?:\w+:)?\/\/(\S+)$/,localhostDomainRE=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,nonLocalhostDomainRE=/^[^\s\.]+\.\S{2,}$/;function isUrl(e){if("string"!==typeof e)return!1;var t=e.match(protocolAndDomainRE);if(!t)return!1;var n=t[1];return!!n&&!(!localhostDomainRE.test(n)&&!nonLocalhostDomainRE.test(n))}var laxUrlRegex=/(?:(?:[^:]+:)?[\/][\/])?(?:.+@)?([^\/]+)([\/][^?#]+)/;function githubUrlToObject(e,t){var n={};if(t=t||{},!e)return null;if(e.url&&(e=e.url),"string"!==typeof e)return null;var i=e.match(/^([\w-_]+)\/([\w-_\.]+)(?:#([\w-_\.]+))?$/),o=e.match(/^github:([\w-_]+)\/([\w-_\.]+)(?:#([\w-_\.]+))?$/),a=e.match(/^git@[\w-_\.]+:([\w-_]+)\/([\w-_\.]+)$/);if(i)n.user=i[1],n.repo=i[2],n.branch=i[3]||"master",n.host="github.com";else if(o)n.user=o[1],n.repo=o[2],n.branch=o[3]||"master",n.host="github.com";else if(a)n.user=a[1],n.repo=a[2].replace(/\.git$/i,""),n.branch="master",n.host="github.com";else{if(e=e.replace(/^git\+/,""),!isUrl(e))return null;var r=e.match(laxUrlRegex)||[],s=Object(_home_travis_build_oeway_ImJoy_web_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__["a"])(r,3),l=s[1],c=s[2];if(!l)return null;if("github.com"!==l&&"www.github.com"!==l&&!t.enterprise)return null;var u=c.match(/^\/([\w-_]+)\/([\w-_\.]+)(\/tree\/[\w-_\.\/]+)?(\/blob\/[\w-_\.\/]+)?/);if(!u)return null;n.user=u[1],n.repo=u[2].replace(/\.git$/i,""),n.host=l||"github.com",u[3]&&/^\/tree\/master\//.test(u[3])?(n.branch="master",n.path=u[3].replace(/\/$/,"")):u[3]?n.branch=u[3].replace(/^\/tree\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:u[4]?n.branch=u[4].replace(/^\/blob\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:n.branch="master"}return"github.com"===n.host?n.apiHost="api.github.com":n.apiHost="".concat(n.host,"/api/v3"),n.tarball_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo,"/tarball/").concat(n.branch),n.clone_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),"master"===n.branch?(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/master.zip")):(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/blob/").concat(n.branch),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo,"?branch=").concat(n.branch),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/").concat(n.branch,".zip")),n.path&&(n.https_url+=n.path),n.api_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo),n}function githubUrlRaw(e){if(!e.includes("blob")||!e.includes("github"))return null;var t=githubUrlToObject(e),n=t.user,i=t.repo,o=new RegExp("^https://github.com/"+n+"/"+i+"/blob/","g"),a=e.replace(o,"");return"https://raw.githubusercontent.com/"+n+"/"+i+"/"+a}function githubImJoyManifest(e){var t=githubUrlToObject(e),n=t.user,i=t.repo,o=t.branch;return"https://raw.githubusercontent.com/"+n+"/"+i+"/"+o+"/manifest.imjoy.json"}var hot_lut=[[10,0,0],[13,0,0],[15,0,0],[18,0,0],[21,0,0],[23,0,0],[26,0,0],[28,0,0],[31,0,0],[34,0,0],[36,0,0],[39,0,0],[42,0,0],[44,0,0],[47,0,0],[49,0,0],[52,0,0],[55,0,0],[57,0,0],[60,0,0],[63,0,0],[65,0,0],[68,0,0],[70,0,0],[73,0,0],[76,0,0],[78,0,0],[81,0,0],[84,0,0],[86,0,0],[89,0,0],[91,0,0],[94,0,0],[97,0,0],[99,0,0],[102,0,0],[105,0,0],[107,0,0],[110,0,0],[112,0,0],[115,0,0],[118,0,0],[120,0,0],[123,0,0],[126,0,0],[128,0,0],[131,0,0],[133,0,0],[136,0,0],[139,0,0],[141,0,0],[144,0,0],[147,0,0],[149,0,0],[152,0,0],[154,0,0],[157,0,0],[160,0,0],[162,0,0],[165,0,0],[168,0,0],[170,0,0],[173,0,0],[175,0,0],[178,0,0],[181,0,0],[183,0,0],[186,0,0],[189,0,0],[191,0,0],[194,0,0],[196,0,0],[199,0,0],[202,0,0],[204,0,0],[207,0,0],[210,0,0],[212,0,0],[215,0,0],[217,0,0],[220,0,0],[223,0,0],[225,0,0],[228,0,0],[231,0,0],[233,0,0],[236,0,0],[238,0,0],[241,0,0],[244,0,0],[246,0,0],[249,0,0],[252,0,0],[254,0,0],[255,2,0],[255,5,0],[255,7,0],[255,10,0],[255,12,0],[255,15,0],[255,18,0],[255,20,0],[255,23,0],[255,26,0],[255,28,0],[255,31,0],[255,33,0],[255,36,0],[255,39,0],[255,41,0],[255,44,0],[255,47,0],[255,49,0],[255,52,0],[255,54,0],[255,57,0],[255,60,0],[255,62,0],[255,65,0],[255,68,0],[255,70,0],[255,73,0],[255,75,0],[255,78,0],[255,81,0],[255,83,0],[255,86,0],[255,89,0],[255,91,0],[255,94,0],[255,96,0],[255,99,0],[255,102,0],[255,104,0],[255,107,0],[255,110,0],[255,112,0],[255,115,0],[255,117,0],[255,120,0],[255,123,0],[255,125,0],[255,128,0],[255,131,0],[255,133,0],[255,136,0],[255,138,0],[255,141,0],[255,144,0],[255,146,0],[255,149,0],[255,151,0],[255,154,0],[255,157,0],[255,159,0],[255,162,0],[255,165,0],[255,167,0],[255,170,0],[255,172,0],[255,175,0],[255,178,0],[255,180,0],[255,183,0],[255,186,0],[255,188,0],[255,191,0],[255,193,0],[255,196,0],[255,199,0],[255,201,0],[255,204,0],[255,207,0],[255,209,0],[255,212,0],[255,214,0],[255,217,0],[255,220,0],[255,222,0],[255,225,0],[255,228,0],[255,230,0],[255,233,0],[255,235,0],[255,238,0],[255,241,0],[255,243,0],[255,246,0],[255,249,0],[255,251,0],[255,254,0],[255,255,2],[255,255,6],[255,255,10],[255,255,14],[255,255,18],[255,255,22],[255,255,26],[255,255,30],[255,255,34],[255,255,38],[255,255,42],[255,255,46],[255,255,50],[255,255,54],[255,255,58],[255,255,62],[255,255,65],[255,255,69],[255,255,73],[255,255,77],[255,255,81],[255,255,85],[255,255,89],[255,255,93],[255,255,97],[255,255,101],[255,255,105],[255,255,109],[255,255,113],[255,255,117],[255,255,121],[255,255,125],[255,255,128],[255,255,132],[255,255,136],[255,255,140],[255,255,144],[255,255,148],[255,255,152],[255,255,156],[255,255,160],[255,255,164],[255,255,168],[255,255,172],[255,255,176],[255,255,180],[255,255,184],[255,255,188],[255,255,191],[255,255,195],[255,255,199],[255,255,203],[255,255,207],[255,255,211],[255,255,215],[255,255,219],[255,255,223],[255,255,227],[255,255,231],[255,255,235],[255,255,239],[255,255,243],[255,255,247],[255,255,251],[255,255,255]]},"034f":function(e,t,n){"use strict";var i=n("c21b"),o=n.n(i);o.a},"049c":function(e,t,n){"use strict";var i=n("4fb9"),o=n.n(i);o.a},"0d59":function(e,t,n){"use strict";var i=n("ea64"),o=n.n(i);o.a},"0e4f":function(e,t,n){},1:function(e,t){},"27e7":function(e,t,n){"use strict";var i=n("321f"),o=n.n(i);o.a},"321f":function(e,t,n){},"4fb9":function(e,t,n){},5337:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var i=n("a026"),o=n("8c4f"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("md-app-toolbar",{staticClass:"md-primary"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("navbar")],1)]),n("div",{staticClass:"md-toolbar-row md-layout md-alignment-center-center"},[n("div",{staticClass:"banner-container"},[n("img",{attrs:{src:"static/img/perspective-hr.jpg",alt:"banner"}}),n("div",{staticClass:"subtitle"},[e._v("Image processing with joy!"),n("br"),n("md-button",{staticClass:"md-raised",on:{click:function(t){e.$router.push("/app")}}},[e._v("Start ImJoy App")]),n("md-button",{staticClass:"md-raised",attrs:{href:"/docs"}},[e._v("Docs")])],1)])]),n("br"),n("md-dialog",{attrs:{"md-active":e.showDialog},on:{"update:mdActive":function(t){e.showDialog=t}}},[n("md-dialog-title",[e._v("Getting Started with ImJoy")]),n("md-dialog-content",[n("p",[e._v("With the ImJoy web app, you process your images within the browser, instantly, no installation.")]),n("md-button",{staticClass:"md-raised md-primary",on:{click:function(t){e.$router.push("/app")}}},[e._v("Start")]),n("p",[e._v("You can process your data with the Imjoy app locally and anonymously, by default, no data will be transferred to the internet (also depends on the plugin you installed).")])],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showDialog=!1}}},[e._v("OK")])],1)],1),n("br"),n("plugin-list",{attrs:{display:"card","config-url":"https://raw.githubusercontent.com/oeway/ImJoy-Plugins/master/manifest.imjoy.json",title:"Plugins"}}),n("br"),n("md-divider"),n("main-footer")],1)},r=[],s={name:"home",data:function(){return{showDialog:!1}},created:function(){this.store=this.$root.$data.store},mounted:function(){this.$nextTick(function(){})},methods:{}},l=s,c=(n("c4a1"),n("2877")),u=Object(c["a"])(l,a,r,!1,null,"4c6ec4d0",null);u.options.__file="Home.vue";var d=u.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"imjoy noselect"},[e._m(0),n("md-app",[n("md-app-toolbar",{staticClass:"md-dense",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[e.menuVisible?e._e():n("md-button",{staticClass:"md-primary md-icon-button",on:{click:function(t){e.menuVisible=!0}}},[n("md-icon",[e._v("menu")])],1),e.menuVisible?e._e():n("md-button",{staticClass:"md-small-hide site-title",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title",attrs:{src:"static/img/imjoy-logo-black.svg",alt:"ImJoy"}}),n("span",{staticClass:"superscript md-small-hide"},[e._v("beta")]),n("md-tooltip",[e._v("ImJoy home")])],1),"single"===e.window_mode&&e.windows.length>0?n("md-menu",[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("picture_in_picture")])],1),n("md-menu-content",e._l(e.windows,function(t){return n("md-menu-item",{key:t.id,attrs:{disabled:e.selected_window===t},on:{click:function(n){e.selectWindow(t)}}},[n("span",[e._v(e._s(t.name.slice(0,30)+"(#"+t.i+")"))]),n("md-icon",[e._v("forward")])],1)}))],1):e._e(),e.status_text&&e.status_text.length?n("md-button",{staticClass:"status-text md-small-hide",class:e.status_text.includes("rror")?"error-message":"",on:{click:function(t){e.showAlert(e.status_text)}}},[e._v("\n          "+e._s(e.status_text.slice(0,80)+(e.status_text.length>80?"...":""))+"\n        ")]):n("span",{staticClass:"subheader-title md-medium-hide",staticStyle:{flex:"1"}},[e._v("Image Processing with Joy!")])],1),n("div",{staticClass:"md-toolbar-section-end"},[n("md-snackbar",{staticClass:"md-accent",attrs:{"md-position":"center","md-active":e.show_snackbar,"md-duration":e.snackbar_duration},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[n("span",[e._v(e._s(e.snackbar_info))]),n("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("close")])],1),n("md-button",{staticClass:"md-icon-button",on:{click:e.closeAll}},[n("md-icon",[e._v("cancel")]),n("md-tooltip",[e._v("Close all windows")])],1),n("md-button",{staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[e._v("save")]),n("md-tooltip",[e._v("Save all windows")])],1),n("md-button",{staticClass:"md-icon-button",attrs:{href:"/docs/",target:"_blank"}},[n("md-icon",[e._v("help")])],1),e.engine_connected?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",class:e.engine_connected?"md-primary":"md-accent",attrs:{"md-menu-trigger":""},on:{click:function(t){e.updateEngineStatus()}}},[n("md-icon",[e._v(e._s(e.engine_connected?"sync":"sync_disabled"))]),n("md-tooltip",[e._v("Connection to the Plugin Engine")])],1),n("md-menu-content",[n("md-menu-item",{attrs:{disabled:!0}},[n("span",[e._v("ðŸš€"+e._s(e.engine_status.connection))])]),n("md-menu-item",{on:{click:function(t){e.disconnectEngine()}}},[n("span",[e._v("Disconnect")]),n("md-icon",[e._v("clear")])],1),n("md-menu-item",{on:{click:function(t){e.showPluginEngineInfo=!0}}},[n("span",[e._v("About Plugin Engine")]),n("md-icon",[e._v("info")])],1),n("md-divider"),n("md-menu-item",{attrs:{disabled:!0}},[n("span",[e._v("Plugin Engine Processes")]),n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(t){t.stopPropagation(),e.updateEngineStatus()}}},[n("md-icon",[e._v("autorenew")])],1)],1),e._l(e.engine_status.plugin_processes,function(t){return n("md-menu-item",{key:t.pid},[n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.killPluginProcess(t)}}},[n("md-icon",[e._v("clear")])],1),e._v("\n              "+e._s(t.name)+" (#"+e._s(t.pid)+")\n            ")],1)}),e.engine_status.plugin_num>1?n("md-menu-item",{attrs:{disabled:!0}},[n("span",[e._v(e._s(e.engine_status.plugin_num)+" Running Plugins")]),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(t){t.stopPropagation(),e.killPluginProcess()}}},[n("md-icon",[e._v("clear")])],1)],1):e._e(),0===e.engine_status.plugin_num?n("md-menu-item",{attrs:{disabled:!0}},[n("span",[e._v(" No plugin process is running")])]):e._e()],2)],1):n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(t){e.showPluginEngineInfo=!0}}},[n("md-icon",[e._v("ðŸš€")]),n("md-tooltip",[e._v("Connect to the Plugin Engine")])],1)],1),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"folder_form"},[n("input",{ref:"folder_select",staticClass:"md-file",attrs:{type:"file",webkitdirectory:"",mozdirectory:"",msdirectory:"",odirectory:"",directory:"",multiple:""},on:{change:e.selectFileChanged}})]),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_form"},[n("input",{ref:"file_select",staticClass:"md-file",attrs:{type:"file",multiple:""},on:{change:e.selectFileChanged}})])]),n("md-app-drawer",{attrs:{"md-active":e.menuVisible,"md-persistent":"full"},on:{"update:mdActive":function(t){e.menuVisible=t}}},[n("md-speed-dial",{staticClass:"md-top-left speed-dial",attrs:{"md-event":"hover","md-effect":"scale","md-direction":"bottom"}},[n("md-speed-dial-target",{staticClass:"md-primary"},[n("md-icon",{staticClass:"speed-dial-icon"},[e._v("add")])],1),n("md-speed-dial-content",[e.engine_connected?n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(t){e.showEngineFileDialog()}}},[n("md-icon",[e._v("add_to_queue")]),n("md-tooltip",[e._v("Load files through the Python Plugin Engine")])],1):e._e(),n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(t){e.$refs.file_form.reset(),e.$refs.file_select.click()}}},[n("md-icon",[e._v("insert_drive_file")]),n("md-tooltip",[e._v("Open a file")])],1),n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(t){e.$refs.folder_form.reset(),e.$refs.folder_select.click()}}},[n("md-icon",[e._v("folder_open")]),n("md-tooltip",[e._v("Open a folder")])],1)],1)],1),n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"site-button site-title",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title",attrs:{src:"static/img/imjoy-logo-black.svg",alt:"ImJoy"}}),n("span",{staticClass:"superscript"},[e._v("beta")])])],1),n("div",{staticClass:"md-toolbar-section-end"},[n("md-menu",[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("widgets")]),n("md-tooltip",[e._v("Current workspace: "+e._s(e.selected_workspace))])],1),n("md-menu-content",[e._l(e.workspace_list,function(t){return n("md-menu-item",{key:t,attrs:{disabled:t===e.selected_workspace},on:{click:function(n){e.switchWorkspace(t)}}},[n("span",[e._v(e._s(t))]),n("md-icon",[e._v("forward")]),n("md-tooltip",[e._v("Switch to workspace: "+e._s(t)+" ")])],1)}),n("md-divider"),n("md-menu-item",{on:{click:function(t){e.showWorkspaceDialog=!0}}},[n("md-icon",[e._v("view_list")]),e._v("Workspaces\n              ")],1)],2)],1),n("md-button",{staticClass:"md-icon-button md-dense md-raised",on:{click:function(t){e.menuVisible=!e.menuVisible}}},[n("md-icon",[e._v("keyboard_arrow_left")])],1)],1)]),n("br"),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-layout md-gutter md-alignment-center-space-between"},[n("div",{staticClass:"md-layout-item md-size-70"},[n("md-button",{class:e.workflow_expand?"":"md-primary",on:{click:function(t){e.workflow_expand=!e.workflow_expand}}},[n("span",{staticClass:"md-subheading"},[n("md-icon",[e._v("format_list_bulleted")]),e._v("Workflow")],1)])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.workflow_expand,expression:"workflow_expand"}],staticClass:"md-layout-item"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.clearWorkflow()}}},[n("md-icon",[e._v("clear")]),n("md-tooltip",[e._v("Clear workflow")])],1)],1)])]),n("md-card-content",{directives:[{name:"show",rawName:"v-show",value:e.workflow_expand,expression:"workflow_expand"}]},[e.plugin_loaded&&!e.updating_workflow?n("joy",{ref:"workflow",attrs:{config:e.workflow_joy_config}}):e._e(),e.plugin_loaded?n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.runWorkflow(e.workflow_joy_config.joy)}}},[n("md-icon",[e._v("play_arrow")]),e._v("Run\n            "),n("md-tooltip",[e._v("run the workflow")])],1):e._e(),e.plugin_loaded?n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.saveWorkflow(e.workflow_joy_config.joy)}}},[n("md-icon",[e._v("save")]),e._v("Save\n            "),n("md-tooltip",[e._v("save the workflow")])],1):e._e(),n("md-menu",{attrs:{"md-size":"big"}},[n("md-button",{staticClass:"md-button md-primary",attrs:{disabled:0===e.workflow_list.length,"md-menu-trigger":""}},[n("md-icon",[e._v("more_horiz")]),e._v(" Load\n              "),n("md-tooltip",[e._v("load a workflow")])],1),n("md-menu-content",e._l(e.workflow_list,function(t){return n("md-menu-item",{key:t.name,on:{click:function(n){e.loadWorkflow(t)}}},[n("span",[e._v(e._s(t.name))]),n("md-button",{staticClass:"md-icon-button",on:{click:function(n){n.stopPropagation(),e.shareWorkflow(t)}}},[n("md-icon",[e._v("share")])],1),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.removeWorkflow(t)}}},[n("md-icon",[e._v("clear")])],1)],1)}))],1)],1)],1),e.plugin_loaded?n("div",[n("md-card",[n("md-card-header",[n("div",{staticClass:"md-layout md-gutter md-alignment-center-space-between"},[n("div",{staticClass:"md-layout-item md-size-70"},[n("md-button",{staticClass:"md-raised",class:e.installed_plugins.length>0?"":"md-primary",on:{click:function(t){e.showPluginManagement()}}},[n("md-icon",[e._v("add")]),e._v("Plugins\n                ")],1)],1),n("div",{staticClass:"md-layout-item"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.reloadPlugins()}}},[n("md-icon",[e._v("autorenew")]),n("md-tooltip",[e._v("Reload/restart all the plugins")])],1)],1)])]),n("md-card-content",[e._l(e.sortedRunnablePlugins(),function(t){return n("div",{key:t.name},[n("md-divider"),n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-icon-button",class:t.running?"md-accent":"",attrs:{"md-menu-trigger":""}},[t.initializing?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":20,"md-mode":"indeterminate"}}):t.config.icon?n("md-icon",[e._v(e._s(t.config.icon))]):n("md-icon",[e._v("extension")]),n("md-tooltip",[e._v(e._s(t.config.description))])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showDoc(t.id)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.sharePlugin(t.id)}}},[n("md-icon",[e._v("share")]),e._v("Share\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.editPlugin(t.id)}}},[n("md-icon",[e._v("edit")]),e._v("Edit\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.reloadPlugin(t.config)}}},[n("md-icon",[e._v("autorenew")]),e._v("Reload\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.unloadPlugin(t)}}},[n("md-icon",[e._v("clear")]),e._v("Terminate\n                  ")],1),t.config.origin?n("md-menu-item",{on:{click:function(n){e.updatePlugin(t.id)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Update\n                  ")],1):e._e(),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.plugin2_remove=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Remove\n                  ")],1)],1)],1),n("md-button",{staticClass:"joy-run-button",class:t.running?"md-accent":t._disconnected&&"native-python"===t.type?"disconnected-plugin":"md-primary",attrs:{disabled:t._disconnected&&"native-python"!=t.type},on:{click:function(n){t._disconnected?e.connectPlugin(t):e.runOp(t.ops[t.name])}}},[e._v("\n                "+e._s("native-python"===t.type?t.name+" ðŸš€":t.name)+"\n              ")]),t._disconnected?e._e():n("md-button",{staticClass:"md-icon-button",on:{click:function(n){t.panel_expanded=!t.panel_expanded,e.$forceUpdate()}}},[t.panel_expanded?n("md-icon",[e._v("expand_less")]):n("md-icon",[e._v("expand_more")])],1),t.running&&t.progress?n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":t.progress}}):e._e(),t.running&&t.status_text?n("p",[e._v(e._s(t.status_text))]):e._e(),e._l(t.ops,function(i){return n("div",{key:i.plugin_id+i.name},[n("md-button",{directives:[{name:"show",rawName:"v-show",value:t.panel_expanded&&i.name!=t.name,expression:"plugin.panel_expanded && op.name != plugin.name"}],staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[e._v("chevron_right")])],1),n("md-button",{directives:[{name:"show",rawName:"v-show",value:t.panel_expanded&&i.name!=t.name,expression:"plugin.panel_expanded && op.name != plugin.name"}],staticClass:"joy-run-button md-primary op-button",class:t.running?"md-accent":"md-primary",attrs:{disabled:t._disconnected},on:{click:function(t){e.runOp(i)}}},[e._v("\n                    "+e._s(i.name)+"\n                ")]),n("joy",{attrs:{config:i,show:t.panel_expanded||!1}}),n("md-divider")],1)})],2)}),n("md-divider"),n("div",e._l(e.sortedNonRunnablePlugins(),function(t){return n("div",{key:t.name},[n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-icon-button",class:t.running?"md-accent":"",attrs:{"md-menu-trigger":""}},[t.initializing?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":20,"md-mode":"indeterminate"}}):t.config.icon?n("md-icon",[e._v(e._s(t.config.icon))]):n("md-icon",[e._v("extension")]),n("md-tooltip",[e._v(e._s(t.config.description))])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showDoc(t.id)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.sharePlugin(t.id)}}},[n("md-icon",[e._v("share")]),e._v("Share\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.editPlugin(t.id)}}},[n("md-icon",[e._v("edit")]),e._v("Edit\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.reloadPlugin(t.config)}}},[n("md-icon",[e._v("autorenew")]),e._v("Reload\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.unloadPlugin(t)}}},[n("md-icon",[e._v("clear")]),e._v("Terminate\n                    ")],1),t.config.origin?n("md-menu-item",{on:{click:function(n){e.updatePlugin(t.id)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Update\n                    ")],1):e._e(),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.plugin2_remove=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Remove\n                    ")],1)],1)],1),n("md-button",{staticClass:"joy-run-button",class:t.running?"md-accent":t._disconnected&&"native-python"===t.type?"disconnected-plugin":"",attrs:{disabled:"native-python"!=t.type||!t._disconnected},on:{click:function(n){e.connectPlugin(t)}}},[e._v("\n                  "+e._s("native-python"===t.type?t.name+" ðŸš€":t.name)+"\n                ")]),n("md-button",{staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[e._v("visibility_off")])],1),n("md-divider")],1)})),n("md-divider"),e.installed_plugins.length<=0?n("p",[e._v("Â No plugin installed.")]):e._e()],2)],1)],1):e._e()],1),n("md-app-content",{staticClass:"whiteboard-content"},[n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":e.progress}}),n("whiteboard",{attrs:{mode:e.window_mode,selected_window:e.selected_window,windows:e.windows,loaders:e.registered&&e.registered.loaders},on:{add:e.windowAdded,close:e.onCloseWindow,select:e.windowSelected}})],1)],1),n("md-dialog-confirm",{attrs:{"md-active":e.showRemoveConfirmation,"md-title":"Removing Plugin","md-content":"Do you really want to <strong>delete</strong> this plugin","md-confirm-text":"Yes","md-cancel-text":"Cancel"},on:{"update:mdActive":function(t){e.showRemoveConfirmation=t},"md-cancel":function(t){e.showRemoveConfirmation=!1},"md-confirm":function(t){e.removePlugin(e.plugin2_remove),e.plugin2_remove=null,e.showRemoveConfirmation=!1}}}),n("file-dialog",{ref:"file-dialog",attrs:{"list-files":e.listEngineDir,"get-file-url":e.getFileUrl}}),n("md-dialog",{attrs:{"md-active":e.showPluginDialog,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.showPluginDialog=t}}},[n("md-dialog-content",[e.plugin_dialog_config?n("div",[n("joy",{ref:"plugin_dialog_joy",attrs:{config:e.plugin_dialog_config,showHeader:!1,controlButtons:!1}})],1):e._e()]),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.closePluginDialog(!0)}}},[e._v("OK")]),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.closePluginDialog(!1)}}},[e._v("Cancel")])],1)],1),n("md-dialog",{attrs:{"md-active":e.showWorkspaceDialog,"md-click-outside-to-close":!0},on:{"update:mdActive":function(t){e.showWorkspaceDialog=t}}},[n("md-dialog-title",[e._v("Workspace Management")]),n("md-dialog-content",[n("md-toolbar",{staticClass:"md-dense",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-field",[n("label",{attrs:{for:"workspace_name"}},[e._v("Workspace Name")]),n("md-input",{attrs:{type:"text",placeholder:"Create a new workspace",name:"workspace_name"},model:{value:e.new_workspace_name,callback:function(t){e.new_workspace_name=t},expression:"new_workspace_name"}})],1)],1),n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.switchWorkspace(e.new_workspace_name),e.showWorkspaceDialog=!1}}},[n("md-icon",[e._v("add")]),e._v("New")],1)],1)]),n("md-list",{staticClass:"md-double-line md-dense"},e._l(e.workspace_list,function(t){return n("md-list-item",{key:t},[n("span",[e._v(e._s(t))]),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[e._v("more_horiz")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showWorkspaceDialog=!1,e.switchWorkspace(t)}}},[n("md-icon",[e._v("forward")]),e._v(" Switch\n                ")],1),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.removeWorkspace(t)}}},[n("md-icon",[e._v("delete")]),e._v(" Delete\n                ")],1)],1)],1)],1)}))],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showWorkspaceDialog=!1}}},[e._v("OK")])],1)],1),n("md-dialog-confirm",{attrs:{"md-active":e.showPermissionConfirmation,"md-title":"Confirmation Required","md-content":e.permission_message,"md-confirm-text":"Deny","md-cancel-text":"Allow"},on:{"update:mdActive":function(t){e.showPermissionConfirmation=t},"md-cancel":function(t){e.showPermissionConfirmation=!1,e.processPermission(!0)},"md-confirm":function(t){e.showPermissionConfirmation=!1,e.processPermission(!1)}}}),n("md-dialog-alert",{attrs:{"md-active":e.showShareUrl,"md-content":e.share_url_message,"md-confirm-text":"Close"},on:{"update:mdActive":function(t){e.showShareUrl=t}}}),n("md-dialog",{attrs:{"md-active":e.showPluginEngineInfo,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.showPluginEngineInfo=t}}},[n("md-dialog-title",[e._v("Using the Python Plugin Engine")]),n("md-dialog-content",[n("p",[e._v("\n          Python plugins are supported by ImJoy with the Python Plugin Engine. "),n("br"),n("br"),e._v("\n          If this is your first time to use ImJoy Plugin Engine, please "),n("a",{attrs:{href:"https://github.com/oeway/ImJoy-App/releases",target:"_blank"}},[e._v("click here")]),e._v(" to download the ImJoy Desktop App.\n          "),n("br"),e._v(" If you have it already, please start the Plugin Engine, and connect to it."),n("br")]),n("md-field",[n("label",{attrs:{for:"engine_url"}},[e._v("Plugin Engine URL")]),n("md-input",{attrs:{type:"text",name:"engine_url"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.connectEngine(e.engine_url)}},model:{value:e.engine_url,callback:function(t){e.engine_url=t},expression:"engine_url"}})],1),n("md-field",[n("label",{attrs:{for:"connection_token"}},[e._v("Connection Token")]),n("md-input",{attrs:{type:"text",name:"connection_token"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.connectEngine(e.engine_url)}},model:{value:e.connection_token,callback:function(t){e.connection_token=t},expression:"connection_token"}})],1),n("p",[e._v("Â "+e._s(e.engine_status.connection))]),n("p",[e._v("\n          If you failed to install or start the Plugin Engine, please consult "),n("a",{attrs:{href:"https://github.com/oeway/ImJoy-Engine",target:"_blank"}},[e._v("here")]),e._v(", and choose the alternative solution."),n("br")])],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showPluginEngineInfo=!1}}},[e._v("Cancel")]),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showPluginEngineInfo=!1,e.connectEngine(e.engine_url)}}},[e._v("Connect")])],1)],1),n("md-dialog",{attrs:{"md-active":e.showSettingsDialog,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.showSettingsDialog=t}}},[n("md-dialog-title",[e._v("General Settings")]),n("md-dialog-content",[n("md-divider")],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showSettingsDialog=!1}}},[e._v("OK")])],1)],1),n("md-dialog",{attrs:{"md-active":e.showAddPluginDialog,"md-click-outside-to-close":!1},on:{"update:mdActive":function(t){e.showAddPluginDialog=t}}},[n("md-dialog-title",[e._v("ImJoy Plugin Management")]),n("md-dialog-content",[e.show_plugin_templates?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Create a New Plugin")])]),n("md-card-content",e._l(e.plugin_templates,function(t,i){return n("md-button",{key:i,staticClass:"md-primary md-raised centered-button",on:{click:function(n){e.newPlugin(t),e.showAddPluginDialog=!1}}},[n("md-icon",[e._v("add")]),e._v(e._s(i)+"\n          ")],1)}))],1):e._e(),e.installed_plugins.length>0&&!e.plugin4install&&!e.downloading_error&&!e.downloading_plugin?n("md-switch",{model:{value:e.show_installed_plugins,callback:function(t){e.show_installed_plugins=t},expression:"show_installed_plugins"}},[e._v("Show Installed Plugins")]):e._e(),e.show_installed_plugins?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Installed Plugins")])]),n("md-card-content",[n("plugin-list",{attrs:{display:"list",name:"Installed Plugins",description:"",database:e.db,"install-plugin":e.installPlugin,"remove-plugin":e.removePlugin,plugins:e.installed_plugins,workspace:e.selected_workspace},on:{message:e.showMessage}})],1)],1):e._e(),e.show_plugin_url?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Install from URL")]),n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("md-field",{staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[e._v("cloud_download")]),n("md-input",{attrs:{placeholder:"Please paste the URL here and press enter.",type:"text",name:"plugin_url"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.tag4install="",e.getPlugin4Install(e.plugin_url)}},model:{value:e.plugin_url,callback:function(t){e.plugin_url=t},expression:"plugin_url"}}),n("md-tooltip",[e._v("Press `Enter` to get the plugin")])],1)],1)],1)],1):e._e(),e.downloading_plugin&&!e.plugin4install?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":40,"md-mode":"indeterminate"}}):e._e(),e.downloading_error?n("h2",[e._v("Â Â "+e._s(e.downloading_error))]):e._e(),e.plugin4install?n("md-card",[n("md-card-header",[n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("h2",[e.plugin4install.icon?n("md-icon",[e._v(e._s(e.plugin4install.icon))]):n("md-icon",[e._v("extension")]),e._v("\n                "+e._s("native-python"===e.plugin4install.type?e.plugin4install.name+" ðŸš€":e.plugin4install.name)+"\n              ")],1)]),e.tag4install?n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.installPlugin(e.plugin4install,e.tag4install),e.showAddPluginDialog=!1,e.clearPluginUrl()}}},[n("md-icon",[e._v("cloud_download")]),e._v("Install\n                "),n("md-tooltip",[e._v("Install "+e._s(e.plugin4install.name)+" (tag=`"+e._s(e.tag4install)+"`)")])],1)],1):n("div",{staticClass:"md-toolbar-section-end"},[e.plugin4install.tags&&e.plugin4install.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("cloud_download")]),e._v("Install\n                  "),n("md-tooltip",[e._v("Choose a tag to install "+e._s(e.plugin4install.name))])],1),n("md-menu-content",e._l(e.plugin4install.tags,function(t){return n("md-menu-item",{key:t,on:{click:function(n){e.installPlugin(e.plugin4install,t),e.showAddPluginDialog=!1,e.clearPluginUrl()}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(t)+"\n                  ")],1)}))],1):n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.installPlugin(e.plugin4install),e.showAddPluginDialog=!1,e.clearPluginUrl()}}},[n("md-icon",[e._v("cloud_download")]),e._v("Install\n              ")],1)],1)])],1),n("md-card-content",[n("p",[e._v(e._s(e.plugin4install.description))]),e._l(e.plugin4install.tags,function(t){return n("md-chip",{key:t,class:e.tag4install===t?"md-primary":"",on:{click:function(n){e.tag4install=t}}},[e._v(e._s(t))])}),n("br"),e.plugin4install.code?n("md-switch",{model:{value:e.show_plugin_source,callback:function(t){e.show_plugin_source=t},expression:"show_plugin_source"}},[e._v("Show plugin source code")]):e._e(),n("p",[e._v("This plugin is "),n("strong",[e._v("NOT")]),e._v(" provided by ImJoy.io. Please make sure the plugin is provided by a trusted source, otherwise it may "),n("strong",[e._v("harm")]),e._v(" your computer.\n          ")]),e.show_plugin_source?n("plugin-editor",{staticClass:"code-editor",attrs:{title:e.plugin4install.name},model:{value:e.plugin4install.code,callback:function(t){e.$set(e.plugin4install,"code",t)},expression:"plugin4install.code"}}):e._e()],2)],1):e._e(),e.show_plugin_store?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Install from the plugin repository")]),n("md-chips",{staticClass:"md-primary shake-on-error",attrs:{"md-placeholder":"Add a repository url (e.g. GITHUB REPO) and press enter."},on:{"md-insert":e.addRepository,"md-delete":function(t){e.removeRepository(e.getRepository(t))}},scopedSlots:e._u([{key:"md-chip",fn:function(t){var i=t.chip;return[e.selected_repository&&i===e.selected_repository.name?n("strong",{staticClass:"md-primary"},[e._v(e._s(i))]):n("div",{on:{click:function(t){e.selectRepository(i)}}},[e._v(e._s(i))])]}}]),model:{value:e.repository_names,callback:function(t){e.repository_names=t},expression:"repository_names"}},[e.selected_repository?n("div",{staticClass:"md-helper-text"},[e._v(e._s(e.selected_repository.name)+": "+e._s(e.selected_repository.description))]):e._e()])],1),n("md-card-content",[n("plugin-list",{attrs:{database:e.db,"install-plugin":e.installPlugin,"remove-plugin":e.removePlugin,"init-search":e.init_plugin_search,display:"list",plugins:e.available_plugins,workspace:e.selected_workspace},on:{message:e.showMessage}})],1)],1):e._e()],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showAddPluginDialog=!1,e.clearPluginUrl()}}},[e._v("Exit")])],1)],1)],1)},m=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{visibility:"hidden",opacity:"0"},attrs:{id:"dropzone"}},[n("div",{attrs:{id:"textnode"}},[e._v("Drop files to add data.")])])}],h=n("53ca"),f=(n("b54a"),n("456d"),n("5df3"),n("aef6"),n("28a5"),n("3835")),g=(n("96cf"),n("1da1")),_=(n("f559"),n("3b2b"),n("4917"),n("6b54"),n("6762"),n("2fdb"),n("ac4d"),n("8a81"),n("ac6a"),n("a481"),n("f751"),n("7f7f"),n("bc3a")),v=n.n(_),w=n("d6e1"),b=n("2440"),y=n("783b"),k=n.n(y),C=new k.a,x=["env","requirements","dependencies","icon","ui","type","flags"],P=["web-worker","native-python","web-python","iframe","window","collection"],j='\n<docs>\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "web-worker",\n  "tags": [],\n  "ui": "",\n  "version": "0.1.0",\n  "api_version": "0.1.2",\n  "url": "",\n  "description": "[TODO: describe this plugin with one sentense.]",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "env": "",\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="javascript">\nclass ImJoyPlugin {\n  async setup() {\n\n  }\n\n  async run(my) {\n    console.log(\'running in the plugin \', my)\n\n  }\n}\n\napi.export(new ImJoyPlugin())\n<\/script>\n\n',E='\n<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "window",\n  "tags": [],\n  "ui": "",\n  "version": "0.1.0",\n  "api_version": "0.1.2",\n  "description": "[TODO: describe this plugin with one sentense.]",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "env": "",\n  "requirements": [],\n  "dependencies": [],\n  "defaults": {"w": 7, "h": 7}\n}\n</config>\n\n<script lang="javascript">\nclass ImJoyPlugin {\n  async setup() {\n\n  }\n\n  async run(my) {\n    console.log(\'running in the plugin \', my)\n\n  }\n}\n\napi.export(new ImJoyPlugin())\n<\/script>\n\n<window lang="html">\n  <div>\n    <p>\n    Hello World\n    </p>\n  </div>\n</window>\n\n<style lang="css">\n\n</style>\n',O='\n<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "native-python",\n  "version": "0.1.0",\n  "api_version": "0.1.2",\n  "description": "[TODO: describe this plugin with one sentense.]",\n  "tags": [],\n  "ui": "",\n  "inputs": null,\n  "outputs": null,\n  "flags": [],\n  "icon": "extension",\n  "env": "",\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="python">\nimport numpy as np\nclass ImJoyPlugin():\n    def setup(self):\n        print(\'setup in python\')\n\n    def run(self, my):\n        print(\'hello world.\')\n        return my\n\napi.export(ImJoyPlugin())\n<\/script>\n',D='\n<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "web-python",\n  "version": "0.1.0",\n  "api_version": "0.1.2",\n  "description": "[TODO: describe this plugin with one sentense.]",\n  "tags": [],\n  "ui": "UI for this plugin",\n  "inputs": null,\n  "outputs": null,\n  "flags": [],\n  "icon": "extension",\n  "env": "",\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="python">\n\nclass ImJoyPlugin():\n    def setup(self):\n        print(\'setup in python\')\n\n    def run(self, my):\n        print(\'hello world.\')\n\napi.export(ImJoyPlugin())\n<\/script>\n',S=C.compile({properties:{_id:{type:["null","string"]},name:{type:"string"},code:{type:"string"},lang:{type:["null","string"]},script:{type:["null","string"]}}}),I=C.compile({properties:{name:{type:"string"},type:{type:"string"},ui:{type:["null","string","array","object"]},inputs:{type:["null","object"]},outputs:{type:["null","object"]}}}),$=C.compile({properties:{name:{type:"string"},type:{type:"string"},config:{type:"object"},data:{type:["null","object"]},panel:{type:["null","object"]}}}),M=(C.compile({properties:{name:{type:"string"},type:{type:"string"},ui:{type:["null","string","array","object"]},run:{type:["null","string"]},inputs:{type:["null","object"]},outputs:{type:["null","object"]}}}),n("025e")),W=(n("0d6d"),/\r?\n/g),R=/^\s*$/,A=/^(\r?\n)*[\t\s]/,T=function(e){if(!A.test(e))return e;for(var t,n,i,o=e.split(W),a=1/0,r=0;r<o.length;r++){var s=o[r];if(!R.test(s))if(t)n=U(s,t),n<a&&(a=n);else{if(i=s.charAt(0)," "!==i&&"\t"!==i)return e;t=i,n=U(s,t),n<a&&(a=n)}}return o.map(function(e){return e.slice(a)}).join("\n")};function U(e,t){var n=0;while(e.charAt(n)===t)n++;return n}Object.freeze({});Object.prototype.toString;function L(e,t){for(var n=Object.create(null),i=e.split(","),o=0;o<i.length;o++)n[i[o]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}L("slot,component",!0),L("key,ref,slot,slot-scope,is");Object.prototype.hasOwnProperty;function N(e){var t=Object.create(null);return function(n){var i=t[n];return i||(t[n]=e(n))}}var F=/-(\w)/g;N(function(e){return e.replace(F,function(e,t){return t?t.toUpperCase():""})});function z(e,t){function n(n){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n}function q(e,t){return e.bind(t)}Function.prototype.bind;var B=function(e,t,n){return!1};L("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),L("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source");var J=L("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),V=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,H="[a-zA-Z_][\\w\\-\\.]*",K="((?:"+H+"\\:)?"+H+")",G=new RegExp("^<"+K),Y=/^\s*(\/?)>/,X=new RegExp("^<\\/"+K+"[^>]*>"),Q=/^<!DOCTYPE [^>]+>/i,Z=/^<!\--/,ee=/^<!\[/,te=!1;"x".replace(/x(.)?/g,function(e,t){te=""===t});var ne=L("script,style,textarea",!0),ie={},oe={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t"},ae=/&(?:lt|gt|quot|amp);/g,re=/&(?:lt|gt|quot|amp|#10|#9);/g,se=L("pre,textarea",!0),le=function(e,t){return e&&se(e)&&"\n"===t[0]};function ce(e,t){var n=t?re:ae;return e.replace(n,function(e){return oe[e]})}function ue(e,t){var n,i,o=[],a=t.expectHTML,r=t.isUnaryTag||B,s=t.canBeLeftOpenTag||B,l=0;while(e){if(n=e,i&&ne(i)){var c=0,u=i.toLowerCase(),d=ie[u]||(ie[u]=new RegExp("([\\s\\S]*?)(</"+u+"[^>]*>)","i")),p=e.replace(d,function(e,n,i){return c=i.length,ne(u)||"noscript"===u||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),le(u,n)&&(n=n.slice(1)),t.chars&&t.chars(n),""});l+=e.length-p.length,e=p,j(u,l-c,l)}else{var m=e.indexOf("<");if(0===m){if(Z.test(e)){var h=e.indexOf("--\x3e");if(h>=0){t.shouldKeepComment&&t.comment(e.substring(4,h)),C(h+3);continue}}if(ee.test(e)){var f=e.indexOf("]>");if(f>=0){C(f+2);continue}}var g=e.match(Q);if(g){C(g[0].length);continue}var _=e.match(X);if(_){var v=l;C(_[0].length),j(_[1],v,l);continue}var w=x();if(w){P(w),le(i,e)&&C(1);continue}}var b=void 0,y=void 0,k=void 0;if(m>=0){y=e.slice(m);while(!X.test(y)&&!G.test(y)&&!Z.test(y)&&!ee.test(y)){if(k=y.indexOf("<",1),k<0)break;m+=k,y=e.slice(m)}b=e.substring(0,m),C(m)}m<0&&(b=e,e=""),t.chars&&b&&t.chars(b)}if(e===n){t.chars&&t.chars(e),!o.length&&t.warn&&t.warn('Mal-formatted tag at end of template: "'+e+'"');break}}function C(t){l+=t,e=e.substring(t)}function x(){var t=e.match(G);if(t){var n,i,o={tagName:t[1],attrs:[],start:l};C(t[0].length);while(!(n=e.match(Y))&&(i=e.match(V)))C(i[0].length),o.attrs.push(i);if(n)return o.unarySlash=n[1],C(n[0].length),o.end=l,o}}function P(e){var n=e.tagName,l=e.unarySlash;a&&("p"===i&&J(n)&&j(i),s(n)&&i===n&&j(n));for(var c=r(n)||!!l,u=e.attrs.length,d=new Array(u),p=0;p<u;p++){var m=e.attrs[p];te&&-1===m[0].indexOf('""')&&(""===m[3]&&delete m[3],""===m[4]&&delete m[4],""===m[5]&&delete m[5]);var h=m[3]||m[4]||m[5]||"",f="a"===n&&"href"===m[1]?t.shouldDecodeNewlinesForHref:t.shouldDecodeNewlines;d[p]={name:m[1],value:ce(h,f)}}c||(o.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:d}),i=n),t.start&&t.start(n,d,c,e.start,e.end)}function j(e,n,a){var r,s;if(null==n&&(n=l),null==a&&(a=l),e&&(s=e.toLowerCase()),e){for(r=o.length-1;r>=0;r--)if(o[r].lowerCasedTag===s)break}else r=0;if(r>=0){for(var c=o.length-1;c>=r;c--)(c>r||!e)&&t.warn&&t.warn("tag <"+o[c].tag+"> has no matching end tag."),t.end&&t.end(o[c].tag,n,a);o.length=r,i=r&&o[r-1].tag}else"br"===s?t.start&&t.start(e,[],!0,n,a):"p"===s&&(t.start&&t.start(e,[],!1,n,a),t.end&&t.end(e,n,a))}j()}var de=/\r?\n/g,pe=/./g;L("script,style,template",!0);function me(e,t){void 0===t&&(t={});var n={script:[],style:[],config:[],window:[],docs:[],attachment:[],link:[],others:[]},i=0,o=null;function a(e,t,a,s,l){0===i&&(o={type:e,content:"",start:l,attrs:t.reduce(function(e,t){var n=t.name,i=t.value;return e[n]=i||!0,e},{})},n[e]?(r(o,t),n[e].push(o)):n.others.push(o)),a||i++}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];"lang"===i.name&&(e.lang=i.value),"scoped"===i.name&&(e.scoped=!0),"module"===i.name&&(e.module=i.value||!0),"src"===i.name&&(e.src=i.value)}}function s(n,a,r){if(1===i&&o){o.end=a;var s=T(e.slice(o.start,o.end));"template"!==o.type&&t.pad&&(s=l(o,t.pad)+s),o.content=s,o=null}i--}function l(t,n){if("space"===n)return e.slice(0,t.start).replace(pe," ");var i=e.slice(0,t.start).split(de).length,o="script"!==t.type||t.lang?"\n":"//\n";return Array(i).join(o)}return ue(e,{start:a,end:s}),n}var he=n("8055"),fe=n.n(he),ge=n("2ef0"),_e=n.n(ge),ve=n("65d2"),we=new k.a,be={name:"imjoy",props:["title"],data:function(){return{workflow_expand:!1,selected_window:null,window_mode:"grid",file_select:null,folder_select:null,selected_file:null,selected_files:null,showPluginDialog:!1,showSettingsDialog:!1,showAddPluginDialog:!1,showRemoveConfirmation:!1,showPermissionConfirmation:!1,permission_message:"No permission message.",share_url_message:"No url",showShareUrl:!1,resolve_permission:null,reject_permission:null,plugin_dialog_config:null,plugin_dialog_promise:{},plugin2_remove:null,is_https_mode:!0,plugin_url:null,downloading_plugin:!1,downloading_error:"",plugin4install:null,tag4install:"",show_plugin_source:!1,init_plugin_search:null,show_plugin_templates:!0,show_plugin_store:!0,show_plugin_url:!0,show_installed_plugins:!1,loading:!1,progress:0,status_text:"",engine_connected:!1,engine_url:"http://127.0.0.1:8080",engine_status:{connection:"Disconnected"},windows:[],active_windows:[],selected_workspace:null,connection_token:null,engine_session_id:null,showPluginEngineInfo:!1,workspace_list:[],workflow_list:[],repository_list:[],repository_names:[],selected_repository:null,showWorkspaceDialog:!1,show_file_dialog:!1,plugins:null,registered:null,updating_workflow:!1,installed_plugins:[],available_plugins:[],plugin_api:null,plugin_context:null,plugin_loaded:!1,menuVisible:!0,snackbar_info:"",snackbar_duration:3e3,show_snackbar:!1,screenWidth:1024}},watch:{menuVisible:function(){for(var e=this.windows.length;e--;)try{this.windows[e].resize()}catch(t){}}},created:function(){var e=this;this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.event_bus.$on("resize",this.updateSize),this.updateSize({width:window.innerWidth}),this.window_ids={},this.plugin_names=null,this.db=null,this.client_id=null,this.IMJOY_PLUGIN={_id:"IMJOY_APP"},this.plugin_templates={"Web Worker (JS)":j,"Window (HTML/CSS/JS)":E,"Native Python":O,"Web Python (experimental)":D},this.default_window_pos={i:0,x:0,y:0,w:5,h:5},this.new_workspace_name="",this.workflow_joy_config={expanded:!0,name:"Workflow",ui:"{id:'workflow', type:'ops'}"},window.addEventListener("dragover",function(e){e.preventDefault(),document.querySelector("#dropzone").style.visibility="",document.querySelector("#dropzone").style.opacity=1,document.querySelector("#textnode").style.fontSize="48px"}),window.addEventListener("dragenter",function(e){e.preventDefault(),document.querySelector("#dropzone").style.visibility="",document.querySelector("#dropzone").style.opacity=1,document.querySelector("#textnode").style.fontSize="48px"}),window.addEventListener("dragleave",function(e){e.preventDefault(),document.querySelector("#dropzone").style.visibility="hidden",document.querySelector("#dropzone").style.opacity=0,document.querySelector("#textnode").style.fontSize="42px"});var t=function(t){return new Promise(function(n,i){var o=[],a=!1,r=function e(t,i,a,r){if(i=i||"",t.isFile)t.file(function(e){e.relativePath=i+e.name,e.loaders=a(e),o.push(e),r&&n(o)});else if(t.isDirectory){var s=t.createReader();s.readEntries(function(n){for(var o=0;o<n.length;o++)e(n[o],i+t.name+"/",a,r&&o===n.length-1)})}else r&&n(o)},s=t.dataTransfer.items.length;if(0!==s){for(var l=0;l<s;l++)if(t.dataTransfer.items[l].webkitGetAsEntry){a=!0;var c=t.dataTransfer.items[l].webkitGetAsEntry();r(c,null,e.getDataLoaders,l===s-1)}e.selected_files=a?o:t.dataTransfer.files}else i()})};window.addEventListener("drop",function(n){n.preventDefault(),document.querySelector("#dropzone").style.visibility="hidden",document.querySelector("#dropzone").style.opacity=0,document.querySelector("#textnode").style.fontSize="42px",t(n).then(e.loadFiles)})},beforeRouteLeave:function(e,t,n){if(this.windows&&this.windows.length>0){var i=window.confirm("Do you really want to leave? you have unsaved changes!");i?n():n(!1)}else n()},mounted:function(){var e=this;if(this.is_https_mode="https:"===location.protocol,setInterval(function(){e.$forceUpdate()},5e3),this.client_id=localStorage.getItem("imjoy_client_id"),this.client_id||(this.client_id="imjoy_web_"+Object(M["g"])(),localStorage.setItem("imjoy_client_id",this.client_id)),this.engine_session_id=Object(M["g"])(),this.$route.query.token||this.$route.query.t){this.connection_token=(this.$route.query.token||this.$route.query.t).trim();var t=Object.assign({},this.$route.query);delete t.token,delete t.t,this.$router.replace({query:t})}else this.connection_token=localStorage.getItem("imjoy_connection_token");this.$route.query.engine||this.$route.query.e?this.engine_url=(this.$route.query.engine||this.$route.query.e).trim():this.engine_url=localStorage.getItem("imjoy_engine_url")||"http://127.0.0.1:8080",this.imjoy_api={alert:this.showAlert,register:this.register,createWindow:this.createWindow,updateWindow:this.updateWindow,showDialog:this.showDialog,showProgress:this.showProgress,showStatus:this.showStatus,run:this.runPlugin,call:this.callPlugin,getPlugin:this.getPlugin,showPluginProgress:this.showPluginProgress,showPluginStatus:this.showPluginStatus,showFileDialog:this.showFileDialog,showSnackbar:this.showSnackbar,setConfig:this.setPluginConfig,getConfig:this.getPluginConfig,getAttachment:this.getAttachment,getFileUrl:this.getFileUrl,getFilePath:this.getFilePath,exportFile:this.exportFile,utils:{$forceUpdate:this.$forceUpdate,openUrl:this.openUrl,sleep:this.sleep}},this.resetPlugins(),this.pluing_context={},this.plugin_loaded=!1,this.loading=!0,this.config_db=new w["a"]("imjoy_config",{revs_limit:2,auto_compaction:!0}),this.default_repository_list=[{name:"ImJoy Repository",url:"oeway/ImJoy-Plugins",description:"The official plugin repository provided by ImJoy.io."},{name:"ImJoy Demos",url:"oeway/ImJoy-Demo-Plugins",description:"A set of demo plugins provided by ImJoy.io"}],this.config_db.get("repository_list").then(function(t){e.repository_list=t.list;var n=!0,i=!1,o=void 0;try{for(var a,r=e.default_repository_list[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value,l=!1,c=!0,u=!1,d=void 0;try{for(var p,m=e.repository_list[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var h=p.value;if(h.url===s.url&&h.name===s.name){l=h;break}}}catch(f){u=!0,d=f}finally{try{c||null==m.return||m.return()}finally{if(u)throw d}}l||e.addRepository(s)}}catch(f){i=!0,o=f}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}}).catch(function(t){"not_found"!=t.name&&console.error("Database Error",t),e.repository_list=e.default_repository_list,e.config_db.put({_id:"repository_list",list:e.repository_list})}).then(function(){e.repository_names=[];var t=!0,n=!1,i=void 0;try{for(var o,a=e.repository_list[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;e.repository_names.push(r.name)}}catch(l){n=!0,i=l}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}if(e.$route.query.repo||e.$route.query.r){var s=e.addRepository(e.$route.query.repo||e.$route.query.r);s&&(e.selected_repository=s)}else e.selected_repository=e.repository_list[0]});var n=null;this.config_db.get("workspace_list").then(function(t){e.workspace_list=t.list,n=t.default}).catch(function(t){"not_found"!=t.name&&console.error("Database Error",t),e.config_db.put({_id:"workspace_list",list:["default"],default:"default"}),e.workspace_list=["default"],n="default"}).then(function(){e.selected_workspace=e.$route.query.workspace||e.$route.query.w||n,e.workspace_list.includes(e.selected_workspace)&&e.selected_workspace==n||(e.workspace_list.includes(e.selected_workspace)||e.workspace_list.push(e.selected_workspace),e.config_db.get("workspace_list").then(function(t){e.config_db.put({_id:t._id,_rev:t._rev,list:e.workspace_list,default:"default"})}).catch(function(t){e.showMessage("Database Error:"+t.toString()),e.status_text="Database Error:"+t.toString()})),e.db=new w["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.connectEngine(e.engine_url,!0)}).then(function(){e.reloadPlugins().then(function(){e.reloadRepository().finally(function(){if(e.$route.query.plugin||e.$route.query.p){var t=(e.$route.query.plugin||e.$route.query.p).trim();t.match(M["h"])||t.includes("/")&&t.includes(":")?(e.plugin_url=t,e.init_plugin_search=null,e.show_plugin_store=!1,e.show_plugin_url=!1,e.getPlugin4Install(t)):(e.plugin_url=null,e.init_plugin_search=t,e.show_plugin_store=!0,e.show_plugin_url=!1),e.show_plugin_templates=!1,e.showAddPluginDialog=!0}if(e.$route.query.workflow){var n=ve["a"].decodeWorkflow(e.$route.query.workflow);n?(e.workflow_joy_config.data=n,e.workflow_expand=!0):console.log("failed to workflow")}if(e.$route.query.load||e.$route.query.l){var i={name:"Loaded Url",type:"imjoy/url_list",scroll:!0,data:[e.$route.query.load||e.$route.query.l]};e.addWindow(i)}})})})},beforeDestroy:function(){for(var e in this.plugins)if(this.plugins.hasOwnProperty(e)){var t=this.plugins[e];try{"function"===typeof t.terminate&&t.terminate()}catch(n){}}this.plugins=null,this.plugin_names=null,this.disconnectEngine()},methods:{updateSize:function(e){this.screenWidth=e.width,this.screenWidth>800?this.window_mode="grid":this.window_mode="single"},getRepository:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.repository_list[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}},selectRepository:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.repository_list[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return this.selected_repository=r,this.reloadRepository(),r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}},getRepoManifest:function(e,t){return new Promise(function(n,i){var o,a,r=new RegExp("^[^/.]+/[^/.]+$");e.match(r)?(a=e,t&&(e=e+"/tree/"+t,a=a+"@"+t),o=Object(M["e"])("https://github.com/"+e)):e.includes("github")&&e.includes("/blob/")?(o=Object(M["e"])(e),a=o):(o=e,a=o),v.a.get(o).then(function(e){if(e&&e.data&&e.data.plugins){var t=e.data;t.plugins=t.plugins.filter(function(e){return!e.disabled}),t.uri_root.startsWith("http")||(t.uri_root=o.replace(new RegExp("manifest.imjoy.json$"),_e.a.trim(t.uri_root,"/")));for(var r=0;r<t.plugins.length;r++){var s=t.plugins[r];s.uri=s.uri||s.name+".imjoy.html",s.origin=a+":"+s.name,s.uri.startsWith(t.uri_root)||s.uri.startsWith("http")||(s.uri=t.uri_root+"/"+s.uri),s._id=s._id||s.name.replace(/ /g,"_")}n(t)}else i("failed to load url: "+o)}).catch(i)})},reloadRepository:function(e){var t=this;return e=e||this.selected_repository,new Promise(function(n,i){t.getRepoManifest(e.url).then(function(e){t.available_plugins=e.plugins;for(var i=function(e){var n=t.available_plugins[e],i=t.installed_plugins.filter(function(e){return n.name===e.name});i.length>0&&(n.installed=!0,n.tag=i[0].tag)},o=0;o<t.available_plugins.length;o++)i(o);t.$forceUpdate(),n(e)}).catch(i)})},addRepository:function(e){var t=this;"string"===typeof e&&(e={name:e,url:e,description:e}),Object(M["b"])(e.name&&e.url),this.reloadRepository(e).then(function(n){e.name=n.name||e.name,e.description=n.description||e.description;var i=!0,o=!1,a=void 0;try{for(var r,s=t.repository_list[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;if(l.name===e.name){e.name=e.url.replace("https://github.com/","").replace("http://github.com/","");break}}}catch(y){o=!0,a=y}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}var c=!0,u=!1,d=void 0;try{for(var p,m=t.repository_list[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var h=p.value;if(h.url===e.url){t.repository_list.splice(t.repository_list.indexOf(h),1),t.showMessage("Repository with the same url already exists.");break}}}catch(y){u=!0,d=y}finally{try{c||null==m.return||m.return()}finally{if(u)throw d}}t.repository_list.push(e),t.repository_names=[];var f=!0,g=!1,_=void 0;try{for(var v,w=t.repository_list[Symbol.iterator]();!(f=(v=w.next()).done);f=!0){var b=v.value;t.repository_names.push(b.name)}}catch(y){g=!0,_=y}finally{try{f||null==w.return||w.return()}finally{if(g)throw _}}t.config_db.get("repository_list").then(function(e){t.config_db.put({_id:e._id,_rev:e._rev,list:t.repository_list})}).catch(function(e){t.showMessage("Failed to save repository, database Error:"+e.toString()),t.status_text="Failed to save repository, database Error:"+e.toString()})}).catch(function(){t.repository_names.indexOf(e.name)>=0&&t.repository_names.splice(t.repository_names.indexOf(e.name),1),t.showMessage("Failed to load repository from: "+e.url)})},removeRepository:function(e){var t=this;if(e){var n=!1,i=!0,o=!1,a=void 0;try{for(var r,s=this.repository_list[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;l.url!==e.url&&l.name!==e.name||(n=l)}}catch(g){o=!0,a=g}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}if(n){var c=this.repository_list.indexOf(n);this.repository_list.splice(c,1),this.repository_names=[];var u=!0,d=!1,p=void 0;try{for(var m,h=this.repository_list[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var f=m.value;this.repository_names.push(f.name)}}catch(g){d=!0,p=g}finally{try{u||null==h.return||h.return()}finally{if(d)throw p}}this.config_db.get("repository_list").then(function(e){t.config_db.put({_id:e._id,_rev:e._rev,list:t.repository_list}).then(function(){t.showMessage("Repository has been deleted.")}).catch(function(){t.showMessage("Error occured when removing repository.")})}).catch(function(e){t.showMessage("Failed to save repository, database Error:"+e.toString()),t.status_text="Failed to save repository, database Error:"+e.toString()}),this.selected_repository===n.name&&this.$router.replace({query:{w:"default"}})}}},setPluginConfig:function(e,t,n){var i=this.plugins[n.id];if(!i)throw"setConfig Error: Plugin not found.";if(e.startsWith("_")&&i.config.hasOwnProperty(e.slice(1)))throw"'".concat(e.slice(1),"' is a readonly field defined in <config> block, please avoid using it");return t?localStorage.setItem("config_"+i.name+"_"+e,t):localStorage.removeItem("config_"+i.name+"_"+e)},getPluginConfig:function(e,t){var n=this.plugins[t.id];if(!n)throw"getConfig Error: Plugin not found.";return e.startsWith("_")&&n.config.hasOwnProperty(e.slice(1))?n.config[e.slice(1)]:localStorage.getItem("config_"+n.name+"_"+e)},getAttachment:function(e,t){var n=this.plugins[t.id];if(!n.attachments)return null;for(var i=0;i<n.attachments.length;i++)if(n.attachments[i].attrs.name===e)return n.attachments[i].content},showSnackbar:function(e,t,n){n||(n=t,t=null),t&&(t*=1e3),this.showMessage(e,t)},showFileDialog:function(e,t){if(!this.engine_connected)throw this.showMessage("File Dialog requires the plugin engine, please connect to the plugin engine."),"Please connect to the Plugin Engine ðŸš€.";if(t||(t=e,e={}),!t||!t.id)return this.$refs["file-dialog"].showDialog(e,t);var n=this.plugins[t.id];return n||t===this.IMJOY_PLUGIN?(n&&(e.root=e.root||n.config&&n.config.work_dir),n&&"native-python"!=n.type?e.uri_type=e.uri_type||"url":e.uri_type=e.uri_type||"path",this.$refs["file-dialog"].showDialog(e,t)):void 0},connectPlugin:function(e){e._disconnected&&("native-python"!==e.type||this.engine_connected?this.reloadPlugin(e.config):this.connectEngine(this.engine_url))},getPlugin4Install:function(e){var t=this;this.plugin4install=null,e.includes("github")&&e.includes("/blob/")&&(e=Object(M["f"])(e)),this.downloading_error="",this.downloading_plugin=!0,this.getPluginFromUrl(e).then(function(e){t.plugin4install=e,t.tag4install=e.tag,t.downloading_plugin=!1}).catch(function(e){t.downloading_plugin=!1,t.downloading_error="Sorry, the plugin URL is invalid: "+e.toString(),t.showMessage("Sorry, the plugin URL is invalid: "+e.toString())})},getPluginFromUrl:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,n){var i,o,a,r,s,l,c,u,d,p,m,h,g,_,w,b,y,k,C;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=n||this.available_plugins,t.startsWith("http")||!t.includes("/")||!t.includes(":")){e.next=47;break}return o=t.split(":"),a=Object(f["a"])(o,2),r=a[0],s=a[1],i=s.split("@")[1],s=s.split("@")[0],s=s.trim(),l=r.split("@")[1],r=r.split("@")[0],r=r.trim(),Object(M["b"])(r&&s,'Wrong URI format, it must be "REPO_NAME:PLUGIN_NAME"'),e.next=12,this.getRepoManifest(r,l);case 12:c=e.sent,u=null,d=!0,p=!1,m=void 0,e.prev=17,h=c.plugins[Symbol.iterator]();case 19:if(d=(g=h.next()).done){e.next=27;break}if(_=g.value,_.name!==s){e.next=24;break}return u=_,e.abrupt("break",27);case 24:d=!0,e.next=19;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e["catch"](17),p=!0,m=e.t0;case 33:e.prev=33,e.prev=34,d||null==h.return||h.return();case 36:if(e.prev=36,!p){e.next=39;break}throw m;case 39:return e.finish(36);case 40:return e.finish(33);case 41:if(u){e.next=43;break}throw"plugin not found ".concat(r,":").concat(s);case 43:t=u.uri,n=c.plugins,e.next=60;break;case 47:if(t.match(M["h"])){e.next=58;break}if(w=t.split("@"),i=w[1],b=n.filter(function(e){return w[0]&&e.name===w[0].trim()}),!(b.length<=0)){e.next=55;break}throw'Plugin "'.concat(w[0],'" cannot be found in the repository.');case 55:t=b[0].uri;case 56:e.next=60;break;case 58:i=t.split(".imjoy.html@")[1],i&&(t=t.split("@"+i)[0]);case 60:if(t.split("?")[0].endsWith(".imjoy.html")){e.next=62;break}throw'Plugin url must be ends with ".imjoy.html"';case 62:return e.next=64,v.a.get(t);case 64:if(y=e.sent,y&&y.data&&""!==y.data){e.next=68;break}throw alert("failed to get plugin code from "+t),"failed to get code.";case 68:return k=y.data,C=this.parsePluginCode(k,{tag:i}),C.uri=t,C.scoped_plugins=n,e.abrupt("return",C);case 73:case"end":return e.stop()}},e,this,[[17,29,33,41],[34,,36,40]])}));return function(t,n){return e.apply(this,arguments)}}(),installPlugin:function(e,t){var n=this;return new Promise(function(i,o){var a="string"===typeof e?e:e.uri,r=n.available_plugins;e.scoped_plugins&&(r=e.scoped_plugins,delete e.scoped_plugins),a?n.getPluginFromUrl(a,r).then(function(s){if(s.origin=e.origin||a,!s)return console.error('Failed to fetch the plugin from "'.concat(a,'".')),void o('Failed to fetch the plugin from "'.concat(a,'".'));if(P.includes(s.type)){if(s.tag=t||s.tag,s.tag){var l=s.origin.split(":");l[1]&&l[1].split("@")[1]&&(s.origin=l[0]+":"+l[1].split("@")[0]),s.origin=s.origin+"@"+s.tag}s._id=s.name&&s.name.replace(/ /g,"_")||Object(M["g"])(),s.dependencies=s.dependencies||[];for(var c=[],u=0;u<s.dependencies.length;u++)c.push(n.installPlugin({uri:s.dependencies[u],scoped_plugins:s.scoped_plugins||r}));Promise.all(c).then(function(){n.savePlugin(s).then(function(e){var o=!0,a=!1,r=void 0;try{for(var s,l=n.available_plugins[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;c.name!==e.name||c.installed||(c.installed=!0,c.tag=t)}}catch(u){a=!0,r=u}finally{try{o||null==l.return||l.return()}finally{if(a)throw r}}n.showMessage('Plugin "'.concat(e.name,'" has been successfully installed.')),n.$forceUpdate(),i(),n.reloadPlugin(e)}).catch(function(){o("Failed to save the plugin ".concat(s.name))})}).catch(function(e){throw alert("Failed to install dependencies for ".concat(s.name,": ").concat(e)),"Failed to install dependencies for ".concat(s.name,": ").concat(e)})}else o("Unsupported plugin type: "+s.type)}).catch(function(e){console.error(e),n.showMessage("Failed to download, if you download from github, please use the url to the raw file",6e3),o(e)}):o("No url found for plugin "+e.name)})},removePlugin:function(e){var t=this;return new Promise(function(n,i){t.db.get(e._id).then(function(e){return t.db.remove(e)}).then(function(){for(var i=0;i<t.installed_plugins.length;i++)t.installed_plugins[i].name===e.name&&t.installed_plugins.splice(i,1);var o=!0,a=!1,r=void 0;try{for(var s,l=t.available_plugins[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;c.name===e.name&&(c.installed=!1,c.tag=null)}}catch(u){a=!0,r=u}finally{try{o||null==l.return||l.return()}finally{if(a)throw r}}t.unloadPlugin(e,!0),t.showMessage('"'.concat(e.name,'" has been removed.')),t.$forceUpdate(),n()}).catch(function(n){t.status_text=n.toString()||"Error occured.",t.showMessage(t.status_text),console.error("error occured when removing ",e,n),i(n)})})},showPluginManagement:function(){this.plugin4install=null,this.downloading_error="",this.downloading_plugin=!1,this.init_plugin_search="",this.show_plugin_templates=!0,this.show_plugin_store=!0,this.show_plugin_url=!0,this.showAddPluginDialog=!0},sortedRunnablePlugins:function(){return _e.a.orderBy(this.plugins,"name").filter(function(e){return e.config.runnable})},sortedNonRunnablePlugins:function(){return _e.a.orderBy(this.plugins,"name").filter(function(e){return!e.config.runnable})},registerExtension:function(e,t){for(var n=0;n<e.length;n++)e[n]=e[n].replace(".",""),this.registered.extensions[e[n]]?this.registered.extensions[e[n]].push(t):this.registered.extensions[e[n]]=[t]},switchWorkspace:function(e){if(!e||""==e.trim())throw this.showMessage("Workspace name should not be empty."),"Workspace name should not be empty.";var t={workspace:e};"default"===e&&(t=null),this.$router.push({name:"app",query:t}),window.location.reload()},removeWorkspace:function(e){var t=this;if(this.workspace_list.includes(e)){var n=this.workspace_list.indexOf(e);this.workspace_list.splice(n,1),this.config_db.get("workspace_list").then(function(n){t.config_db.put({_id:n._id,_rev:n._rev,list:t.workspace_list,default:"default"}).then(function(){t.showMessage("Workspace ".concat(e," has been deleted."))}).catch(function(){t.showMessage("Error occured when removing workspace ".concat(e,"."))})}).catch(function(e){t.showMessage("Failed to save workspace, database Error:"+e.toString()),t.status_text="Failed to save workspace, database Error:"+e.toString()})}this.selected_workspace===e.name&&this.$router.replace({query:{w:"default"}})},showMessage:function(e,t){this.snackbar_info=e,this.snackbar_duration=t||1e4,this.show_snackbar=!0},connectEngine:function(e,t){var n=this;if(!this.socket||!this.engine_connected){e=e.replace("localhost","127.0.0.1"),this.engine_status.connection="Connecting...",t||this.showMessage("Trying to connect to the plugin engine...");var i=fe()(e),o=setTimeout(function(){n.engine_connected||(n.engine_status.connection="Plugin Engine is not connected.",t||n.showMessage("Failed to connect, please make sure you have started the plugin engine."),t&&i.disconnect())},2500);t||(this.showPluginEngineInfo=!0),i.on("connect",function(t){clearTimeout(o),n.connection_token=n.connection_token&&n.connection_token.trim(),i.emit("register_client",{id:n.client_id,token:n.connection_token,session_id:n.engine_session_id},function(o){if(o.success){var a=function(){n.socket=i,n.pluing_context.socket=i,n.engine_connected=!0,n.showPluginEngineInfo=!1,n.engine_status.connection="Connected.",localStorage.setItem("imjoy_connection_token",n.connection_token),localStorage.setItem("imjoy_engine_url",e),n.showMessage("Plugin Engine is connected."),n.event_bus.$emit("engine_connected",t),n.reloadPythonPlugins()};o.message&&o.confirmation?(n.permission_message=o.message,n.resolve_permission=a,n.reject_permission=function(){i.disconnect(),console.log("you canceled the connection.")},n.showPluginEngineInfo=!1,n.showPermissionConfirmation=!0):a()}else i.disconnect(),o.no_retry&&o.reason?(n.showStatus("Failed to connect: "+o.reason),n.showMessage("Failed to connect: "+o.reason)):(n.showPluginEngineInfo=!0,o.reason&&n.showMessage("Failed to connect: "+o.reason),console.error("failed to connect.",o.reason))})}),i.on("disconnect",function(){n.engine_connected=!1,n.showMessage("Plugin Engine disconnected."),n.engine_status.connection="Disconnected.",n.socket=null,n.pluing_context.socket=null,n.removePythonPlugins()}),this.socket=i}},updateEngineStatus:function(){var e=this;return new Promise(function(t,n){e.socket.emit("get_engine_status",{},function(i){i.success?(e.engine_status.plugin_num=i.plugin_num,e.engine_status.plugin_processes=i.plugin_processes,t(i),e.$forceUpdate()):(e.showMessage("Failed to get engine status: ".concat(i.error)),n(i.error),e.$forceUpdate())})})},killPluginProcess:function(e){var t=this;return new Promise(function(n,i){t.socket.emit("kill_plugin_process",{pid:e&&e.pid,all:!e},function(e){e.success?(t.updateEngineStatus(),n(e)):(t.showMessage("Failed to get engine status: ".concat(e.error)),i(e.error),t.$forceUpdate())})})},disconnectEngine:function(){this.socket&&this.socket.disconnect()},listEngineDir:function(e,t,n){var i=this;return new Promise(function(o,a){i.socket.emit("list_dir",{path:e||"~",type:t||"file",recursive:n||!1},function(t){t.success?(o(t),i.$forceUpdate()):(i.showMessage("Failed to list dir: ".concat(e," ").concat(t.error)),a(t.error),i.$forceUpdate())})})},showEngineFileDialog:function(){var e=this;this.showFileDialog({uri_type:"url"},this.IMJOY_PLUGIN).then(function(t){"string"===typeof t&&(t=[t]);var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;n.push({href:l,text:l.split("name=")[1]})}}catch(u){o=!0,a=u}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}var c={name:"Files",type:"imjoy/url_list",scroll:!0,data:n};e.addWindow(c)})},processPermission:function(e){e&&this.resolve_permission?(this.resolve_permission(),this.resolve_permission=null):this.reject_permission?(this.reject_permission("Permission Denied!"),this.reject_permission=null):console.error("permission handler not found.")},getFileUrl:function(e,t){var n=this;return new Promise(function(i,o){if(!n.engine_connected)return o("Please connect to the Plugin Engine ðŸš€."),void n.showMessage("Please connect to the Plugin Engine ðŸš€.");if(t===n.IMJOY_PLUGIN||t&&t.id){var a=n.plugins[t.id],r=a&&a.name;if(t===n.IMJOY_PLUGIN||r)if(n.showPermissionConfirmation)o("There is a pending permission request, please try again later.");else{var s=e;"string"===typeof e&&(s={path:e});var l=function(){n.socket.emit("get_file_url",s,function(e){e.success?(i(e.url),n.$forceUpdate()):(n.showMessage("Failed to get file url for ".concat(s.path," ").concat(e.error)),o(e.error),n.$forceUpdate())})};t===n.IMJOY_PLUGIN?l():(n.permission_message='Plugin <strong>"'.concat(r,'"</strong> would like to access your local file at <strong>"').concat(s.path,'"</strong><br>This means files and folders under "').concat(s.path,'" will be exposed as an url which can be accessed with the url.<br><strong>Please make sure this file path do not contain any confidential or sensitive data.</strong><br>Do you trust this plugin and allow this operation?'),n.resolve_permission=l,n.reject_permission=o,n.showPermissionConfirmation=!0)}else o("Plugin name not found.")}else o("Plugin not found.")})},getFilePath:function(e){var t=this;return new Promise(function(n,i){if(!t.engine_connected)return i("Please connect to the Plugin Engine ðŸš€."),void t.showMessage("Please connect to the Plugin Engine ðŸš€.");var o=e;"string"===typeof e&&(o={url:e}),t.socket.emit("get_file_path",o,function(e){e.success?(n(e.path),t.$forceUpdate()):(t.showMessage("Failed to get file path for ".concat(o.url," ").concat(e.error)),i(e.error),t.$forceUpdate())})})},exportFile:function(e,t,n){n||(n=t,t=null),Object(b["saveAs"])(e,t||e._name||"file_export")},importScript:function(e){return new Promise(function(t,n){var i=document.createElement("script");i.src=e,i.onload=t,i.onreadystatechange=t,i.onerror=n,document.head.appendChild(i)})},importScripts:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,n,i,o=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=Array.prototype.slice.call(o),n=t.length,i=0;case 1:if(!(i<n)){e.next=7;break}return e.next=4,this.importScript(t[i]);case 4:i++,e.next=1;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showDoc:function(e){var t=this.plugins[e],n=t.config,i={name:"About "+n.name,type:"imjoy/markdown",w:7,h:10,scroll:!0,data:{name:n.name,id:t.id,source:n&&n.docs[0]&&n.docs[0].content}};this.addWindow(i)},clearPluginUrl:function(){var e=Object.assign({},this.$route.query);delete e.p,delete e.plugin,this.$router.replace({query:e})},sharePlugin:function(e){var t=this.plugins[e],n=t.config;if(n.origin){this.share_url_message='<h2>Sharing "'.concat(t.name,'"</h2> <br> <a href="https://imjoy.io/#/app?p=').concat(n.origin,'" target="_blank">https://imjoy.io/#/app?p=').concat(n.origin,'</a> <br> (Right click on the link and select "Copy Link Address")'),this.showShareUrl=!0;var i=Object.assign({},this.$route.query);i.p=n.origin,this.$router.replace({query:i})}else{var o=t.name+"_"+Object(M["g"])()+".imjoy.html",a=new Blob([n.code],{type:"text/plain;charset=utf-8"});Object(b["saveAs"])(a,o)}},updatePlugin:function(e){var t=this.plugins[e],n=t.config;n.origin?this.installPlugin(n.origin):alert("Origin not found for this plugin.")},editPlugin:function(e){var t=this.plugins[e],n=t.config,i={name:n.name||"plugin",type:"imjoy/plugin-editor",config:{},plugin:t,reload:this.reloadPlugin,save:this.savePlugin,remove:this.removePlugin,w:10,h:10,data:{name:n.name,id:t.id,code:n.code}};this.addWindow(i)},newPlugin:function(e){var t={name:"New Plugin",type:"imjoy/plugin-editor",config:{},reload:this.reloadPlugin,save:this.savePlugin,w:10,h:10,plugin:{},data:{name:"new plugin",id:"plugin_"+Object(M["g"])(),code:JSON.parse(JSON.stringify(e))}};this.addWindow(t)},unloadPlugin:function(e,t){var n=e.name;for(var i in this.plugins)if(this.plugins.hasOwnProperty(i)){var o=this.plugins[i];if(o.name===n)try{t&&(delete this.plugins[i],delete this.plugin_names[n]),ve["a"].remove(n),"function"===typeof o.terminate&&o.terminate()}catch(a){console.error(a)}}this.$forceUpdate()},reloadPlugin:function(e){var t=this;return new Promise(function(n,i){try{t.unloadPlugin(e,!0);var o,a=t.parsePluginCode(e.code,e);if(a._id=e._id,"collection"===a.type)return;t.unloadPlugin(a,!0),o="window"===a.type?t.preLoadPlugin(a):t.loadPlugin(a),o.then(function(i){i._id=e._id,e.name=i.name,e.type=i.type,e.plugin=i,t.$refs.workflow&&t.$refs.workflow.setupJoy(),t.$forceUpdate(),n(i)}).catch(function(n){e.plugin=null,t.$forceUpdate(),i(n)})}catch(r){t.status_text=r||"Error.",t.showMessage(r||"Error.",15e3),i(r)}})},savePlugin:function(e){var t=this;return new Promise(function(n,i){console.log("saving plugin ",e);var o=e.code;try{var a=t.parsePluginCode(o,{tag:e.tag});a.code=o,a.origin=e.origin,a._id=a.name.replace(/ /g,"_");var r=function(){t.db.put(a,{force:!0}).then(function(){for(var e=0;e<t.installed_plugins.length;e++)t.installed_plugins[e].name===a.name&&t.installed_plugins.splice(e,1);a.installed=!0,t.installed_plugins.push(a),n(a),t.showMessage("".concat(a.name," has been successfully saved."))}).catch(function(e){t.showMessage("Failed to save the plugin.",15e3),console.error(e),i("failed to save")})};t.db.get(a._id).then(function(e){return t.db.remove(e)}).then(function(){r()}).catch(function(){r()})}catch(s){t.status_text=s||"Error.",t.showMessage(s||"Error.",15e3),i(s)}})},reloadPythonPlugins:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=this.installed_plugins[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;"native-python"===a.type&&this.reloadPlugin(a)}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}},removePythonPlugins:function(){for(var e in this.plugins)if(this.plugins.hasOwnProperty(e)){var t=this.plugins[e];if("native-python"===t.type)try{ve["a"].remove(t.config.type),"function"===typeof t.terminate&&t.terminate()}catch(n){}}},resetPlugins:function(){var e=this;this.plugins={},this.plugin_names={},this.registered={ops:{},windows:{},extensions:{},inputs:{},outputs:{},loaders:{}},this.registered.internal_inputs={Image:{schema:we.compile({properties:{type:{type:"string",enum:["image/jpeg","image/png","image/gif"]},size:{type:"number"}},required:["type","size"]})},"Code Editor":{schema:we.compile({properties:{name:{type:"string",pattern:".*\\.imjoy.html|\\.html|\\.txt|\\.xml"},size:{type:"number"}},required:["name","size"]})}},this.registered.loaders["Image"]=function(t){var n=new FileReader;n.onload=function(){e.createWindow({name:t.name,type:"imjoy/image",data:{src:n.result,_file:t}})},n.readAsDataURL(t)},this.registered.loaders["Code Editor"]=function(t){var n=new FileReader;n.onload=function(){e.newPlugin(n.result)},n.readAsText(t)}},reloadDB:function(){var e=this;return new Promise(function(t,n){try{if(e.db)try{e.db.close().finally(function(){e.db=new w["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")})}catch(i){console.error("failed to reload database: ",i),e.db=new w["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")}else e.db=new w["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")}catch(i){console.error("Failed to reload database."),n("Failed to reload database.")}})},reloadPlugins:function(){var e=this;return new Promise(function(t,n){if(e.plugins)for(var i in e.plugins)if(e.plugins.hasOwnProperty(i)){var o=e.plugins[i];if("function"===typeof o.terminate)try{o.terminate()}catch(a){console.error(a)}e.plugins[i]=null,e.plugin_names[o.name]=null}e.resetPlugins(),e.reloadDB().then(function(){e.db.allDocs({include_docs:!0,attachments:!0,sort:"name"}).then(function(n){e.workflow_list=[],e.installed_plugins=[];for(var i=function(t){var i=n.rows[t].doc;i.workflow?e.workflow_list.push(i):(i.installed=!0,e.installed_plugins.push(i),e.reloadPlugin(i).catch(function(t){console.error(i,t),e.showSnackbar("<".concat(i.name,">: ").concat(t.toString())),t.toString().includes("Please connect to the Plugin Engine ðŸš€.")||e.showMessage("<".concat(i.name,">: ").concat(t.toString()))}))},o=0;o<n.total_rows;o++)i(o);e.plugin_loaded=!0,e.loading=!1,t(),e.$forceUpdate()}).catch(function(t){console.error(t),e.loading=!1,n()})})})},closeAll:function(){this.default_window_pos={i:0,x:0,y:0,w:5,h:5},this.status_text="";for(var e=this.windows.length;e--;)"imjoy/plugin-editor"!=this.windows[e].type&&this.closeWindow(this.windows[e])},showProgress:function(e){this.progress=e<1?100*e:e},showStatus:function(e){this.status_text=e},showPluginProgress:function(e,t){if(t&&t.id){var n=this.plugins[t.id];n&&(n.progress=e<1?100*e:e,this.$forceUpdate())}},showPluginStatus:function(e,t){if(t&&t.id){var n=this.plugins[t.id];n&&(n.status_text=e,this.$forceUpdate())}},addWindow:function(e){return e.id=e.id||e.name+Object(M["g"])(),e.loaders=this.getDataLoaders(e.data),e.refresh=this.$forceUpdate,this.generateGridPosition(e),this.windows.push(e),this.window_ids[e.id]=e,this.event_bus.$emit("add_window",e),"single"===this.window_mode&&this.selectWindow(e),e.id},selectWindow:function(e){for(var t=0;t<this.active_windows.length;t++)this.active_windows[t].selected=!1,this.active_windows[t].refresh();this.selected_window=e,e.selected=!0,console.log("activate window: ",[e]),this.active_windows=[e],e.refresh()},closeWindow:function(e){this.windows.splice(this.windows.indexOf(e),1),delete this.window_ids[e.id],"single"===this.window_mode&&(this.selected_window=this.windows[0])},closePluginDialog:function(e){this.showPluginDialog=!1;var t=Object(f["a"])(this.plugin_dialog_promise,2),n=t[0],i=t[1];e?n(this.$refs.plugin_dialog_joy.joy.get_config()):i(),this.plugin_dialog_promise=null},windowSelected:function(e){console.log("activate window: ",e),this.active_windows=e},onCloseWindow:function(e){var t=this;e.plugin&&e.plugin.terminate?e.plugin.terminate(function(){t.closeWindow(e)}):this.closeWindow(e)},windowAdded:function(e){this.window_ids[e.id]=e},generateGridPosition:function(e){e.i=this.default_window_pos.i.toString(),e.w=e.w||this.default_window_pos.w,e.h=e.h||this.default_window_pos.h,e.x=this.default_window_pos.x,e.y=this.default_window_pos.y,this.default_window_pos.x=this.default_window_pos.x+this.default_window_pos.w,this.default_window_pos.x>=20&&(this.default_window_pos.x=0,this.default_window_pos.y=this.default_window_pos.y+this.default_window_pos.h),this.default_window_pos.i=this.default_window_pos.i+1},validatePluginConfig:function(e){if(e.name.indexOf("/")<0)return!0;throw"Plugin name should not contain '/'."},getDataLoaders:function(e){var t={};for(var n in this.registered.internal_inputs)this.registered.internal_inputs.hasOwnProperty(n)&&this.registered.internal_inputs[n].schema(e)&&(t[n]=n);for(var i in this.registered.inputs)if(this.registered.inputs.hasOwnProperty(i))try{if(this.registered.inputs[i].schema(e)){var o=this.registered.inputs[i].plugin_name,a=this.registered.inputs[i].op_name,r=this.plugin_names[o];r&&this.registered.loaders[o+"/"+a]&&(t[a]=o+"/"+a)}}catch(s){}return t},loadFiles:function(){if(1===this.selected_files.length){var e=this.selected_files[0],t=this.getDataLoaders(e),n=Object.keys(t);if(1===n.length)try{return this.registered.loaders[t[n[0]]](e)}catch(r){console.error("Failed to load with the matched loader ".concat(t[0]),r)}}for(var i=0;i<this.selected_files.length;i++){var o=this.selected_files[i];o.loaders=o.loaders||this.getDataLoaders(o)}var a={name:"Files",type:"imjoy/files",config:{},select:-1,_op:"__file_loader__",_source_op:null,_workflow_id:"files_"+Object(M["g"])(),_transfer:!1,data:this.selected_files};this.addWindow(a)},clearWorkflow:function(){this.workflow_joy_config.data=null,this.$refs.workflow.setupJoy(!0)},runWorkflow:function(e){var t=this,n=this.active_windows[this.active_windows.length-1]||{};this.status_text="",this.progress=0;var i=this.plugin2joy(n.data)||{};i.target=i.target||{},i.target._op="workflow",i.target._source_op=null,i.target._workflow_id=i.target._workflow_id||"workflow_"+Object(M["g"])(),e.workflow.execute(i.target).then(function(e){var n=t.joy2plugin(e);n&&n.data&&Object.keys(n.data).length>2&&(n.name=n.name||"result",n.type=n.type||"imjoy/generic",t.createWindow(n)),t.progress=100}).catch(function(e){console.error(e),t.status_text=e.toString()||"Error.",t.showMessage(e||"Error.",12e3)})},saveWorkflow:function(e){var t=this,n=prompt("Please enter a name for the workflow","default");if(n){var i={};i.name=n,i._id=n+"_workflow",i.workflow=JSON.stringify(e.top.data),this.db.put(i,{force:!0}).then(function(){t.workflow_list.push(i),t.showMessage(n+" has been successfully saved.")}).catch(function(e){t.showMessage("Failed to save the workflow."),console.error(e)})}},loadWorkflow:function(e){this.workflow_joy_config.data=JSON.parse(e.workflow),this.$refs.workflow.setupJoy(!0)},shareWorkflow:function(e){var t=ve["a"].encodeWorkflow(e.workflow);this.share_url_message="".concat(location.protocol,"//").concat(location.hostname).concat(location.port?":"+location.port:"","/#/app/?workflow=").concat(t),this.showShareUrl=!0},removeWorkflow:function(e){var t=this;this.db.get(e._id).then(function(e){return t.db.remove(e)}).then(function(){var n=t.workflow_list.indexOf(e);n>-1&&t.workflow_list.splice(n,1),t.showMessage(name+" has been successfully removed.")}).catch(function(e){t.showMessage("Failed to remove the workflow."),console.error(e)})},runOp:function(e){var t=this;this.status_text="",this.progress=0;var n=this.active_windows[this.active_windows.length-1]||{},i=this.plugin2joy(n)||{};i.target=i.target||{},i.target._op=e.name,i.target._source_op=null,i.target._workflow_id=i.target._workflow_id||"op_"+e.name.trim().replace(/ /g,"_")+Object(M["g"])(),e.joy.__op__.execute(i.target).then(function(e){var n=t.joy2plugin(e);n&&(console.log("result",n),n.name=n.name||"result",n.type=n.type||"imjoy/generic",t.createWindow(n)),t.progress=100}).catch(function(n){console.error(n),t.status_text="<"+e.name+">"+(n.toString()||"Error."),t.showMessage(t.status_text,15e3)})},selectFileChanged:function(e){this.selected_file=e.target.files[0],this.selected_files=e.target.files;for(var t=0;t<e.target.files.length;t++){var n=e.target.files[t];n.relativePath=n.webkitRelativePath,n.loaders=this.getDataLoaders(n)}this.loadFiles()},parsePluginCode:function(e,t){t=t||{};var n=t.uri,i=t.tag,o=t.origin;try{if(n&&n.endsWith(".js"))t.lang=t.lang||"javascript",t.script=e,t.style=null,t.window=null,t.tag=i||null;else{var a=me(e);t=JSON.parse(a.config[0].content),t.scripts=[];for(var r=0;r<a.script.length;r++)a.script[r].attrs.lang?(t.script=a.script[r].content,t.lang=a.script[r].attrs.lang||"javascript"):t.scripts.push(a.script[r]);t.script||(t.script=a.script[0].content,t.lang=a.script[0].attrs.lang||"javascript"),t.tag=i||t.tags&&t.tags[0];for(var s=0;s<a.script.length;s++)if(a.script[s].attrs.tag===t.tag){t.script=a.script[s].content,t.lang=a.script[s].attrs.lang||"javascript";break}t.links=a.link||null,t.windows=a.window||null,t.styles=a.style||null,t.docs=a.docs||null,t.attachments=a.attachment||null}t._id=t._id||null,t.uri=n,t.origin=o,t.code=e,t.id=t.name.trim().replace(/ /g,"_")+"_"+Object(M["g"])(),t.runnable=!1!==t.runnable;for(var l=0;l<x.length;l++){var c=t[x[l]];if(c&&"object"===Object(h["a"])(c)&&!(c instanceof Array)){if(!t.tag)throw"You must use 'tags' with configurable fields.";t[x[l]]=c[t.tag],c.hasOwnProperty(t.tag)||console.log("WARNING: "+x[l]+" do not contain a tag named: "+t.tag)}}if(!S(t)){var u=S.errors(t);throw console.error("Invalid plugin config: "+t.name,u),u}}catch(d){throw"Failed to parse the content of the plugin."}return this.upgradeAPI(t)},upgradeAPI:function(e){return Object(M["c"])(e.api_version,"<=","0.1.1")&&(e.type=e.type||e.mode,delete e.mode,"pyworker"===e.type?e.type="native-python":"webworker"===e.type?e.type="web-worker":"webpython"===e.type&&(e.type="web-python")),e},preLoadPlugin:function(e,t){var n=this,i={name:e.name,type:e.type,ui:e.ui,tag:e.tag,inputs:e.inputs,outputs:e.outputs,_id:e._id};return this.validatePluginConfig(i),new Promise(function(o,a){t?(i.id=t.id,i.initialized=!0):(i.id=e.name.trim().replace(/ /g,"_")+"_"+Object(M["g"])(),i.initialized=!1);var r=_e.a.assign({},e,i),s={_id:i._id,id:i.id,name:i.name,type:i.type,config:r,docs:e.docs,tag:e.tag,attachments:e.attachments,terminate:function(e){this._disconnected=!0,e&&e()}};n.plugins[s.id]=s,n.plugin_names[s.name]=s,s.api={__jailed_type__:"plugin_api",__id__:s.id,run:function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(i){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o=Object(M["a"])(e.defaults)||{},o.type=e.name,o.name=e.name,o.tag=e.tag,o.data=i.data,o.config=i.config,t.next=8,n.createWindow(o);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()};try{n.register(i,{id:i.id}),o(s)}catch(l){a(l)}})},loadPlugin:function(e,t){var n=this;return this.status_text="",e=Object(M["a"])(e),this.validatePluginConfig(e),new Promise(function(i,o){var a={};t?(a.id=t.id,a.initialized=!0):(a.id=e.name.trim().replace(/ /g,"_")+"_"+Object(M["g"])(),a.initialized=!1),a._id=e._id,a.context=n.pluing_context,"native-python"===e.type&&(n.socket||console.error("Please connect to the Plugin Engine ðŸš€."));var r=_e.a.assign({},e,a);r.workspace=n.selected_workspace;var s=new jailed.DynamicPlugin(r,_e.a.assign({TAG:r.tag,WORKSPACE:n.selected_workspace},n.imjoy_api));s.whenConnected(function(){if(!s.api)throw console.error("Error occured when loading plugin."),n.showMessage("Error occured when loading plugin."),"Error occured when loading plugin.";e.type&&n.register(e,{id:s.id}),e.extensions&&e.extensions.length>0&&n.registerExtension(e.extensions,s),s.api.setup().then(function(){i(s)}).catch(function(t){console.error("error occured when loading plugin "+e.name+": ",t),n.showMessage("<".concat(e.name,">: ").concat(t),15e3),o(t),s.terminate()})}),s.whenFailed(function(t){t?(n.status_text="<".concat(e.name,"> ").concat(t.toString()),n.showMessage("<".concat(e.name,">: ").concat(t))):(n.status_text="Error occured when loading ".concat(e.name,"."),n.showMessage("Error occured when loading ".concat(e.name,"."))),console.error("error occured when loading "+e.name+": ",t),s.terminate(),o(t)}),s.docs=e.docs,s.attachments=e.attachments,n.plugins[s.id]=s,n.plugin_names[s.name]=s})},callPlugin:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,n){var i,o=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.plugin_names[t],!i){e.next=9;break}if(i.running){e.next=4;break}throw'plugin "'+t+'" is not running.';case 4:return e.next=6,i.api[n].apply(null,Array.prototype.slice.call(o,2,o.length-1));case 6:return e.abrupt("return",e.sent);case 9:throw"plugin with type "+t+" not found.";case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),getPlugin:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.plugin_names[t],!n){e.next=5;break}return e.abrupt("return",n.api);case 5:throw"plugin with type "+t+" not found.";case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),runPlugin:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,n,i){var o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i&&i.id?o=this.plugins[i.id]:(o=this.plugins[n.id],n=null),a=this.plugin_names[t],!a){e.next=18;break}if(a.running){e.next=5;break}throw'plugin "'+t+'" is not running.';case 5:return n=n||{},n.op={type:o.type,name:o.name},n.config=n.config||{},n.data=n.data||{},n.data._op=t,n.data._source_op=o.name,n.data._workflow_id=n.data._workflow_id||null,n.data._transfer=!1,e.next=15,a.api.run(this.filter4plugin(n));case 15:return e.abrupt("return",e.sent);case 18:throw"plugin with type "+t+" not found.";case 19:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}(),plugin2joy:function(e){if(!e)return null;var t={};return e.type&&e.data?(t.data=e.config,t.target=e.data,t.target.name=e.name,t.target.type=e.type):(t.data=null,t.target=e),t.target=t.target||{},Array.isArray(t.target)&&t.target.length>0&&void 0!==e.select&&t.target[e.select]&&(t.target=t.target[e.select]),"object"===Object(h["a"])(t.target)?(t.target._variables=e._variables||{},t.target._workflow_id=e._workflow_id||null,t.target._op=e._op||null,t.target._source_op=e._source_op||null,t.target._transfer=e._transfer||!1,Object.keys(t.target).length>4?t:null):t},filter4plugin:function(e){return e&&{_variables:e._variables||null,_op:e._op,_source_op:e._source_op,_transfer:e._transfer,_workflow_id:e._workflow_id,config:e.config,data:e.data}},joy2plugin:function(e){if(!e)return null;var t={_variables:e.target&&e.target._variables||null,_op:e.target&&e.target._op,_source_op:e.target&&e.target._source_op,_transfer:e.target&&e.target._transfer,_workflow_id:e.target&&e.target._workflow_id,config:e.data,data:e.target,name:e.target&&e.target.name,type:e.target&&e.target.type};return e.target&&(delete e.target._op,delete e.target._workflow_id,delete e.target._variables,delete e.target._source_op,delete e.target._transfer),t},normalizeUI:function(e){if(!e)return"";var t="";if(Array.isArray(e)){var n=!0,i=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if("string"===typeof s)t=t+s+"<br>";else if("object"===Object(h["a"])(s))for(var l in s)t="string"===typeof s[l]?t+l+": "+s[l]+"<br>":t+l+": "+JSON.stringify(s[l])+"<br>";else t=t+JSON.stringify(s)+"<br>"}}catch(c){i=!0,o=c}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}}else{if("object"===Object(h["a"])(e))throw"ui can not be an object, you can only use a string or an array.";"string"===typeof e?t=e.trim():(t="",console.log("Warining: removing ui string."))}return t},register:function(e,t){var n=this;try{var i=this.plugins[t.id];if(!i)throw"Plugin not found.";if(e=Object(M["a"])(e),e.name=e.name||i.name,e.show_panel=e.show_panel||!1,e.ui=this.normalizeUI(e.ui),i.name===e.name&&(e.ui=e.ui||i.config.description),e.tags=["op","plugin"],e.inputs=e.inputs||null,e.outputs=e.outputs||null,"window"===e.type?e.tags.push("window"):"native-python"===e.type?e.tags.push("python"):"web-worker"===e.type?e.tags.push("web-worker"):"web-python"===e.type?e.tags.push("web-python"):"iframe"===e.type&&e.tags.push("iframe"),e.type=e.name,!I(e)){var o=I.errors(e);throw console.error("Error occured during registering "+e.name,o),o}var a=null;if(a=e.run&&"function"===typeof e.run?e.run:i&&i.api&&i.api.run,i&&a){var r=function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a(n.joy2plugin(t));case 2:return i=e.sent,e.abrupt("return",n.plugin2joy(i));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();e.onexecute=r}else console.log("WARNING: no run function found in the config, this op won't be able to do anything: "+e.name),e.onexecute=function(){console.log("WARNING: no run function defined.")};if(e.update&&"function"===typeof e.update){var s=function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(i){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.update(n.joy2plugin(i));case 2:return o=t.sent,t.abrupt("return",n.plugin2joy(o));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();e.onupdate=Object(M["d"])(s,300)}else if(i&&i.api&&i.api.update){var l=function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.api.update(n.joy2plugin(t));case 2:return o=e.sent,e.abrupt("return",n.plugin2joy(o));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();e.onupdate=Object(M["d"])(l,300)}var c=e;c.init=c.ui,ve["a"].add(c);var u={plugin_id:t.id,name:e.name,ui:"{id: '__op__', type: '"+e.type+"'}",onexecute:e.onexecute};if(i.ops=i.ops||{},i.ops[e.name]=u,e.inputs)try{if(("object"!=e.inputs.type||!e.inputs.properties)&&("array"!=e.inputs.type||!e.inputs.items)){if("object"!==Object(h["a"])(e.inputs))throw"inputs schema must be an object.";e.inputs={properties:e.inputs,type:"object"}}"object"===e.inputs.type&&e.inputs.properties&&!e.inputs.required&&(e.inputs.required=Object.keys(e.inputs.properties));var d=we.compile(e.inputs),p=i.name,m=e.name;this.registered.inputs[p+"/"+m]={op_name:m,plugin_name:p,schema:d},this.registered.loaders[p+"/"+m]=function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var o,a,r,s,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o={},!i.config||!i.config.ui){e.next=5;break}return e.next=4,n.showDialog(i.config);case 4:o=e.sent;case 5:return t.transfer=t.transfer||!1,t._source_op=t._op,t._op=m,t._workflow_id=t._workflow_id||"data_loader_"+m.trim().replace(/ /g,"_")+Object(M["g"])(),a={op:{name:m},target:t,data:o},e.next=12,i.api.run(n.joy2plugin(a));case 12:if(r=e.sent,!r){e.next=23;break}if(s=n.plugin2joy(r),!s){e.next=23;break}return l={},l.name=s.name||"result",l.type=s.type||"imjoy/generic",l.config=s.data,l.data=s.target,e.next=23,n.createWindow(l);case 23:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}catch(_){console.error('error occured when parsing the inputs schema of "'.concat(e.name,'"'),_)}if(e.outputs)try{if("object"!=e.outputs.type||!e.outputs.properties){if("object"!==Object(h["a"])(e.outputs))throw"inputs schema must be an object.";e.outputs={properties:e.outputs,type:"object"}}"object"===e.outputs.type&&e.outputs.properties&&!e.outputs.required&&(e.outputs.required=Object.keys(e.outputs.properties));var f=we.compile(e.outputs);this.registered.outputs[i.name+"/"+e.name]={op_name:e.name,plugin_name:i.name,schema:f}}catch(_){console.error('error occured when parsing the outputs schema of "'.concat(e.name,'"'),_)}return this.registered.ops[i.name+"/"+e.name]=u,this.$refs.workflow&&this.$refs.workflow.setupJoy(),this.$forceUpdate(),this.registered.windows[e.name]=i.config,!0}catch(_){throw console.error(_),_}},renderWindow:function(e){var t=this;return new Promise(function(n,i){var o=_e.a.assign({},e.plugin,e);o.workspace=t.selected_workspace;var a=new jailed.DynamicPlugin(o,_e.a.assign({TAG:e.tag,WORKSPACE:t.selected_workspace},t.imjoy_api));a.whenConnected(function(){if(!a.api)return console.error("the window plugin seems not ready."),void i("the window plugin seems not ready.");a.api.setup().then(function(){if(e.data=e.data||{},e.data._source_op=e.data&&e.data._op,e.data._op=a.name,e.data._workflow_id=e.data&&e.data._workflow_id,e.plugin=a,e.update=a.api.run,a.config.runnable&&!a.api.run){var o="You must define a `run` function for "+a.name+" or set its `runnable` field to false.";return i(o),t.status_text=o,void t.showMessage(o)}a.api.run?a.api.run(t.filter4plugin(e)).then(function(i){if(i)for(var o in i)e[o]=i[o];n(a.api),t.$forceUpdate()}).catch(function(e){t.status_text="<"+a.name+">"+(e.toString()||"Error."),console.error("Error in the run function of plugin "+a.name,e),t.showMessage(t.status_text),i(e)}):(n(a.api),t.$forceUpdate())}).catch(function(n){console.error("Error occured when loading the window plugin "+e.name+": ",n),t.status_text="Error occured when loading the window plugin "+e.name+": "+n,a.terminate(),t.showMessage("Error occured when loading the window plugin "+e.name+": "+n),i(n)})}),a.whenFailed(function(n){console.error("error occured when loading "+e.name+":",n),t.status_text="Error occured when loading ".concat(e.name,": ").concat(n,"."),t.showMessage("Error occured when loading ".concat(e.name,": ").concat(n,".")),a.terminate(),i(n)})})},updateWindow:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.showMessage("Warning: `api.updateWindow` is deprecated, please use the new api.`"),n=t.id,!n||!n.run){e.next=8;break}return e.next=5,n.run(t);case 5:return e.abrupt("return",e.sent);case 8:throw"Window (id=".concat(n.id,") not found");case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),createWindow:function(e){var t=this;return new Promise(function(n,i){if(e.config=e.config||{},e.data=e.data||null,e.panel=e.panel||null,!$(e)){var o=$.errors(e);throw console.error("Error occured during creating window "+e.name,o),o}if(e.type&&e.type.startsWith("imjoy")){e.id="imjoy_"+Object(M["g"])(),e.name=e.name||"untitled window";var a=t.addWindow(e),r={__jailed_type__:"plugin_api",__id__:a,run:function(e){var n=t.window_ids[a];for(var i in e)n[i]=e[i]}};n(r)}else{var s=t.registered.windows[e.type];if(!s)throw console.error("no plugin registered for window type: ",e.type),e.type;var l=e;if(l.type=s.type,l.id=s.id+"_"+Object(M["g"])(),"window"!=l.type)throw'Window plugin must be with type "window"';l.iframe_container="plugin_window_"+l.id+Object(M["g"])(),l.iframe_window=null,l.plugin=s,l.context=t.pluing_context,t.showPluginWindow(l),t.$nextTick(function(){t.renderWindow(l).then(function(e){n(e)}).catch(i)})}})},showDialog:function(e){var t=this;return new Promise(function(n,i){t.plugin_dialog_config=e,t.showPluginDialog=!0,t.plugin_dialog_promise=[n,i]})},showPluginWindow:function(e){if(e.name=e.name||"untitiled plugin window",e.data=e.data||null,e.config=e.config||{},e.panel=e.panel||null,!$(e)){var t=$.errors(e);throw console.error("Error occured during creating window "+e.name,t),t}return this.addWindow(e)},showAlert:function(e){console.log("alert: ",e),alert(e)},openUrl:function(e){Object.assign(document.createElement("a"),{target:"_blank",href:e}).click()},sleep:function(e){return new Promise(function(t){return setTimeout(t,Math.round(1e3*e))})}}},ye=be,ke=(n("65d0"),Object(c["a"])(ye,p,m,!1,null,"5e303379",null));ke.options.__file="Imjoy.vue";var Ce=ke.exports,xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("md-app-toolbar",{staticClass:"md-primary"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("navbar")],1)]),n("md-subheader",[e._v("About ImJoy.io")]),n("md-card",[n("md-card-header"),n("md-card-content",{staticClass:"centered-fixed"},[n("md-icon",{staticClass:"md-size-5x md-small-hide",attrs:{"md-src":"static/img/imjoy-icon.svg"}}),n("md-button",{staticClass:"normal-text",attrs:{href:"https://github.com/oeway",target:"_blank"}},[e._v("Made by Wei OUYANG with "),n("span",{staticClass:"red"},[e._v("â¤")])]),n("h2",[e._v("Acknowledgements")]),n("p",[e._v("The ImJoy project is carried out in "),n("a",{attrs:{href:"https://research.pasteur.fr/en/team/imaging-and-modeling/",target:"_blank"}},[e._v("Imaging and Modeling Unit")]),e._v(" at Institut Pasteur.")]),n("p",[e._v("We thank "),n("a",{attrs:{href:"https://sites.google.com/site/imagingandmodeling/people",target:"_blank"}},[e._v("all the team members")]),e._v(" from the Imaging and Modeling Unit and people who have been using, testing, contributing valuable feedbacks and suggestions for improving ImJoy.")]),n("p",[e._v("This project is mainly funded by\n      ")]),n("p",[n("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[n("img",{attrs:{id:"ip-img",src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}})])]),n("br")],1)],1),n("br"),n("br"),e.footer?n("md-divider"):e._e(),e.footer?n("main-footer"):e._e()],1)},Pe=[],je={name:"about",props:{faq:{type:Boolean,default:!0},footer:{type:Boolean,default:!0}},data:function(){return{}},created:function(){this.store=this.$root.$data.store},mounted:function(){},methods:{}},Ee=je,Oe=(n("049c"),Object(c["a"])(Ee,xe,Pe,!1,null,"ba256114",null));Oe.options.__file="About.vue";var De=Oe.exports;i["default"].use(o["a"]);var Se=new o["a"]({base:window.location.pathName,routes:[{path:"/",name:"Home",component:d},{path:"/home",redirect:"/"},{path:"/app",name:"app",component:Ce},{path:"/:)",redirect:{name:"joy"}},{path:"/%F0%9F%98%82",name:"joy",component:Ce},{path:"/imjoy",name:"Imjoy",component:Ce},{path:"/about",name:"About",component:De},{path:"*",redirect:"/"}]}),Ie=n("43f9"),$e=n.n(Ie),Me=(n("51de"),n("e094"),n("6f79")),We=n.n(Me),Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("md-button",{staticClass:"site-title",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title",attrs:{src:"static/img/imjoy-logo-white.svg",alt:"ImJoy"}}),n("span",{staticClass:"superscript"},[e._v("beta")])]),n("span",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path!='/'"}],staticClass:"md-layout-item md-medium-hide subheader-title"},[e._v("Image processing with joy.")]),n("div",{staticClass:"md-toolbar-section-end"},[e.screenWidth<600?n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-primary md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("menu")])],1),n("md-menu-content",[n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path != '/'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/")}}},[e._v("Home")]),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/app"!=e.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/app")}}},[e._v("Start ImJoy")]),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"https://github.com/oeway/ImJoy"}},[e._v("Source")]),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"/docs"}},[e._v("Docs")]),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/about"!=e.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/about")}}},[e._v("About")])],1)],1):e._e(),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path != '/'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/")}}},[n("md-icon",[e._v("home")]),e._v(" Home\n            "),n("md-tooltip",[e._v("Home Page")])],1):e._e(),e._v("\n          Â \n          "),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/app"!=e.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/app")}}},[n("md-icon",{staticClass:"md-size-1x svg-icon",attrs:{"md-src":"static/img/imjoy-icon-white.svg"}}),e._v(" ImJoy App\n            "),n("md-tooltip",[e._v("Start ImJoy App")])],1):e._e(),e._v("\n          Â \n          "),e.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"https://github.com/oeway/ImJoy",target:"_blank"}},[n("md-icon",{staticClass:"md-size-1x svg-icon",attrs:{"md-src":"static/img/github.svg"}}),e._v("source\n            "),n("md-tooltip",[e._v("Source code on Github")])],1):e._e(),e._v("\n          Â \n          "),e.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"/docs"}},[n("md-icon",[e._v("library_books")]),e._v("Docs\n            "),n("md-tooltip",[e._v("Documentation")])],1):e._e(),e._v("\n          Â \n          "),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/about"!=e.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/about")}}},[n("md-icon",[e._v("info")]),e._v(" About\n            "),n("md-tooltip",[e._v("About ImJoy.io")])],1):e._e()],1)],1),n("md-snackbar",{staticClass:"md-accent",attrs:{"md-position":"center","md-active":e.showSnackbar,"md-duration":e.snackbar_duration},on:{"update:mdActive":function(t){e.showSnackbar=t}}},[n("span",[e._v(e._s(e.snackbar_info))]),n("md-button",{staticClass:"md-accent",on:{click:function(t){e.showSnackbar=!1}}},[e._v("close")])],1)],1)},Ae=[],Te={name:"navbar",data:function(){return{snackbar_info:"",snackbar_duration:1e3,showSnackbar:!1,screenWidth:window.innerWidth}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus},mounted:function(){this.screenWidth=window.innerWidth,this.event_bus.$on("resize",this.updateSize)},beforeDestroy:function(){this.event_bus.$off("resize",this.updateSize)},methods:{updateSize:function(e){this.screenWidth=e.width},shareOnTwitter:function(){var e="https://imjoy.io",t=" #ImJoy ";window.open("http://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(t),"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")}}},Ue=Te,Le=(n("9c4c"),Object(c["a"])(Ue,Re,Ae,!1,null,"69c527e5",null));Le.options.__file="Navbar.vue";var Ne=Le.exports,Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"/app"!=e.$route.path&&"/app"!=e.$route.path?n("div",{staticClass:"footer"},[n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"md-accent footer-button",attrs:{target:"_blank",href:"https://github.com/oeway/ImJoy/issues"}},[e._v("Create an issue on Github")])],1),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://creativecommons.org/licenses/by/4.0/",target:"_blank"}},[n("md-tooltip",[e._v("Except where otherwise noted, content on this site is licensed under a Creative Commons Attribution 4.0 International license.")]),n("img",{attrs:{id:"cc-by-img",src:"static/img/by.svg",alt:"CC BY 4.0"}})],1),n("md-button",{staticClass:"footer-button",on:{click:function(t){e.$router.push("/about")}}},[e._v("About ImJoy.io")])],1),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://github.com/oeway",target:"_blank"}},[e._v("Made by Wei OUYANG with "),n("span",{staticClass:"red"},[e._v("â¤")])]),n("md-button",{staticClass:"footer-button",attrs:{target:"_blank",href:"https://sites.google.com/site/imagingandmodeling/"}},[e._v("Powered by Imaging and Modeling Unit")]),e._m(0)],1)]):e._e()},ze=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[n("img",{attrs:{id:"ip-img",src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}})])}],qe={name:"main-footer",data:function(){return{mode:"about",showDialog:!1,showQuestion:!1}},created:function(){this.store=this.$root.$data.store},mounted:function(){},methods:{}},Be=qe,Je=(n("0d59"),Object(c["a"])(Be,Fe,ze,!1,null,"f8b130ac",null));Je.options.__file="Footer.vue";var Ve=Je.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"whiteboard",staticClass:"whiteboard noselect",on:{mouseup:function(t){e.show_overlay=!1},click:function(t){e.unselectWindows()}}},[e.show_overlay?n("div",{staticClass:"overlay",on:{mousemove:e.overlayMousemove,click:function(t){e.show_overlay=!1}}}):e._e(),"grid"===e.mode?n("grid-layout",{attrs:{layout:e.windows,"col-num":e.col_num,"is-mirrored":!1,"auto-size":!0,"row-height":e.row_height,"col-width":e.column_width,"is-responsive":!0,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!0,margin:[3,3],"use-css-transforms":!0}},e._l(e.windows,function(t){return n("grid-item",{key:t.id,attrs:{"drag-allow-from":".drag-handle","drag-ignore-from":".no-drag",x:t.x,y:t.y,w:t.w,h:t.h,i:t.i},on:{resize:function(n){e.viewChanging(t)},move:function(n){e.viewChanging(t)},resized:function(n){e.show_overlay=!1,t.resize&&t.resize(),e.focusWindow(t)},moved:function(n){e.show_overlay=!1,t.move&&t.move(),e.focusWindow(t)}}},[n("window",{attrs:{w:t,withDragHandle:!0,loaders:e.loaders},on:{duplicate:e.duplicate,select:e.selectWindow,close:e.close,fullscreen:e.fullScreen,normalsize:e.normalSize}})],1)})):e._l(e.windows,function(t){return n("window",{directives:[{name:"show",rawName:"v-show",value:e.selected_window===t,expression:"selected_window===w"}],key:t.id,attrs:{loaders:e.loaders,withDragHandle:!1,w:t},on:{duplicate:e.duplicate,select:e.selectWindow,close:e.close,fullscreen:e.fullScreen,normalsize:e.normalSize}})}),n("div",{staticClass:"md-layout md-gutter md-alignment-center-center"},[e.windows&&0!==e.windows.length?e._e():n("md-empty-state",{attrs:{"md-icon":"static/img/imjoy-io-icon.svg","md-label":"","md-description":""}})],1)],2)},Ke=[],Ge=n("0e54"),Ye=n.n(Ge),Xe={name:"whiteboard",props:{mode:{type:String,default:function(){return"grid"}},selected_window:{type:Object,default:function(){return null}},windows:{type:Array,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{row_height:30,column_width:30,col_num:20,active_windows:[],show_overlay:!1,scrolling:!1,scrollClientY:0,screenWidth:window.innerWidth}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.event_bus.$on("add_window",this.onWindowAdd),this.event_bus.$on("resize",this.updateSize);var e=new Ye.a.Renderer;e.link=function(e,t,n){var i=Ye.a.Renderer.prototype.link.call(this,e,t,n);return i.replace("<a","<a target='_blank' ")},Ye.a.setOptions({renderer:e}),this.marked=Ye.a,this.screenWidth=window.innerWidth,this.col_num=parseInt(this.screenWidth/80)},mounted:function(){},beforeDestroy:function(){this.event_bus.$off("add_window",this.onWindowAdd),this.event_bus.$off("resize",this.updateSize)},methods:{overlayMousemove:function(e){var t,n=this,i=this.$refs.whiteboard.getBoundingClientRect(),o=i.y,a=i.y+i.height;this.scrollClientY=e.clientY,this.scrollClientY<o+10?(t=function(){n.$refs.whiteboard.scrollTop=n.$refs.whiteboard.scrollTop-(o-n.scrollClientY)/2,n.show_overlay&&n.scrollClientY<o?(n.scrolling=!0,window.requestAnimationFrame(t)):n.scrolling=!1},this.scrolling||t()):this.scrollClientY>a-20&&(t=function(){n.$refs.whiteboard.scrollTop=n.$refs.whiteboard.scrollTop+(n.scrollClientY-a+20)/2,n.show_overlay&&n.scrollClientY>a-10?(n.scrolling=!0,window.requestAnimationFrame(t)):n.scrolling=!1},this.scrolling||t())},updateSize:function(e){this.screenWidth=e.width,this.col_num=parseInt(this.screenWidth/80)},onWindowAdd:function(e){this.selectWindow(e,{})},close:function(e){var t=this.active_windows.indexOf(e);t>=0&&(this.active_windows[t].selected=!1,this.active_windows[t].refresh(),this.active_windows.splice(t,1),this.$emit("select",this.active_windows,null)),console.log("closing window",e),this.$emit("close",e)},isTypedArray:function(e){return!!e&&void 0!==e.byteLength},fullScreen:function(e){var t=parseInt(this.$refs.whiteboard.clientHeight/this.row_height)-10,n=parseInt(this.$refs.whiteboard.clientWidth/this.column_width)-1;e._h=e.h,e._w=e.w,e.h=t,e.w=n,setTimeout(function(){e.resize&&e.resize(),e.refresh()},1e3)},normalSize:function(e){e.h=e._h||5,e.w=e._w||5,e._w=null,e._h=null,setTimeout(function(){e.resize&&e.resize(),e.refresh()},1e3)},duplicate:function(e){var t=Object.assign({},e);t.iframe_container&&(t.iframe_container="plugin_window_"+t.id+Object(M["g"])()),t.i=t.i+"_",e.renderWindow&&(t.renderWindow=e.renderWindow),t.id=t.name+Object(M["g"])(),this.windows.push(t),this.$emit("add",t)},unselectWindows:function(){if(this.active_windows&&this.active_windows.length>0){for(var e=0;e<this.active_windows.length;e++)this.active_windows[e].selected=!1,this.active_windows[e].refresh();this.active_windows=[],this.$emit("select",[],null),this.$forceUpdate()}},selectWindow:function(e,t){if(e.selected=!0,e.refresh&&e.refresh(),this.active_windows.length<=0||this.active_windows[this.active_windows.length-1]!==e){if(!t.shiftKey)for(var n=0;n<this.active_windows.length;n++)this.active_windows[n].selected=!1,this.active_windows[n].refresh();t.shiftKey&&this.active_windows.length>0?this.active_windows.push(e):this.active_windows=[e],this.$emit("select",this.active_windows,e)}else if(!t.shiftKey&&this.active_windows.length>1){for(var i=0;i<this.active_windows.length;i++)this.active_windows[i]!==e&&(this.active_windows[i].selected=!1),this.active_windows[i].refresh();this.active_windows=[e]}this.$forceUpdate()},viewChanging:function(){this.show_overlay=!0},focusWindow:function(e){this.show_overlay=!1,this.selectWindow(e,{})},stopDragging:function(){var e=this;setTimeout(function(){e.show_overlay=!1,e.$forceUpdate()},300)}}},Qe=Xe,Ze=(n("7544"),Object(c["a"])(Qe,He,Ke,!1,null,"8ff2a964",null));Ze.options.__file="Whiteboard.vue";var et=Ze.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"joy"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"joy-container"},[n("div",{ref:"editor",staticClass:"joy-editor"})])])},nt=[],it=void 0,ot={name:"joy",props:{show:{type:Boolean,default:function(){return!0}},config:{type:Object,default:function(){return{}}}},data:function(){return{joy:null,isRunning:!1}},created:function(){this.store=this.$root.$data.store},mounted:function(){setTimeout(this.setupJoy,500)},watch:{config:function(){it.setupJoy&&it.setupJoy()}},methods:{editSource:function(){this.$emit("edit",this.config)},setupJoy:function(e){!e&&this.joy&&(this.config.data=this.joy.top.data),this.$refs.editor.innerHTML="";var t={container:this.$refs.editor,init:this.config.ui||"",data:this.config.data,modules:this.config.modules||["instructions","math"],onexecute:this.config.onexecute,onupdate:this.config.onupdate};try{this.joy=new ve["a"](t)}catch(n){console.error("error occured when loading the workflow",n),t.data="",this.joy=new ve["a"](t)}this.config.joy=this.joy},runJoy:function(){this.$emit("run",this.joy)},stopJoy:function(){this.$emit("stop")}}},at=ot,rt=(n("27e7"),Object(c["a"])(at,tt,nt,!1,null,null,null));rt.options.__file="Joy.vue";var st=rt.exports,lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"plugin-list"},[e.title?n("md-subheader",[e._v(e._s(e.title)+" "),e.name?n("span",[e._v(e._s(e.name))]):e._e()]):e._e(),e.description?n("p",[e._v(e._s(e.description))]):e._e(),n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("md-field",{staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[e._v("search")]),n("md-input",{attrs:{placeholder:"Search by name..."},on:{input:e.searchPlugin},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("md-button",{directives:[{name:"show",rawName:"v-show",value:!e.search&&e.installPlugin,expression:"!search && installPlugin"}],staticClass:"md-button md-primary",on:{click:function(t){e.updateAll()}}},[n("md-icon",[e._v("update")]),n("span",{staticClass:"md-small-hide"},[e._v("Update All")])],1)],1),"list"===e.display?n("md-list",{staticClass:"md-triple-line md-dense"},e._l(e.searched_plugins,function(t,i){return n("div",{key:i},[n("md-list-item",[n("md-avatar",[t.icon?n("md-icon",[e._v(e._s(t.icon))]):n("md-icon",[e._v("extension")])],1),n("div",{staticClass:"md-list-item-text"},[n("span",[e._v(e._s("native-python"===t.type?t.name+" ðŸš€":t.name))]),n("p",[e._v(e._s(t.description))]),n("p",e._l(t.tags,function(t){return n("span",{key:t},[e._v(e._s(t)+", ")])}))]),n("p",[e.removePlugin&&t.installed?n("md-button",{staticClass:"md-icon-button md-list-action md-accent",on:{click:function(n){e.plugin2_remove_=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),n("md-tooltip",[e._v("Delete "+e._s(t.name))])],1):e._e(),e.installPlugin&&!t.installed&&t.tags&&t.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Install "+e._s(t.name))])],1),n("md-menu-content",e._l(t.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){e.install(t,i)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(i)+"\n            ")],1)}))],1):!t.installed&&e.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Install "+e._s(t.name))])],1):e._e(),t.installed&&e.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("update")]),n("md-tooltip",[e._v("Update "+e._s(t.name))])],1):e._e()],1),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[e._v("more_horiz")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showDocs(t)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n            ")],1),t.installed&&e.installPlugin?n("md-menu-item",{on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("update")]),e._v("Update\n            ")],1):e._e(),t.installed&&e.removePlugin?n("md-menu-item",{on:{click:function(n){e.plugin2_remove_=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Delete\n            ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.showCode(t)}}},[n("md-icon",[e._v("code")]),e._v("Code\n            ")],1)],1)],1)],1),n("md-divider",{staticClass:"md-inset"})],1)})):e._e(),"card"===e.display?n("div",[e._l(e.searched_plugins,function(t,i){return n("md-card",{key:i},[n("md-card-header",[e._v("\n        "+e._s(t.createdAt)+"\n        "),n("h2",[e._v(e._s("native-python"===t.type?t.name+" ðŸš€":t.name))]),n("p",[e._v(e._s(t.description))]),e._l(t.tags,function(t){return n("md-chip",{key:t},[e._v(e._s(t))])})],2),n("md-card-content",[e.installPlugin&&!t.installed&&t.tags&&t.tags.length>0&&t.uri?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("cloud_download")]),e._v("Install\n          ")],1),n("md-menu-content",e._l(t.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){e.install(t,i)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(i)+"\n            ")],1)}))],1):e.installPlugin&&!t.installed&&t.uri?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Install")],1):e._e(),e.installPlugin&&t.installed&&t.uri?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.install(t,t.tag)}}},[n("md-icon",[e._v("update")]),e._v("Update")],1):e._e(),e.removePlugin&&t.installed?n("md-button",{staticClass:"md-accent",on:{click:function(n){e.plugin2_remove_=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Delete")],1):e._e(),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.showDocs(t)}}},[n("md-icon",[e._v("note")]),e._v("Docs\n        ")],1),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.showCode(t)}}},[n("md-icon",[e._v("code")]),e._v("Code\n        ")],1)],1)],1)}),n("grid",{staticClass:"grid-container",attrs:{center:e.center,draggable:!1,sortable:!0,items:e.searched_plugins,"cell-width":380,"cell-height":280,"grid-width":e.containerWidth},scopedSlots:e._u([{key:"cell",fn:function(t){return[n("md-card",[n("md-card-header",[n("h2",[t.item.icon?n("md-icon",[e._v(e._s(t.item.icon))]):n("md-icon",[e._v("extension")]),e._v("\n           "+e._s("native-python"===t.item.type?t.item.name+" ðŸš€":t.item.name)+"\n\n         ")],1),n("p",[e._v(e._s(t.item.description))]),e._l(t.item.tags,function(t){return n("md-chip",{key:t},[e._v(e._s(t))])})],2),n("md-card-content",[e.installPlugin&&!t.item.installed&&t.item.tags&&t.item.tags.length>0&&t.item.uri?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("cloud_download")]),e._v("Install\n           ")],1),n("md-menu-content",e._l(t.item.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){e.install(t.item,i)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(i)+"\n             ")],1)}))],1):!t.item.installed&&e.installPlugin&&t.item.uri?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.install(t.item)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Install")],1):e._e(),t.item.installed&&e.installPlugin&&t.item.uri?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.install(t.item,t.item.tag)}}},[n("md-icon",[e._v("update")]),e._v("Update")],1):e._e(),t.item.installed&&e.removePlugin?n("md-button",{staticClass:"md-accent",on:{click:function(n){e.plugin2_remove_=t.item,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Delete")],1):e._e(),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.showDocs(t.item)}}},[n("md-icon",[e._v("note")]),e._v("Docs\n         ")],1),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){e.showCode(t.item)}}},[n("md-icon",[e._v("code")]),e._v("Code")],1)],1)],1)]}}])})],2):e._e(),n("br"),n("md-dialog-confirm",{attrs:{"md-active":e.showRemoveConfirmation,"md-title":"Removing Plugin","md-content":"Do you really want to <strong>delete</strong> this plugin","md-confirm-text":"Yes","md-cancel-text":"Cancel"},on:{"update:mdActive":function(t){e.showRemoveConfirmation=t},"md-cancel":function(t){e.showRemoveConfirmation=!1},"md-confirm":function(t){e.remove(e.plugin2_remove_),e.showRemoveConfirmation=!1}}}),n("md-dialog",{staticClass:"editor-dialog",attrs:{"md-active":e.showEditor},on:{"update:mdActive":function(t){e.showEditor=t}}},[n("md-dialog-title",[e._v(e._s(e.plugin_name))]),n("md-dialog-content",[e.showEditor?n("plugin-editor",{staticClass:"code-editor",attrs:{title:"Plugin Editor"},model:{value:e.editorCode,callback:function(t){e.editorCode=t},expression:"editorCode"}}):e._e()],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.downloadCode()}}},[e._v("Download")]),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showEditor=!1}}},[e._v("Exit")])],1)],1),n("md-dialog",{attrs:{"md-active":e.showDocsDialog},on:{"update:mdActive":function(t){e.showDocsDialog=t}}},[n("md-dialog-content",[e.docs&&""!=e.docs.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px"},domProps:{innerHTML:e._s(e.marked(e.docs,{sanitize:!0}))}}):n("h3",[e._v(" Oops, this plugin has no documentation!")])]),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showDocsDialog=!1}}},[e._v("OK")])],1)],1)],1)},ct=[],ut=(n("386d"),{name:"plugin-list",props:{name:{type:String,default:null},description:{type:String,default:null},configUrl:{type:String,default:null},database:{type:w["a"],default:null},workspace:{type:String,default:"default"},title:{type:String,default:null},display:{type:String,default:function(){return"list"}},initSearch:{type:String,default:null},center:{type:Boolean,default:!0},plugins:{type:Array,default:function(){return null}},installPlugin:{type:Function,default:null},removePlugin:{type:Function,default:null}},data:function(){return{search:"",editorCode:"",editorPlugin:null,showEditor:!1,plugin_name:"",containerWidth:500,uri_root:null,plugin_dir:null,manifest:null,available_plugins:[],searched_plugins:[],showRemoveConfirmation:!1,plugin2_remove_:null,showDocsDialog:!1,docs:null,db:null}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.marked=Ye.a},mounted:function(){var e=this;this.search=this.initSearch||"",this.containerWidth=this.$refs.container.offsetWidth,this.event_bus.$on("resize",this.updateSize),this.db=this.database||new w["a"](this.workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),this.plugins?(this.available_plugins=this.plugins,this.searched_plugins=this.plugins,this.search&&this.searchPlugin()):this.configUrl&&v.a.get(this.configUrl).then(function(t){if(t&&t.data&&t.data.plugins){e.manifest=t.data,e.available_plugins=e.manifest.plugins,e.searched_plugins=e.manifest.plugins;var n=e.manifest.uri_root;n.startsWith("http")||(n=e.configUrl.replace(new RegExp("manifest.imjoy.json$"),_e.a.trim(n,"/")));for(var i=0;i<e.available_plugins.length;i++){var o=e.available_plugins[i];o.uri=o.uri||o.name+".html",o.uri.startsWith(n)||o.uri.startsWith("http")||(o.uri=n+"/"+o.uri),o._id=o._id||o.name.replace(/ /g,"_")}e.plugin_dir=e.manifest.uri_root,e.plugin_dir?(e.uri_root=location.protocol+"//"+location.host,e.plugin_dir.startsWith("http")||(e.plugin_dir=e.uri_root+e.plugin_dir)):(e.uri_root="",e.plugin_dir=""),e.search&&e.searchPlugin()}})},beforeDestroy:function(){this.event_bus.$off("resize",this.updateSize)},watch:{plugins:{handler:function(e){this.$data.available_plugins=e,this.$data.searched_plugins=e},deep:!0}},methods:{toLower:function(e){return e.toString().toLowerCase()},searchByName:function(e,t){var n=this;return t?e.filter(function(e){return n.toLower(e.name+" "+e.description).includes(n.toLower(t))}):e},searchPlugin:function(){this.searched_plugins=this.searchByName(this.available_plugins,this.search)},updateSize:function(){this.containerWidth=this.$refs.container.offsetWidth},downloadCode:function(){this.$emit("input",this.codeValue);var e=this.window&&this.window.plugin&&this.window.plugin.name?this.window.plugin.name+"_"+Object(M["g"])()+".imjoy.html":"plugin_"+Object(M["g"])()+".imjoy.html",t=new Blob([this.codeValue],{type:"text/plain;charset=utf-8"});Object(b["saveAs"])(t,e)},showDocs:function(e){var t=this;if(e.installed)this.db.get(e._id).then(function(e){var n=me(e.code);t.docs=n.docs&&n.docs[0]&&n.docs[0].content,t.showDocsDialog=!0,t.$forceUpdate()}).catch(function(t){console.log("error occured when editing ",e.name,t)});else{var n=e.uri;v.a.get(n).then(function(e){if(e&&e.data){var i=me(e.data);t.docs=i.docs&&i.docs[0]&&i.docs[0].content,t.showDocsDialog=!0,t.$forceUpdate()}else alert("failed to get plugin code from "+n)})}},showCode:function(e){var t=this;if(e.installed)this.db.get(e._id).then(function(n){t.editorCode=n.code,t.editorPlugin=e,t.plugin_name="Plugin Source Code:"+e.name,t.showEditor=!0,t.$forceUpdate()}).catch(function(t){console.log("error occured when editing ",e.name,t)});else{var n=e.uri;v.a.get(n).then(function(i){i&&i.data?(t.editorCode=i.data,t.editorPlugin=e,t.plugin_name="Plugin Source Code",t.showEditor=!0,t.$forceUpdate()):alert("failed to get plugin code from "+n)})}},updateAll:function(){var e=this,t=[],n=!0,i=!1,o=void 0;try{for(var a,r=this.available_plugins[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;s.installed&&t.push(this.install(s,s.tag))}}catch(l){i=!0,o=l}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}Promise.all(t).then(function(){console.log("All plugins updated successfully."),e.$emit("message","All plugins updated successfully.")}).catch(function(t){console.error("Plugins updated with error.",t),e.$emit("message","Plugins updated with error.")})},install:function(e,t){var n=this;if(this.installPlugin){var i=this.installPlugin(e,t);i&&i.then(function(){n.$forceUpdate()}).catch(function(e){n.$emit("message",e),n.$forceUpdate()})}},remove:function(e){var t=this;if(this.removePlugin){var n=this.removePlugin(e);n&&n.then(function(){t.$forceUpdate()}).catch(function(e){t.$emit("message",e),t.$forceUpdate()})}}}}),dt=ut,pt=(n("629f"),Object(c["a"])(dt,lt,ct,!1,null,"e8a30d50",null));pt.options.__file="PluginList.vue";var mt=pt.exports,ht=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"plugin-editor"},[e.window?n("md-toolbar",{staticClass:"md-dense editor-toolbar md-layout",attrs:{"md-elevation":"1"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.save()}}},[n("md-icon",[e._v("save")]),n("md-tooltip",[e._v("Save this plugin")])],1),n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.saveAs()}}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Export this plugin")])],1),e.window&&e.window.plugin&&e.window.plugin.config&&e.window.plugin.config._id?n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.remove()}}},[n("md-icon",[e._v("delete")]),n("md-tooltip",[e._v("Remove this plugin")])],1):e._e(),n("span"),e.window&&e.window.plugin&&e.window.plugin.tags&&e.window.plugin.tags.length>0?n("md-field",[n("md-select",{attrs:{id:"tag",name:"tag"},on:{"md-selected":function(t){e.window.plugin.tags.includes(e.window.plugin.tag)&&e.reload()}},model:{value:e.window.plugin.tag,callback:function(t){e.$set(e.window.plugin,"tag",t)},expression:"window.plugin.tag"}},e._l(e.window.plugin.tags,function(t){return n("md-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),n("md-tooltip",[e._v("Select a tag for testing, the plugin will be reloaded.")])],1):e._e()],1)]):e._e(),n("monaco-editor",{ref:"monaco_editor",staticClass:"code_editor",class:e.window?"editor-with-toolbar":"editor-without-toolbar",attrs:{language:"html"},model:{value:e.codeValue,callback:function(t){e.codeValue=t},expression:"codeValue"}})],1)},ft=[];window.MonacoEnvironment={getWorkerUrl:function(){var e=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");return"data:text/javascript;charset=utf-8,".concat(encodeURIComponent("\n      self.MonacoEnvironment = {\n        baseUrl: '".concat(e,"/static'\n      };\n      try {\n        importScripts('").concat(e,"/static/vs/base/worker/workerMain.js');\n      } catch (e) {\n        console.error(e)\n      } finally {\n\n      }\n      ")))}};var gt={name:"joy",props:["value","title","pluginId","window"],data:function(){return{codeValue:"",editor:null}},created:function(){this.store=this.$root.$data.store},watch:{},mounted:function(){var e=this;this.codeValue=this.value,this.editor=this.$refs.monaco_editor.getMonaco(),this.editor.layout(),this.window&&(this.window.resize=function(){setTimeout(function(){e.editor.layout()},200),setTimeout(function(){e.editor.layout()},500)}),setTimeout(function(){e.editor.layout()},200),setTimeout(function(){e.editor.layout()},500),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_S,function(){e.save()})},methods:{save:function(){var e=this;this.$emit("input",this.codeValue),this.window.save({pluginId:this.pluginId,code:this.codeValue,tag:this.window.plugin&&this.window.plugin.tag}).then(function(t){e.window.data.config=t,e.reload().finally(function(){e.window.data._id=t._id,e.window.plugin=t,e.window.name=t.name,e.window.data._name=t.name,e.$forceUpdate()})})},remove:function(){var e=this;this.$emit("input",this.codeValue),this.window.data._id=null,this.window.remove(this.window.plugin).then(function(){e.window.plugin={}})},reload:function(){var e=this;return new Promise(function(t,n){if(e.codeValue){e.$emit("input",e.codeValue),e.window.plugin&&e.window.plugin.config&&(e.window.plugin.config.code=e.codeValue);var i=e.window.plugin.tag,o=e.window.data&&e.window.data.config;o&&e.window.plugin&&e.window.plugin.tag&&(e.window.data.config.tags.includes(e.window.plugin.tag)||(i=e.window.data.config.tags[0])),e.window.reload({_id:e.window.data._id,tag:i,name:e.window.data._name,code:e.codeValue}).then(function(n){e.window.plugin=n,e.$forceUpdate(),t()}).catch(function(e){n(e)})}})},saveAs:function(){this.$emit("input",this.codeValue);var e=this.window&&this.window.plugin&&this.window.plugin.name?this.window.plugin.name+"_"+Object(M["g"])()+".imjoy.html":"plugin_"+Object(M["g"])()+".imjoy.html",t=new Blob([this.codeValue],{type:"text/plain;charset=utf-8"});Object(b["saveAs"])(t,e)}}},_t=gt,vt=(n("d9a4"),Object(c["a"])(_t,ht,ft,!1,null,"a9a69c86",null));vt.options.__file="PluginEditor.vue";var wt=vt.exports,bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("div",[e.isFolder?n("span",{on:{click:e.toggle}},[e._v("["+e._s(e.open?"-":"+")+"]")]):e._e(),n("span",{staticClass:"noselect",on:{click:function(t){e.select({target:e.model,path:e.root},t.shiftKey)},dblclick:function(t){e.load()}}},["file"===e.model.type?n("md-icon",[e._v("insert_drive_file")]):n("md-icon",[e._v("folder_open")]),n("span",{staticClass:"noselect",class:{bold:e.isFolder,selected:e.root===e.selected||e.selected&&Array.isArray(e.selected)&&e.selected.indexOf(e.root)>=0}},[e._v(e._s(e.model.name))])],1),e.isFolder||e.model.children&&0===e.model.children.length?n("span",{staticClass:"item",on:{click:function(t){e.up()}}},[n("md-icon",[e._v("arrow_upward")])],1):e._e()]),e.open&&e.isFolder?n("ul",e._l(e.model.children.slice(0,300),function(t,i){return n("file-item",{key:i,staticClass:"item",attrs:{root:e.root+"/"+t.name,model:t,selected:e.selected},on:{load:function(t){e.load(t)},select:function(t){e.select(t)},select_append:function(t){e.select(t,!0)}}})})):e._e()])},yt=[],kt={name:"file-item",props:{model:Object,selected:[String,Array],root:{type:String,default:"."}},data:function(){return{open:!0}},mounted:function(){},computed:{isFolder:function(){return this.model.children&&this.model.children.length}},methods:{up:function(e){this.$emit("load",e||{target:this.model,path:this.root+"/../"})},load:function(e){this.$emit("load",e||{target:this.model,path:this.root})},select:function(e,t){t?this.$emit("select_append",e||{target:this.model,path:this.root+"/"+this.model.name}):this.$emit("select",e||{target:this.model,path:this.root+"/"+this.model.name})},toggle:function(){this.isFolder&&(this.open=!this.open)}}},Ct=kt,xt=(n("db43"),Object(c["a"])(Ct,bt,yt,!1,null,"2851a6ba",null));xt.options.__file="FileItem.vue";var Pt=xt.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-dialog"},[n("md-dialog",{attrs:{"md-active":e.show_,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.show_=t}}},[n("md-dialog-title",[e._v(e._s(this.options.title||"ImJoy File Dialog"))]),n("md-dialog-content",[e.file_tree?n("ul",[n("file-item",{attrs:{model:e.file_tree,root:e.root,selected:e.file_tree_selection},on:{load:e.loadFile,select:e.fileTreeSelected,select_append:e.fileTreeSelectedAppend}})],1):e._e()]),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",attrs:{disabled:!e.file_tree_selection},on:{click:function(t){e.show_=!1,e.resolve(e.file_tree_selection)}}},[e._v("OK "),e.file_tree_selection?n("md-tooltip",[e._v("Selected: "+e._s(e.file_tree_selection))]):e._e()],1),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.show_=!1,e.reject("file dialog canceled by the user.")}}},[e._v("Cancel")])],1)],1)],1)},Et=[],Ot={name:"file-dialog",props:{getFileUrl:Function,listFiles:Function,mode:String},data:function(){return{root:null,options:{},show_:!1,file_tree_selection:null,file_tree:null,resolve:null,reject:null}},mounted:function(){},computed:{},methods:{fileTreeSelected:function(e){"file"===this.options.type&&"dir"===e.target.type||(this.file_tree_selection=e.path,this.$forceUpdate())},fileTreeSelectedAppend:function(e){Array.isArray(this.file_tree_selection)||(this.file_tree_selection=this.file_tree_selection?[this.file_tree_selection]:[]),this.file_tree_selection.push(e.path),this.$forceUpdate()},loadFile:function(e){var t=this;"file"!=e.target.type?this.listFiles(e.path,this.options.type,this.options.recursive).then(function(e){t.root=e.path,t.file_tree=e,t.$forceUpdate()}):(this.show_=!1,"single"===this.options.mode&&"object"===Object(h["a"])(this.file_tree_selection)?this.resolve(this.file_tree_selection[0]):"multiple"===this.options.mode&&"string"===typeof this.file_tree_selection?this.resolve([this.file_tree_selection]):this.resolve(this.file_tree_selection))},showDialog:function(e,t){var n=this;return this.show_=!0,this.options=e,this.options.title=this.options.title||"ImJoy File Dialog",this.options.root=this.options.root||"~",this.options.mode=this.options.mode||"single|multiple",this.options.uri_type=this.options.uri_type||"path","file"!=this.options.type&&this.options.root?this.file_tree_selection=this.options.root:this.file_tree_selection=null,new Promise(function(i,o){"path"===n.options.uri_type?(n.resolve=i,n.reject=o):"url"===n.options.uri_type?(n.reject=o,n.resolve=function(e){if("string"===typeof e)n.getFileUrl(e,t).then(i).catch(o);else{var a=[],r=!0,s=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var d=c.value;a.push(n.getFileUrl(d,t))}}catch(p){s=!0,l=p}finally{try{r||null==u.return||u.return()}finally{if(s)throw l}}Promise.all(a).then(i).catch(o)}}):o("unsupported uri_type: "+n.options.uri_type),n.root=n.options.root,n.listFiles(e.root,e.type,e.recursive).then(function(e){n.root=e.path,n.file_tree=e,n.$forceUpdate()})})}}},Dt=Ot,St=(n("c3b4"),Object(c["a"])(Dt,jt,Et,!1,null,"430dd838",null));St.options.__file="FileDialog.vue";var It=St.exports,$t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-card",[n("md-card-expand",{class:{"drag-handle":e.withDragHandle},nativeOn:{click:function(t){t.stopPropagation(),e.selectWindow(e.w,t)}}},[n("md-card-actions",{class:e.w.selected?"window-selected":"window-header",attrs:{"md-alignment":"space-between"}},[e.w.panel?n("md-card-expand-trigger",[n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[e._v("keyboard_arrow_down")])],1)],1):e._e(),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(t){e.close(e.w)}}},[n("md-icon",[e._v("close")])],1),n("div",{staticClass:"window-title noselect",on:{dblclick:function(t){e.w._h&&e.w._w?e.normalSize(e.w):e.fullScreen(e.w)}}},[e._v(e._s(e.w.name.slice(0,30)+"(#"+e.w.i+")"))]),n("div",[n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_vert")])],1),n("md-menu-content",[e.w._h&&e.w._w?n("md-menu-item",{on:{click:function(t){t.stopPropagation(),e.normalSize(e.w)}}},[n("span",[e._v("Normal view")]),n("md-icon",[e._v("fullscreen")])],1):n("md-menu-item",{on:{click:function(t){t.stopPropagation(),e.fullScreen(e.w)}}},[n("span",[e._v("Fullscreen")]),n("md-icon",[e._v("fullscreen")])],1),n("md-menu-item",{on:{click:function(t){t.stopPropagation(),e.duplicate(e.w)}}},[n("span",[e._v("Duplicate")]),n("md-icon",[e._v("filter")])],1),n("md-menu-item",{on:{click:function(t){e.printObject(e.w.type,e.w.data,e.w)}}},[n("span",[e._v("Console.log")]),n("md-icon",[e._v("bug_report")])],1),e._l(e.w.loaders,function(t,i){return n("md-menu-item",{key:i,on:{click:function(n){e.loaders&&e.loaders[t](e.w.data)}}},[n("span",[e._v(e._s(i))]),n("md-icon",[e._v("play_arrow")])],1)})],2)],1)],1)],1),e.w.panel?n("md-card-expand-content",[n("md-card-content",[n("joy",{attrs:{config:e.w.panel}})],1)],1):e._e()],1),n("md-card-content",{class:e.w.scroll?"plugin-iframe-container allow-scroll":"plugin-iframe-container"},["empty"===e.w.type?n("md-empty-state",{attrs:{"md-icon":"hourglass_empty","md-label":"IMJOY.IO","md-description":""}}):e._e(),"imjoy/files"===e.w.type?n("div",{staticClass:"generic-plugin-window"},[n("md-list",e._l(e.w.data,function(t,i){return n("md-list-item",{key:t.name+t.relativePath},[n("md-radio",{attrs:{value:i},model:{value:e.w.select,callback:function(t){e.$set(e.w,"select",t)},expression:"w.select"}}),n("span",{staticClass:"md-list-item-text",staticStyle:{cursor:"pointer"},on:{click:function(n){e.loaders&&t.loaders&&Object.keys(t.loaders).length>0&&e.loaders[t.loaders[Object.keys(t.loaders)[0]]](t)}}},[e._v(e._s(t.name))]),t.loaders&&Object.keys(t.loaders).length>0?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_horiz")])],1),n("md-menu-content",e._l(t.loaders,function(i,o){return n("md-menu-item",{key:o,on:{click:function(n){e.loaders&&e.loaders[i](t)}}},[n("span",[e._v(e._s(o))]),n("md-icon",[e._v("play_arrow")])],1)}))],1):e._e()],1)}))],1):"imjoy/url_list"===e.w.type?n("div",[e.w.data.length&&e.w.data.length>0?n("ul",e._l(e.w.data,function(t){return n("li",{key:t.href||t},[n("a",{attrs:{href:t.href||t,target:"_blank"}},[e._v(e._s(t.text||t))])])})):n("p",[e._v(" No url.")])]):"imjoy/image"===e.w.type?n("div",{staticClass:"fill-container"},[e.w.data.src?n("img",{staticStyle:{height:"100%",width:"100%","object-fit":"contain"},attrs:{src:e.w.data.src}}):n("p",[e._v(" No image available for display.")])]):"imjoy/images"===e.w.type?n("div",{staticClass:"allow-scroll fill-container"},[e._l(e.w.data.images,function(e,t){return n("img",{key:t,staticStyle:{height:"100%",width:"100%","object-fit":"contain"},attrs:{src:e}})}),e.w.data.images&&0!=e.w.data.images.length?e._e():n("p",[e._v(" No image available for display.")])],2):"imjoy/panel"===e.w.type?n("div",[n("joy",{attrs:{config:e.w.config}})],1):"imjoy/markdown"===e.w.type?n("div",[e.w.data.source&&""!=e.w.data.source.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px",overflow:"auto"},domProps:{innerHTML:e._s(e.marked(e.w.data.source,{sanitize:!0}))}}):n("h3",[e._v(" Oops, this plugin has no documentation!")])]):"imjoy/generic"===e.w.type?n("div",{staticClass:"generic-plugin-window"},[n("md-list",[e.loaders&&e.w.loaders&&Object.keys(e.w.loaders).length>0?n("md-list-item",{staticClass:"md-primary",on:{click:function(t){e.loaders[e.w.loaders[Object.keys(e.w.loaders)[0]]](e.w.data)}}},[n("span",{staticClass:"md-list-item-text md-primary"},[e._v('Open with "'+e._s(Object.keys(e.w.loaders)[0])+'"')]),n("md-tooltip",[e._v('click to open with "'+e._s(Object.keys(e.w.loaders)[0])+'".')])],1):n("md-list-item",[n("span",{staticClass:"md-list-item-text"},[e._v(e._s(e.dataSummary(e.w)))])]),e._l(e.w.data,function(t,i){return n("md-list-item",{directives:[{name:"show",rawName:"v-show",value:!e.isTypedArray(e.w.data)&&(!i.startsWith||!i.startsWith("_"))&&e.w.data&&!e.w.data.length||(e.w.data.length||e.w.data.byteLength)&&(e.w.data.length||e.w.data.byteLength)>0&&i<=20,expression:" !isTypedArray(w.data) && (!k.startsWith || !k.startsWith('_')) && w.data && (!w.data.length) || ((w.data.length||w.data.byteLength) && (w.data.length||w.data.byteLength) > 0 && k <= 20)"}],key:i},[n("md-icon",[e._v("insert_drive_file")]),n("span",{staticClass:"md-list-item-text",on:{click:function(n){e.printObject(i,t)}}},[e._v(e._s(i))])],1)}),e.w.data&&(e.w.data.length||e.w.data.byteLength)&&(e.w.data.length||e.w.data.byteLength)>20?n("md-list-item",{on:{click:function(t){e.printObject(e.w.data)}}},[n("md-icon",[e._v("insert_drive_file")]),n("span",{staticClass:"md-list-item-text"},[e._v("...")]),n("md-tooltip",[e._v("click to print the data in your console.")])],1):e._e()],2)],1):"imjoy/plugin-editor"===e.w.type?n("plugin-editor",{staticClass:"no-drag fill-container",attrs:{pluginId:e.w.data.id,window:e.w,editorId:"editor_"+e.w.data.id},model:{value:e.w.data.code,callback:function(t){e.$set(e.w.data,"code",t)},expression:"w.data.code"}}):n("div",{staticClass:"plugin-iframe"},[n("div",{staticClass:"plugin-iframe",attrs:{id:e.w.iframe_container}})])],1)],1)},Mt=[],Wt={name:"window",props:{w:{type:Object,default:function(){return null}},withDragHandle:{type:Boolean,default:function(){return!1}},loaders:{type:Object,default:function(){return null}}},data:function(){return{}},created:function(){var e=new Ye.a.Renderer;e.link=function(e,t,n){var i=Ye.a.Renderer.prototype.link.call(this,e,t,n);return i.replace("<a","<a target='_blank' ")},Ye.a.setOptions({renderer:e}),this.marked=Ye.a},mounted:function(){this.w.refresh=this.refresh},beforeDestroy:function(){},methods:{refresh:function(){this.$forceUpdate()},close:function(e){this.$emit("close",e)},isTypedArray:function(e){return!!e&&void 0!==e.byteLength},fullScreen:function(e){this.$emit("fullscreen",e)},normalSize:function(e){this.$emit("normalsize",e)},duplicate:function(e){this.$emit("duplicate",e)},selectWindow:function(e,t){this.$emit("select",e,t)},printObject:function(e,t,n){console.log(e,t,n)},dataSummary:function(e){return Array.isArray(e.data)?"".concat(e.type,", ").concat(Object(h["a"])(e.data),", length: ").concat(e.data.length):e.data.buffer&&"[object ArrayBuffer]"===Object.prototype.toString.call(e.data.buffer)?"".concat(e.type,", typedarray, length: ").concat(e.data.length):"object"===Object(h["a"])(e.data)?"".concat(e.type,", ").concat(Object(h["a"])(e.data),", length: ").concat(Object.keys(e.data).length):"".concat(e.type)}}},Rt=Wt,At=(n("68c9"),Object(c["a"])(Rt,$t,Mt,!1,null,"94cc4b84",null));At.options.__file="Window.vue";var Tt=At.exports,Ut=new i["default"],Lt={event_bus:Ut},Nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-app",{attrs:{id:"app","md-waterfall":"","md-mode":"fixed"}},[n("md-app-content",[n("router-view")],1)],1)},Ft=[],zt={name:"app",data:function(){return{show_navbar:!0}},mounted:function(){var e=this;window.location.href.indexOf("navbar=0")>=0&&(this.show_navbar=!1),this.$nextTick(function(){var t=function(){e.$root.$data.store.event_bus.$emit("resize",{height:window.innerHeight,width:window.innerWidth})};t(),document.addEventListener("orientationchange",window.onresize=t)})},methods:{show:function(e,t){this.snackbar_info=e,this.snackbar_duration=t||3e3,this.showSnackbar=!0}},watch:{}},qt=zt,Bt=(n("034f"),Object(c["a"])(qt,Nt,Ft,!1,null,null,null));Bt.options.__file="App.vue";var Jt=Bt.exports,Vt=n("7be8"),Ht=n.n(Vt),Kt=n("d277"),Gt=n.n(Kt),Yt=n("059c");i["default"].config.productionTip=!1,i["default"].use($e.a),i["default"].use(Gt.a),i["default"].component("vue-slider",We.a),i["default"].component("navbar",Ne),i["default"].component("imjoy",Ce),i["default"].component("main-footer",Ve),i["default"].component("about",De),i["default"].component("whiteboard",et),i["default"].component("joy",st),i["default"].component("plugin-list",mt),i["default"].component("plugin-editor",wt),i["default"].component("file-item",Pt),i["default"].component("file-dialog",It),i["default"].component("window",Tt),i["default"].component("grid-layout",Ht.a.GridLayout),i["default"].component("grid-item",Ht.a.GridItem),i["default"].component("monaco-editor",Yt["a"]);var Xt=function(e,t,n){n=n||"...";var i=document.createElement("div");i.innerHTML=e;var o=i.textContent;return o.length>t?o.slice(0,t)+n:o};i["default"].filter("truncate",Xt),new i["default"]({el:"#app",router:Se,data:{store:Lt,router:Se},template:"<App/>",components:{App:Jt}})},"629f":function(e,t,n){"use strict";var i=n("f13e"),o=n.n(i);o.a},"65d0":function(e,t,n){"use strict";var i=n("ac54"),o=n.n(i);o.a},"65d2":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n("55dd"),n("6c7b"),n("4917"),n("34ef"),n("fee7"),n("4504"),n("7f7f"),n("6b54"),n("3b2b"),n("386d"),n("28a5"),n("a481"),n("7514"),n("ac6a"),n("96cf");var i=n("1da1"),o=n("53ca");function a(e){var t=this==window?{}:this;if(e.modules)for(var n=0;n<e.modules.length;n++)a.loadModule(e.modules[n]);return a.Op.call(t,e),a.initReferences(t),void 0==t.previewOps&&(t.previewOps=!1),void 0==t.previewNumbers&&(t.previewNumbers=!1),t.activePreview=null,t.canPreview=function(e){e=e.charAt(0).toUpperCase()+e.slice(1);var n=t["preview"+e];return n&&!t.activePreview},t.createWidget(),t.container&&("string"===typeof t.container&&(t.container=document.body.querySelector(t.container)),t.container.appendChild(t.dom)),a.ui.init(t),a.modal.init(t),t}a.Op=function(e,t,n){var c=this;if(c._class_="Op",c.options=e,c.parent=t,c.top=c.parent?c.parent.top:c,c.type=e.type,c.type){var u=a.getTemplateByType(c.type);s(c,u)}if(s(c,c.options),t&&"object"==Object(o["a"])(t.onupdate)&&t.onupdate[c.id]&&(c.onupdate=t.onupdate[c.id]),c.children=[],c.addChild=function(e,t){return"object"==Object(o["a"])(c.onupdate)&&c.onupdate[e.id]&&(e.onupdate=c.onupdate[e.id]),"Op"!=e._class_&&(e=new a.Op(e,c,t)),c.children.push(e),e.id&&(c[e.id]=e),e},c.removeChild=function(e){l(c.children,e),e.kill()},c.onkill=c.onkill||function(){},c.kill=function(){c.dom&&c.dom.parentNode&&c.dom.parentNode.removeChild(c.dom),unwatch(c.data,m);while(c.children.length>0)c.removeChild(c.children[0]);c.onkill(c)},void 0===c.placeholder&&(c.placeholder={}),"function"===typeof c.placeholder&&(c.placeholder=c.placeholder()),("object"!==Object(o["a"])(c.placeholder)||Array.isArray(c.placeholder))&&(c.placeholder={value:r(c.placeholder)}),c.placeholder.type||(c.placeholder.type=c.type),c.data=c.data||n,!c.data){t=c.parent;var d=c.dataID;t&&d?(t.data[d]||(t.data[d]=r(c.placeholder)),c.data=t.data[d]):c.data=r(c.placeholder)}c.getData=function(e){return c.data[e]},c.setData=function(e,t,n){p=!0,void 0===t?delete c.data[e]:c.data[e]=t,setTimeout(function(){p=!1},1),n||c.update()},c.switchData=function(e){unwatch(c.data,m),c.data=e,watch(c.data,m),c.onDataChange&&c.onDataChange(e)};var p=!1,m=function(e,t,n,i){p||c.onDataChange&&c.onDataChange()};watch(c.data,m),c.dom=null,c.initWidget=c.initWidget||function(){c.dom=document.createElement("span"),c.dom.innerHTML="[todo: define ui for '"+c.type+"']"},c.createWidget=function(){return c.initWidget(c),c.dom},c.previewData=null,c.onexecute=c.onexecute||function(){console.log("no execute function found.")},c.execute=function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=n?r(n):c.previewData?r(c.previewData):r(c.data),c.children.forEach(function(e){var n=e.dataID;if(n){var o=e.get(t);i[n]=o}}),e.next=4,c.onexecute({op:c,target:t,data:i});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),c.update=function(){if(c.parent&&c.parent.update(),c.onupdate&&"function"===typeof c.onupdate){var e;e=c.previewData?r(c.previewData):r(c.data),c.children.forEach(function(t){var n=t.dataID;if(n){var i=t.get({});e[n]=i}});c.onupdate({data:e})}},c.get_config=function(e){var t;return e=e||{},t=c.previewData?r(c.previewData):r(c.data),c.children.forEach(function(n){var i=n.dataID;if(i&&e){var o=n.get(e);t[i]=o}}),t},c.onget=c.onget||function(e){return e.data},c.get=function(e){var t=c.previewData?c.previewData:c.data;return t=r(t),c.onget({op:c,target:e,data:t})},c.init&&("string"===typeof c.init&&a.initializeWithString(c,c.init),"function"===typeof c.init&&c.init(c))},a.templates=[],a.add=function(e){var t=a.templates.filter(function(t){return void 0!==t.type&&void 0!==e.type&&t.type===e.type});if(t.length<=0)a.templates.push(e);else{for(var n=0;n<t.length;n++)l(a.templates,t[n]);a.templates.push(e)}},a.remove=function(e){var t=a.templates.filter(function(t){if(t.type===e)return!0});if(t.length>0)for(var n=0;n<t.length;n++)l(a.templates,t[n])},a.reset=function(){a.templates=[]},a.getTemplateByType=function(e){var t=a.templates.find(function(t){return t.type===e});if(!t)throw Error("No op template of type '"+e+"'!");return t},a.getTemplatesByTag=function(e){return a.templates.filter(function(t){return t.tags&&t.tags.indexOf(e)>=0})},a.modify=function(){var e,t,n;2==arguments.length?(e=arguments[0],n=arguments[1]):(e=arguments[0],t=arguments[1],n=arguments[2]);var i={},o=a.getTemplateByType(e);s(i,o);var r=n(o);s(i,r),t?o.type=t:l(a.templates,o),a.add(i)},a.initializeWithString=function(e,t){for(var n=[],i=t,o=-1,a=-1,r=0,s=0;s<i.length;s++){var l=i[s];if(0==r&&"{"==l&&(o=s),"{"==l&&r++,"}"==l&&r--,0==r&&"}"==l){a=s+1;var c=i.slice(o,a);c=c.replace(/(\w+)\:/g,"'$1':"),c=c.replace(/\'/g,'"'),c=JSON.parse(c),c.dataID=c.dataID||c.id,n.push(c),i=i.substr(0,o)+"<span id='widget_"+c.id+"'></span>"+i.substr(a),s=0,o=-1,a=-1,r=0}}n.forEach(function(t){e.addChild(t)}),e.createWidget=function(){return e.dom=document.createElement("span"),e.dom.innerHTML=i,e.children.forEach(function(t){t.createWidget();var n="#widget_"+t.id,i=e.dom.querySelector(n);e.dom.replaceChild(t.dom,i)}),e.dom}},a.modules={},a.module=function(e,t){a.modules[e]=t},a.loadModule=function(e){var t=a.modules[e];if(!t)throw Error("There's no module called '"+e+"'!");t()},a.initReferences=function(e){var t=e.top.data;for(var n in t._references||(t._references={}),t._references){var i=t._references[n];i.connected=0}},a.createReference=function(e,t,n){var i=e.top.data,o={id:_(i._references),tags:v(t),data:n,connected:0};return i._references[o.id]=o,o},a.getReferenceById=function(e,t){var n=e.top.data;return n._references[t]},a.getReferencesByTag=function(e,t){var n=e.top.data,i=[];for(var o in n._references){var a=n._references[o];a.tags.indexOf(t)>=0&&i.push(a)}return i},a.connectReference=function(e,t){var n=a.getReferenceById(e,t);n.connected++},a.disconnectReference=function(e,t){var n=a.getReferenceById(e,t);n.connected--,0==n.connected&&a.deleteReference(e,t)},a.deleteReference=function(e,t){var n=e.top.data;n._references[t];delete n._references[t]},a.encodeWorkflow=function(e){var t=JSON.stringify(e),n=E.compressToEncodedURIComponent(t);return n},a.decodeWorkflow=function(e){var t=E.decompressFromEncodedURIComponent(e);if(t){var n=JSON.parse(t);return n}return null},a.saveToURL=function(e){var t=JSON.stringify(e),n=E.compressToEncodedURIComponent(t),i=window.location.origin+window.location.pathname+"#/app?workflow="+n;return i},a.loadFromURL=function(){var e=b("workflow"),t=E.decompressFromEncodedURIComponent(e);if(t){var n=JSON.parse(t);return n}return null},Math.TAU=2*Math.PI;var r=function(e){return JSON.parse(JSON.stringify(e))},s=function(e,t){for(var n in t){var i=t[n];e[n]=i}},l=function(e,t){var n=e.indexOf(t);return!(n<0)&&(e.splice(n,1),!0)},c=function(e){if(!+e)return NaN;var t=String(+e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",o=3;while(o--)i=(n[+t.pop()+10*o]||"")+i;var a=Array(+t.join("")+1).join("M")+i;return a.toLowerCase()},u=function(e){var t="abcdefghijklmnopqrstuvwxyz",n=0,i=1;while(e>=i)n++,e-=i,i*=26;for(var o="",a=0;a<n;a++)o=t.charAt(e%26)+o,e=Math.floor(e/26);return o},d=function(e){var t,n;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(n=t.getRangeAt(0),n.deleteContents(),n.insertNode(document.createTextNode(e)))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=e)},p=function(e){e.addEventListener("paste",function(e){if(e.preventDefault(),e.clipboardData&&e.clipboardData.getData){var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}else if(window.clipboardData&&window.clipboardData.getData){t=window.clipboardData.getData("Text");d(t)}})},m=function(e,t){var n=document.createRange();n.selectNodeContents(e),t&&n.collapse(!1);var i=window.getSelection();i.removeAllRanges();try{i.addRange(n)}catch(o){}},h=function(){var e=window.getSelection();e.removeAllRanges()},f=function(e){""==e.innerText&&(e.innerHTML="&nbsp;",m(e)),e.innerHTML.search("<br>")>=0&&(e.innerHTML=e.innerHTML.replace(/(\<br\>)+/g,"&nbsp;"),m(e,!0))},g=function(e){e.addEventListener("keypress",function(t){13===t.which&&(t.preventDefault(),e.blur())})},_=function(e){var t,n=0;do{t="id"+n,n++}while(e[t]);return t},v=function(e){return Array.isArray(e)?e:[e]},w=function(e){while(e.hasChildNodes())e.removeChild(e.lastChild)},b=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null};function y(e,t,n){var i,o,a,r,s,l,c,u;switch(1===arguments.length&&(t=e.s,n=e.v,e=e.h),e/=360,r=Math.floor(6*e),s=6*e-r,l=n*(1-t),c=n*(1-s*t),u=n*(1-(1-s)*t),r%6){case 0:i=n,o=u,a=l;break;case 1:i=c,o=n,a=l;break;case 2:i=l,o=n,a=u;break;case 3:i=l,o=c,a=n;break;case 4:i=u,o=l,a=n;break;case 5:i=n,o=l,a=c;break}return[Math.round(255*i),Math.round(255*o),Math.round(255*a)]}function k(e,t,n){1===arguments.length&&(t=e[1],n=e[2],e=e[0]);var i=y(e,t,n);return"rgb("+i[0]+","+i[1]+","+i[2]+")"}var C=0,x=[[0,.6,1],[30,.8,1],[210,.8,1],[260,.7,1],[310,.6,1]];function P(){var e=x[C];return C=(C+1)%x.length,e}function j(e){return Array.isArray(e)&&(e=k(e[0],e[1],e[2])),e}!function(e){"function"==typeof define&&n("913b")?define(e):(window.WatchJS=e(),window.watch=window.WatchJS.watch,window.unwatch=window.WatchJS.unwatch,window.callWatchers=window.WatchJS.callWatchers)}(function(){function e(){C=null;for(var e=0;e<k.length;e++)k[e]();k.length=0}var t={noMore:!1,useDirtyCheck:!1},n=[],i=[],a=[],r=!1;try{r=Object.defineProperty&&Object.defineProperty({},"x",{})}catch(t){}var s=function(e){var t={};return e&&"[object Function]"==t.toString.call(e)},l=function(e){return"[object Array]"===Object.prototype.toString.call(e)},c=function(e){return"[object Object]"==={}.toString.apply(e)},u=function(e,t){var n=[],i=[];if("string"!=typeof e&&"string"!=typeof t){if(l(e)&&t)for(var o=0;o<e.length;o++)void 0===t[o]&&n.push(o);else for(var o in e)e.hasOwnProperty(o)&&t&&void 0===t[o]&&n.push(o);if(l(t)&&e)for(var a=0;a<t.length;a++)void 0===e[a]&&i.push(a);else for(var a in t)t.hasOwnProperty(a)&&e&&void 0===e[a]&&i.push(a)}return{added:n,removed:i}},d=function(e){if(null==e||"object"!=Object(o["a"])(e))return e;var t=e.constructor();for(var n in e)t[n]=e[n];return t},p=function(e,t,n,i){try{Object.observe(e,function(e){e.forEach(function(e){e.name===t&&i(e.object[e.name])})})}catch(r){try{Object.defineProperty(e,t,{get:n,set:function(e){i.call(this,e,!0)},enumerable:!0,configurable:!0})}catch(r){try{Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,function(e){i.call(this,e,!0)})}catch(n){h(e,t,i)}}}},m=function(e,t,n){try{Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!1,value:n})}catch(a){e[t]=n}},h=function(e,t,n){i[i.length]={prop:t,object:e,orig:d(e[t]),callback:n}},f=function(){s(arguments[1])?g.apply(this,arguments):l(arguments[1])?_.apply(this,arguments):v.apply(this,arguments)},g=function e(t,n,i,o){if("string"!=typeof t&&(t instanceof Object||l(t))){if(l(t)){if(D(t,"__watchall__",n,i),void 0===i||i>0)for(var a=0;a<t.length;a++)e(t[a],n,i,o)}else{var s=[];for(a in t)"$val"==a||!r&&"watchers"===a||Object.prototype.hasOwnProperty.call(t,a)&&s.push(a);_(t,s,n,i,o)}o&&q(t,"$$watchlengthsubjectroot",n,i)}},_=function(e,t,n,i,o){if("string"!=typeof e&&(e instanceof Object||l(e)))for(var a=0;a<t.length;a++){var r=t[a];v(e,r,n,i,o)}},v=function(e,t,n,i,o){"string"!=typeof e&&(e instanceof Object||l(e))&&(s(e[t])||(null!=e[t]&&(void 0===i||i>0)&&g(e[t],n,void 0!==i?i-1:i),D(e,t,n,i),o&&(void 0===i||i>0)&&q(e,t,n,i)))},w=function(){s(arguments[1])?b.apply(this,arguments):l(arguments[1])?y.apply(this,arguments):W.apply(this,arguments)},b=function(e,t){if(!(e instanceof String)&&(e instanceof Object||l(e)))if(l(e)){for(var n=["__watchall__"],i=0;i<e.length;i++)n.push(i);y(e,n,t)}else{var o=function e(n){var i=[];for(var o in n)n.hasOwnProperty(o)&&(n[o]instanceof Object?e(n[o]):i.push(o));y(n,i,t)};o(e)}},y=function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&W(e,t[i],n)},k=[],C=null,x=function(){return C||(C=setTimeout(e)),C},P=function(e){null==C&&x(),k[k.length]=e},j=function(){var e=s(arguments[2])?O:E;e.apply(this,arguments)},E=function(e,t,n,i){var o,a=null,r=-1,s=l(e),c=function(n,i,o,l){var c=x();if(r!==c&&(r=c,a={type:"update"},a.value=e,a.splices=null,P(function(){t.call(this,a),a=null})),s&&e===this&&null!==a){if("pop"===i||"shift"===i)o=[],l=[l];else if("push"===i||"unshift"===i)o=[o],l=[];else if("splice"!==i)return;a.splices||(a.splices=[]),a.splices[a.splices.length]={index:n,deleteCount:l?l.length:0,addedCount:o?o.length:0,added:o,deleted:l}}};o=1==n?void 0:0,g(e,c,o,i)},O=function(e,t,n,i,o){e&&t&&(v(e,t,function(e,t,a,r){var s={type:"update"};s.value=a,s.oldvalue=r,(i&&c(a)||l(a))&&E(a,n,i,o),n.call(this,s)},0),(i&&c(e[t])||l(e[t]))&&E(e[t],n,i,o))},D=function(e,n,i,o){var a=!1,r=l(e);e.watchers||(m(e,"watchers",{}),r&&M(e,function(t,i,a,r){if(L(e,t,i,a,r),0!==o&&a&&(c(a)||l(a))){var s,u,d,p,m=e.watchers[n];for((p=e.watchers.__watchall__)&&(m=m?m.concat(p):p),d=m?m.length:0,s=0;s<d;s++)if("splice"!==i)g(a,m[s],void 0===o?o:o-1);else for(u=0;u<a.length;u++)g(a[u],m[s],void 0===o?o:o-1)}})),e.watchers[n]||(e.watchers[n]=[],r||(a=!0));for(var s=0;s<e.watchers[n].length;s++)if(e.watchers[n][s]===i)return;if(e.watchers[n].push(i),a){var u=e[n],d=function(){return u},f=function(i,a){var r=u;if(u=i,0!==o&&e[n]&&(c(e[n])||l(e[n]))&&!e[n].watchers){var s,d=e.watchers[n].length;for(s=0;s<d;s++)g(e[n],e.watchers[n][s],void 0===o?o:o-1)}return A(e,n)?void T(e,n):void(t.noMore||r!==i&&(a?L(e,n,"set",i,r):S(e,n,"set",i,r),t.noMore=!1))};t.useDirtyCheck?h(e,n,f):p(e,n,d,f)}},S=function e(t,n,i,o,a){if(void 0!==n){var r,s,l=t.watchers[n];(s=t.watchers.__watchall__)&&(l=l?l.concat(s):s),r=l?l.length:0;for(var c=0;c<r;c++)l[c].call(t,n,i,o,a)}else for(var n in t)t.hasOwnProperty(n)&&e(t,n,i,o,a)},I=["pop","push","reverse","shift","sort","slice","unshift","splice"],$=function(e,t,n,i){m(e,n,function(){var o,a,r,s,l=0;if("splice"===n){var c=arguments[0],u=c+arguments[1];for(r=e.slice(c,u),a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];l=c}else a=arguments.length>0?arguments[0]:void 0;return s=t.apply(e,arguments),"slice"!==n&&("pop"===n?(r=s,l=e.length):"push"===n?l=e.length-1:"shift"===n?r=s:"unshift"!==n&&void 0===a&&(a=s),i.call(e,l,n,a,r)),s})},M=function(e,t){if(s(t)&&e&&!(e instanceof String)&&l(e))for(var n,i=I.length;i--;)n=I[i],$(e,e[n],n,t)},W=function(e,t,n){if(t){if(e.watchers[t])if(void 0===n)delete e.watchers[t];else for(var i=0;i<e.watchers[t].length;i++){var o=e.watchers[t][i];o==n&&e.watchers[t].splice(i,1)}}else delete e.watchers;B(e,t,n),J(e,t)},R=function(e,t){if(e.watchers){var n="__wjs_suspend__"+(void 0!==t?t:"");e.watchers[n]=!0}},A=function(e,t){return e.watchers&&(e.watchers.__wjs_suspend__||e.watchers["__wjs_suspend__"+t])},T=function(e,t){P(function(){delete e.watchers.__wjs_suspend__,delete e.watchers["__wjs_suspend__"+t]})},U=null,L=function(e,t,n,i,o){a[a.length]={obj:e,prop:t,mode:n,newval:i,oldval:o},null===U&&(U=setTimeout(N))},N=function(){var e=null;U=null;for(var t=0;t<a.length;t++)e=a[t],S(e.obj,e.prop,e.mode,e.newval,e.oldval);e&&(a=[],e=null)},F=function(){for(var e=0;e<n.length;e++){var t=n[e];if("$$watchlengthsubjectroot"===t.prop){var o=u(t.obj,t.actual);(o.added.length||o.removed.length)&&(o.added.length&&_(t.obj,o.added,t.watcher,t.level-1,!0),t.watcher.call(t.obj,"root","differentattr",o,t.actual)),t.actual=d(t.obj)}else{o=u(t.obj[t.prop],t.actual);if(o.added.length||o.removed.length){if(o.added.length)for(var a=0;a<t.obj.watchers[t.prop].length;a++)_(t.obj[t.prop],o.added,t.obj.watchers[t.prop][a],t.level-1,!0);S(t.obj,t.prop,"differentattr",o,t.actual)}t.actual=d(t.obj[t.prop])}}var r,s;if(i.length>0)for(e=0;e<i.length;e++)r=i[e],s=r.object[r.prop],z(r.orig,s)||(r.orig=d(s),r.callback(s))},z=function(e,t){var n,i=!0;if(e!==t)if(c(e)){for(n in e)if((r||"watchers"!==n)&&e[n]!==t[n]){i=!1;break}}else i=!1;return i},q=function(e,t,i,o){var a;a=d("$$watchlengthsubjectroot"===t?e:e[t]),n.push({obj:e,prop:t,actual:a,watcher:i,level:o})},B=function(e,t,i){for(var o=0;o<n.length;o++){var a=n[o];a.obj==e&&(t&&a.prop!=t||i&&a.watcher!=i||n.splice(o--,1))}},J=function(e,t){for(var n,o=0;o<i.length;o++){var a=i[o],r=a.object.watchers;n=a.object==e&&(!t||a.prop==t)&&r&&(!t||!r[t]||0==r[t].length),n&&i.splice(o--,1)}};return setInterval(F,50),t.watch=f,t.unwatch=w,t.callWatchers=S,t.suspend=R,t.onChange=j,t});var E=function(){function e(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},a={compressToBase64:function(e){if(null==e)return"";var t=a._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,function(i){return e(n,t.charAt(i))})},compressToUTF16:function(e){return null==e?"":a._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),i=0,o=t.length;o>i;i++){var r=t.charCodeAt(i);n[2*i]=r>>>8,n[2*i+1]=r%256}return n},decompressFromUint8Array:function(e){if(null===e||void 0===e)return a.decompress(e);for(var n=new Array(e.length/2),i=0,o=n.length;o>i;i++)n[i]=256*e[2*i]+e[2*i+1];var r=[];return n.forEach(function(e){r.push(t(e))}),a.decompress(r.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,function(e){return i.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,function(n){return e(i,t.charAt(n))}))},compress:function(e){return a._compress(e,16,function(e){return t(e)})},_compress:function(e,t,n){if(null==e)return"";var i,o,a,r={},s={},l="",c="",u="",d=2,p=3,m=2,h=[],f=0,g=0;for(a=0;a<e.length;a+=1)if(l=e.charAt(a),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=p++,s[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(r,c))u=c;else{if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,g==t-1?(g=0,h.push(n(f)),f=0):g++;for(o=u.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o=0;for(o=u.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}d--,0==d&&(d=Math.pow(2,m),m++),delete s[u]}else for(o=r[u],i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;d--,0==d&&(d=Math.pow(2,m),m++),r[c]=p++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,g==t-1?(g=0,h.push(n(f)),f=0):g++;for(o=u.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o=0;for(o=u.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}d--,0==d&&(d=Math.pow(2,m),m++),delete s[u]}else for(o=r[u],i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;d--,0==d&&(d=Math.pow(2,m),m++)}for(o=2,i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;for(;;){if(f<<=1,g==t-1){h.push(n(f));break}g++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(e,n,i){var o,a,r,s,l,c,u,d=[],p=4,m=4,h=3,f="",g=[],_={val:i(0),position:n,index:1};for(o=0;3>o;o+=1)d[o]=o;for(r=0,l=Math.pow(2,2),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;switch(r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;u=t(r);break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;u=t(r);break;case 2:return""}for(d[3]=u,a=u,g.push(u);;){if(_.index>e)return"";for(r=0,l=Math.pow(2,h),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;switch(u=r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;d[m++]=t(r),u=m-1,p--;break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*c,c<<=1;d[m++]=t(r),u=m-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,h),h++),d[u])f=d[u];else{if(u!==m)return null;f=a+a.charAt(0)}g.push(f),d[m++]=a+f.charAt(0),p--,a=f,0==p&&(p=Math.pow(2,h),h++)}}};return a}();"function"==typeof define&&n("913b")&&define(function(){return E}),function(){var e={};a.ui=e,e.init=function(e){e.dom.classList.add("joy-master"),e.container.addEventListener("wheel",function(t){var n=t.deltaY;return e.container.scrollTop+=n,!1})},e.Button=function(e){var t=this,n=document.createElement("div");n.className="joy-button",t.dom=n,e.label=e.label||"",t.label=document.createElement("span"),n.appendChild(t.label),t.setLabel=function(e){t.label.innerHTML=e},t.setLabel(e.label),n.onclick=function(){e.onclick()},t.styles=e.styles||[];for(var i=0;i<t.styles.length;i++)n.classList.add(t.styles[i])},e.ChooserButton=function(t){var n=this;n.value=t.value,n.options=t.options,n.onchange=t.onchange,n.value||(n.value=n.options[0].value),e.Button.call(n,{label:void 0===t.staticLabel?"":t.staticLabel,onclick:function(){a.modal.Chooser({source:n.dom,options:n.options,onchange:function(e){n.value=e,i(),n.onchange(e)},position:t.position})},styles:t.styles});var i=function(){if(void 0===t.staticLabel){var e=n.options.find(function(e){return e.value==n.value}).label;n.setLabel(e)}};i()},e.Scrubber=function(e){var t=this,n=e.min,i=e.max;t.value=e.value;var o=document.createElement("div");o.className="joy-scrubber",t.dom=o,t.setLabel=function(e){o.innerHTML=e.toFixed(t.sigfigs)};var a,r,s=function(n){n=parseFloat(n.toFixed(t.sigfigs)),e.onchange(n)},l=!1,c=!1,u=0,d=function(n){l=!0,a=n.clientX,r=t.value,u=0,e.onstart&&e.onstart()},_=function(e){if(l){c=!0;var n=Math.pow(.1,t.sigfigs);n=parseFloat(n.toPrecision(1));var i=e.clientX-a;a=e.clientX;var o=Math.abs(i/10);o<1&&(o=1),o>3&&(o=3),u+=i*o;var d=Math.floor(u/2),p=r+d*n;p=v(p),t.value!=p&&(t.value=p,t.setLabel(p),s(p))}},v=function(e){return void 0!==n&&e<n&&(e=n),void 0!==i&&e>i&&(e=i),e},w=function(){l=!1,e.onstop&&e.onstop(),setTimeout(function(){c=!1},1)};o.addEventListener("mousedown",d),window.addEventListener("mousemove",_),window.addEventListener("mouseup",w),t.kill=function(){o.removeEventListener("mousedown",d),window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",w)};var b=!1;o.onblur=function(){b&&(b=!1,o.contentEditable=!1,h(),k(o.innerText),t.value=y(),t.setLabel(t.value),s(t.value),e.onstop&&e.onstop())},p(o),g(o),o.onclick=function(){c||(b=!0,o.contentEditable=!0,o.spellcheck=!1,m(o),e.onstart&&e.onstart())},o.oninput=function(e){if(b){var t=/[^0-9.\-]/g;o.innerText.match(t)&&(o.innerText=o.innerText.replace(t,"")),f(o),s(y())}};var y=function(){var e=parseFloat(o.innerText);return isNaN(e)&&(e=0),e=v(e),e};t.sigfigs=0;var k=function(e){var n;e=e.toString();var i=e.search(/\./);n=i>=0?e.length-1-i:0,t.sigfigs=n};k(t.value),t.setLabel(t.value)},e.String=function(e){var t=this,n=document.createElement("div");n.className="joy-string",t.dom=n;var i=document.createElement("span");i.contentEditable=!0,i.spellcheck=!1;var o=document.createElement("span"),a=document.createElement("span");o.innerHTML=e.prefix||"",a.innerHTML=e.suffix||"",n.appendChild(o),n.appendChild(i),n.appendChild(a),i.oninput=function(t){f(i);var n=i.innerText;e.onchange(n)},i.onfocus=function(){m(i)},i.onblur=function(){h()},p(i),i.onkeypress=function(e){return 13!=e.which||(i.blur(),!1)},t.setString=function(e){i.innerText=e,f(i)},t.setColor=function(e){e=j(e),n.style.color=e,n.style.borderColor=e},e.color&&t.setColor(e.color),t.styles=e.styles||[];for(var r=0;r<t.styles.length;r++)n.classList.add(t.styles[r]);t.setString(e.value)},e.TextBox=function(e){var t,n=this;e.multiline?t=document.createElement("textarea"):(t=document.createElement("input"),t.type="text"),e.placeholder&&(t.placeholder=e.placeholder),t.spellcheck=!1,t.className="joy-textbox",n.dom=t;var i=n.dom;e.readonly?(t.setAttribute("readonly",1),t.addEventListener("click",function(){n.select()})):t.oninput=function(n){e.onchange(t.value)},e.width&&(t.style.width="number"===typeof e.width?e.width+"px":e.width),n.getValue=function(){return t.value},n.setValue=function(e){t.value=e},n.select=function(){t.select()},n.styles=e.styles||[];for(var o=0;o<n.styles.length;o++)i.classList.add(n.styles[o]);if(e.value&&n.setValue(e.value),e.multiline){var a=function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"};i.addEventListener("input",a,!1),setTimeout(function(){i.setAttribute("style","height:"+i.scrollHeight+"px; overflow-y:hidden;")},1)}}}(),function(){var e={};a.modal=e,e.init=function(t){e.dom=document.createElement("div"),e.dom.id="joy-modal",document.body.appendChild(e.dom),e.bg=document.createElement("div"),e.bg.id="joy-bg",e.bg.onclick=function(){e.currentUI.kill()},e.dom.appendChild(e.bg),e.box=document.createElement("div"),e.box.id="joy-box",e.box.className="arrow_box",e.dom.appendChild(e.box),e.dom.addEventListener("wheel",function(t){return"auto"==e.box.style.overflow||(t.preventDefault(),!1)})},e.show=function(t){e.dom.style.display="block",e.currentUI=t,e.box.appendChild(t.dom);var n=t.config.position||"below",i=e.box.getBoundingClientRect(),o=t.config.source.getBoundingClientRect(),a=e.bg.getBoundingClientRect(),r=20;if("below"==n){var s=o.top+o.height+r;s+i.height>document.body.clientHeight&&(n="left")}switch(e.box.setAttribute("position",n),n){case"below":var l=o.left+o.width/2;s=o.top+o.height+r;l-=i.width/2;break;case"left":l=o.left-r,s=o.top+o.height/2;l-=i.width,s-=i.height/2;break}l<0&&(l=1),s+i.height>a.height&&(s=a.height-i.height-1),e.box.style.left=l+"px",e.box.style.top=s+"px",e.currentUI.config.onopen&&e.currentUI.config.onopen()},e.hide=function(){w(e.box),e.dom.style.display="none",e.currentUI.config.onclose&&e.currentUI.config.onclose()},e.Chooser=function(t){var n={};n.config=t;var i=document.createElement("div");i.className="joy-modal-chooser",n.dom=i;var o=document.createElement("div");i.appendChild(o),n.options=[],n.categories={};var a="_placeholder_",r=function(e){var t=document.createElement("div");o.appendChild(t),n.categories[e]=t};n.populate=function(){for(var e=0;e<t.options.length;e++){var i=t.options[e],o=i.category;o?n.categories[o]||r(o):n.categories[a]||r(a)}for(e=0;e<t.options.length;e++){i=t.options[e];var s=document.createElement("div");s.innerHTML=i.label,i.color&&(s.style.color=i.color);o=i.category||a;n.categories[o].appendChild(s),function(e){s.onclick=function(t){n.onchange(e.value),t.stopPropagation()}}(i)}},n.populate(),n.onchange=function(e){n.kill(),t.onchange(e)},n.kill=function(){e.hide()},e.show(n)},e.Color=function(t){var n={};n.config=t;var i=document.createElement("div");i.className="joy-modal-color",n.dom=i,t.value=t.value||[0,1,1],n.h=t.value[0],n.s=t.value[1],n.v=t.value[2];var o=150,a=15,r=10,s=10,l=10,c=r+o+s+a+l,u=r+o+l;n.dom.style.width=c+"px",n.dom.style.height=u+"px";var d=document.createElement("canvas");d.id="joy-color-wheel";var p=d.getContext("2d");d.width=2*o,d.height=2*o,d.style.width=d.width/2+"px",d.style.height=d.height/2+"px",i.appendChild(d),d.style.top=r+"px",d.style.left=r+"px";var m=function(){var e=p;e.clearRect(0,0,e.canvas.width,e.canvas.height);for(var t=d.width,i=d.height,o=e.createImageData(t,i),a=o.data,r=t/2,s=i/2,l=t/2,c=l+2,u=0;u<t;u++)for(var m=0;m<i;m++){var h=u-r,f=m-s,g=Math.sqrt(h*h+f*f);if(g<c){g>=l&&(g=l);var _=Math.atan2(f,h);_=360*(_/Math.TAU+.5),g/=l;var v=_,w=g,b=n.v,k=y(v,w,b),C=4*(u+m*t);a[C]=k[0],a[C+1]=k[1],a[C+2]=k[2],a[C+3]=255}}e.putImageData(o,0,0),e.save(),e.globalCompositeOperation="destination-in",e.beginPath(),e.fillStyle="#fff",e.arc(r,s,l,0,Math.TAU),e.fill(),e.restore()};m();var h=document.createElement("canvas");h.id="joy-color-value";var f=h.getContext("2d");h.width=2*a,h.height=2*o,h.style.width=h.width/2+"px",h.style.height=h.height/2+"px",i.appendChild(h),h.style.top=r+"px",h.style.right=l+"px";var g=function(){var e=f;e.clearRect(0,0,e.canvas.width,e.canvas.height);for(var t=h.width,i=h.height,o=e.createImageData(t,i),a=o.data,r=0;r<t;r++)for(var s=0;s<i;s++){var l=n.h,c=n.s,u=1-s/i,d=y(l,c,u),p=4*(r+s*t);a[p]=d[0],a[p+1]=d[1],a[p+2]=d[2],a[p+3]=255}e.putImageData(o,0,0)};g();var _=document.createElement("canvas");_.id="joy-color-picker";var v=_.getContext("2d");_.width=2*c,_.height=2*u,_.style.width=_.width/2+"px",_.style.height=_.height/2+"px",i.appendChild(_);var w,b=function(){var e,t,i=v;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.fillStyle=k(n.h,n.s,n.v),i.strokeStyle="#fff",i.lineWidth=2;var o=2*r+d.width/2,l=2*r+d.height/2,c=n.h*(Math.TAU/360),u=n.s*(d.width/2);e=o-Math.cos(c)*u,t=l-Math.sin(c)*u,i.beginPath(),i.arc(e,t,a,0,Math.TAU),i.fill(),i.stroke();var p=2*r+d.width+2*s+h.width/2,m=2*r;e=p,t=m+h.height*(1-n.v),i.beginPath(),i.arc(e,t,a,0,Math.TAU),i.fill(),i.stroke()};b();var C=!1,x=function(e){if(e.target==_){var t=2*e.offsetX,n=2*e.offsetY;"hs"==w?(t-=2*r,n-=2*r,P(t,n)):(t-=2*r+d.width+2*s,n-=2*r,j(t,n)),S()}},P=function(e,t){var i=d.width/2,o=e-i,a=t-i,r=Math.atan2(a,o),s=Math.sqrt(o*o+a*a);r=360*(r/Math.TAU+.5),r<0&&(r=0),r>360&&(r=360),s/=i,s<0&&(s=0),s>1&&(s=1),n.h=r,n.s=s,g(),b()},j=function(e,t){n.v=1-t/h.height,n.v<0&&(n.v=0),n.v>1&&(n.v=1),m(),b()},E=function(e){C=!0,w=2*e.offsetX<2*r+d.width+s?"hs":"v",x(e)},O=function(e){C&&x(e)},D=function(){C=!1};_.addEventListener("mousedown",E),window.addEventListener("mousemove",O),window.addEventListener("mouseup",D);var S=function(){var e=[n.h,n.s,n.v];e[0]=parseFloat(e[0].toFixed(0)),e[1]=parseFloat(e[1].toFixed(2)),e[2]=parseFloat(e[2].toFixed(2)),t.onchange(e)};n.kill=function(){i.removeEventListener("mousedown",E),window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",D),e.hide()},e.show(n)}}(),a.add({type:"number",tags:["ui"],initWidget:function(e){var t=e.options,n=new a.ui.Scrubber({min:t.min,max:t.max,step:t.step,value:e.getData("value"),onstart:function(){e.top.activePreview=e},onstop:function(){e.top.activePreview=null},onchange:function(t){e.setData("value",t)}});e.dom=n.dom;var i=null,o=30;e.dom.onmouseenter=function(){if(e.top.canPreview("numbers")){e.previewData=r(e.data);var t=Math.abs(.05*e.data.value);0==t&&(t=1);var n=0;i=setInterval(function(){if(!e.top.canPreview("numbers"))return s();n+=Math.TAU/o/.25,e.previewData.value=e.data.value+Math.sin(n)*t,e.update(),n>Math.TAU&&s()},1e3/o)}};var s=function(){i&&clearInterval(i),e.previewData=null};e.dom.onmouseleave=s},onget:function(e){return e.data.value},placeholder:{value:3}}),a.add({type:"button",tags:["ui"],initWidget:function(e){var t=document.createElement("div");t.className="joy-save",e.dom=t,e.saveButton=new a.ui.Button({label:e.options.label||"--",onclick:function(){e.update()}}),t.appendChild(e.saveButton.dom)}}),a.add({type:"color",tags:["ui"],initWidget:function(e){var t=new a.ui.Button({label:"&nbsp;",onclick:function(){a.modal.Color({source:e.dom,value:e.getData("value"),onchange:function(t){e.setData("value",t),n()},onopen:function(){e.top.activePreview=e},onclose:function(){e.top.activePreview=null}})},styles:["joy-color"]});e.dom=t.dom;var n=function(){var n=e.getData("value");t.dom.style.background=k(n)};n();var i,o,s=null,l=30;e.dom.onmouseenter=function(){e.top.canPreview("numbers")&&(e.data.value[2],e.previewData=r(e.data),o=0,i=2/l*2,s=setInterval(function(){if(!e.top.canPreview("numbers"))return c();var t=e.previewData.value;t[2]+=i,t[2]>1&&(t[2]=1,i*=-1),t[2]<0&&(t[2]=0,i*=-1),e.update(),o+=2/l,o>=1&&c()},1e3/l))};var c=function(){s&&clearInterval(s),e.previewData=null,e.update()};e.dom.onmouseleave=c},onget:function(e){return k(e.data.value)},placeholder:function(){var e=Math.floor(360*Math.random());return[e,.8,1]}}),a.add({type:"choose",tags:["ui"],initWidget:function(e){for(var t=e.data,n=e.options,i=0;i<n.length;i++){var o=n[i];void 0!==o.label&&void 0!==o.value||(n[i]={label:o.toString(),value:o})}var r=new a.ui.ChooserButton({value:t.value,options:n,onchange:function(n){t.value=n,e.update()},styles:e.styles});e.dom=r.dom},onget:function(e){return e.data.value}}),a.add({type:"string",tags:["ui"],initWidget:function(e){var t=e.options;e.stringUI=new a.ui.String({prefix:t.prefix,suffix:t.suffix,color:t.color,value:e.getData("value"),onchange:function(t){e.setData("value",t)}}),e.dom=e.stringUI.dom,e.onDataChange=function(){var t=e.getData("value");e.stringUI.setString(t)}},onget:function(e){return e.data.value},placeholder:"???"}),a.add({type:"save",tags:["ui"],initWidget:function(e){var t=document.createElement("div");t.className="joy-save",e.dom=t,e.saveButton=new a.ui.Button({label:"save",onclick:function(){var t=a.saveToURL(e.top.data);e.url.setValue(t),e.url.select();t.length;e.info.innerHTML="P.S: you can shorten your link with <a href='http://tinyurl.com/' target='_blank'>TinyURL</a>!"}}),t.appendChild(e.saveButton.dom),e.url=new a.ui.TextBox({readonly:!0}),t.appendChild(e.url.dom),e.info=document.createElement("div"),e.info.id="joy-save-info",t.appendChild(e.info)}}),a.add({type:"ops",tags:["ui"],init:function(e){void 0!==e.resetVariables&&(e.data.resetVariables=e.resetVariables)},initWidget:function(e){var t=e.data,n=t.ops,i=document.createElement("div");i.className="joy-ops",e.dom=i;var o=document.createElement("list");o.id="joy-list",i.appendChild(o);var s=[{label:"Add op above",value:"op_above"},{label:"Add op below",value:"op_below"},{label:"Delete",value:"delete"}],d=function(t,i){var r=0;if("op_above"==i&&(r=-1),"op_below"==i&&(r=1),0!=r){var s=e.entries.indexOf(t);r>0&&(s+=1),a.modal.Chooser({position:"below",source:t.bullet.dom,options:v,onchange:function(t){_(t,s),e.update(),h()}})}"delete"==i&&(l(e.entries,t),l(n,t.opData),e.removeChild(t.op),o.removeChild(t.dom),e.update(),h())},p=function(e){var t=new a.ui.ChooserButton({position:"below",staticLabel:m(e),options:s,onchange:function(t){d(e,t)},styles:["joy-bullet"]});return t.dom.id="joy-bullet",t},m=function(t){var n,i=e.entries.indexOf(t)+1,o=0,a=e.parent;while(a)"ops"==a.type&&o++,a=a.parent;switch(o%3){case 0:n=i;break;case 1:n=u(i);break;case 2:n=c(i);break}return n},h=function(){for(var t=0;t<e.entries.length;t++){var n=e.entries[t],i=n.bullet,o=m(n);i.setLabel(o)}};e.entries=[];for(var f=function(t,n){var a={},s=document.createElement("div");void 0===n&&(n=e.entries.length),e.entries.splice(n,0,a),o.insertBefore(s,o.children[n]);var l=p(a),c=document.createElement("div");c.id="joy-bullet-container",s.appendChild(c),c.appendChild(l.dom);var u=e.addChild({type:t.type},t),d=u.createWidget();d.id="joy-widget",s.appendChild(d),a.dom=s,a.bullet=l,a.op=u,a.widget=d,a.opData=t;var m,h,f=function(t){var n=t.offsetY/l.dom.getBoundingClientRect().height;n<0&&(n=0),n>1&&(n=1),m._PREVIEW=n,e.update()};return c.onmouseenter=function(t){if(e.top.canPreview("ops")){e.top.activePreview=e,e.previewData=r(e.data);var n=e.entries.indexOf(a);m=e.previewData.ops[n],e.previewData.ops.splice(n+1,0,{STOP:!0}),f(t),h=document.createElement("style"),document.head.appendChild(h),h.sheet.insertRule(".joy-ops.joy-previewing > #joy-list > div:nth-child(n+"+(n+2)+") { opacity:0.1; }"),h.sheet.insertRule(".joy-ops.joy-previewing > div.joy-bullet { opacity:0.1; }"),i.classList.add("joy-previewing")}},c.onmousemove=function(t){e.previewData&&f(t)},c.onmouseleave=function(){e.previewData&&(e.previewData=null,e.top.activePreview=null,e.update(),document.head.removeChild(h),i.classList.remove("joy-previewing"))},a},g=0;g<n.length;g++)f(n[g]);var _=function(e,t){var i={type:e};void 0===t?n.push(i):n.splice(t,0,i);f(i,t)},v=[];if(e.onlyOps)for(g=0;g<e.onlyOps.length;g++){var w=e.onlyOps[g],b=a.getTemplateByType(w),y=b.tags.filter(function(e){return"op"!=e})[0];v.push({label:b.name,value:w,category:y})}else{var k=a.getTemplatesByTag("op");for(g=0;g<k.length;g++){var C=k[g];y=C.tags.filter(function(e){return"op"!=e})[0];v.push({label:C.name,value:C.type,category:y})}}var x=new a.ui.ChooserButton({staticLabel:"+",options:v,onchange:function(t){_(t),e.update()},styles:["joy-bullet"]});i.appendChild(x.dom)},onexecute:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.target._variables||(t.target._variables={}),t.data.resetVariables&&(t.target._variables={}),n=0;case 3:if(!(n<t.data.ops.length)){e.next=30;break}if(i=t.data.ops[n],!i.STOP){e.next=7;break}return e.abrupt("return","STOP");case 7:return o=t.op.entries[n].op,e.next=10,o.execute(t.target,i);case 10:if(a=e.sent,!a||!a.target){e.next=15;break}t.target=a.target,e.next=27;break;case 15:if(!a||!a.error){e.next=20;break}return console.error("ops stopped with error: ",a),e.abrupt("return",a);case 20:if(!a||!a.stop){e.next=25;break}return console.log("ops interrupted at step ",n,a),e.abrupt("return",a);case 25:if("STOP"!=a){e.next=27;break}return e.abrupt("return",a);case 27:n++,e.next=3;break;case 30:return e.abrupt("return",t);case 31:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),placeholder:{ops:[],resetVariables:!0}}),a.module("instructions",function(){a.add({name:"Repeat the following...",type:"instructions/repeat",tags:["instructions","op"],init:"Repeat the following {id:'count', type:'number', min:1, placeholder:3} times: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=1,void 0!==t.data._PREVIEW&&(n=t.data._PREVIEW),i=Math.floor(t.data.count*n),o=0;case 4:if(!(o<i)){e.next=27;break}return e.next=7,t.op.ops.execute(t.target);case 7:if(a=e.sent,!a||!a.target){e.next=12;break}t.target=a.target,e.next=24;break;case 12:if(!a.error){e.next=17;break}return console.error("op stopped with error: ",a),e.abrupt("return",a);case 17:if(!a.stop){e.next=22;break}return console.log("op interrupted at step ",o,a),e.abrupt("return",a);case 22:if("STOP"!=a){e.next=24;break}return e.abrupt("return",a);case 24:o++,e.next=4;break;case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}),a.add({name:"// Write a note",type:"instructions/comment",tags:["instructions","op"],initWidget:function(e){e.dom=document.createElement("div"),e.box=new a.ui.TextBox({multiline:!0,placeholder:"// your notes here",value:e.getData("value"),onchange:function(t){e.setData("value",t)},styles:["box"]}),e.dom.appendChild(e.box.dom)}})}),a.add({type:"variableName",tags:["ui"],init:function(e){var t=e.variableType,n=function(){var n=a.getReferencesByTag(e,t).map(function(e){return e.data.value}),i=0;return n.forEach(function(e){var t;"variable"==e&&(t=1);var n=e.match(/variable\s(\d+)/);n&&(t=parseInt(n[1])),i<t&&(i=t)}),0==i?"variable":"variable "+(i+1)};e._createNewReference=function(){var i={value:n(),color:P()},o=a.createReference(e,t,i);e.setData("refID",o.id,!0),a.connectReference(e,o.id)};var i=e.getData("refID");if(i)a.connectReference(e,i);else{var o=a.getReferencesByTag(e,t);if(e.startWithExisting&&o.length>0){var r=o[o.length-1];i=r.id,e.setData("refID",i,!0),a.connectReference(e,i)}else e._createNewReference()}e._switchReference=function(t){var n=e.getData("refID");a.disconnectReference(e,n),e.setData("refID",t),a.connectReference(e,t)}},initWidget:function(e){e.dom=document.createElement("span");var t=e.getData("refID"),n=a.getReferenceById(e,t).data,i=e.addChild({type:"string",prefix:"[",suffix:"]",color:n.color},n),o=i.createWidget();e.dom.appendChild(o);var r=i.onDataChange;i.onDataChange=function(){r();var e=i.getData("color");i.stringUI.setColor(e)};var s=e.variableType,l=function(){var t=[],n=a.getReferencesByTag(e,s),o=e.getData("refID");n.forEach(function(e){if(e.id!=o){var n=e.data.color;n=k(n[0],n[1],n[2]),t.push({label:"["+e.data.value+"]",value:e.id,color:n})}}),t.push({category:"meta",label:"(+new)",value:"NEW"}),t.push({category:"meta",label:"(change color)",value:"CHANGE_COLOR"}),a.modal.Chooser({source:e.dom,options:t,onchange:function(t){if("CHANGE_COLOR"==t)a.modal.Color({source:e.dom,value:i.getData("color"),onchange:function(e){i.setData("color",e),i.stringUI.setColor(e)}});else{if("NEW"==t){var n=e.getData("refID");a.disconnectReference(e,n),e._createNewReference(),e.update()}else e._switchReference(t);var o=e.getData("refID"),r=a.getReferenceById(e,o);i.switchData(r.data)}}})};e.noChooser||(e.dom.onclick=l)},onget:function(e){var t=e.data.refID,n=a.getReferenceById(e.op,t);return n.data.value},onkill:function(e){var t=e.getData("refID");a.disconnectReference(e,t)}}),a.module("math",function(){a.modify("number","number_raw",function(e){return{init:function(e){if(!e.noVariables){var t=e.getData("value");"number"===typeof t&&(e.setData("value",void 0,!0),e.setData("chain",[{type:"number_raw",min:e.min,max:e.max,step:e.step,value:t}],!0)),e._makeNewChainOp=function(t,n){var i,o=t.type;switch(o){case"number_raw":i=e.addChild({type:o,min:t.min,max:t.max,step:t.step},t);break;case"variableName":i=e.addChild({type:o,variableType:"number",noChooser:!0},t);break;case"choose":i=e.addChild({type:o,options:[{label:"+",value:"+"},{label:"-",value:"-"},{label:"&times;",value:"*"},{label:"&divide;",value:"/"}],styles:["joy-math"]},t);break}var a=e.getData("chain");return void 0!==n?(e.chainOps.splice(n,0,i),a.splice(n,0,t)):(e.chainOps.push(i),a.push(t)),i},e.chainOps=[];var n=e.getData("chain"),i=r(n);n.splice(0,n.length);for(var o=0;o<i.length;o++)e._makeNewChainOp(i[o]);e._replaceChainOp=function(t,n){var i=e._deleteChainOp(t),o=e._makeNewChainOp(n,i);return e.update(),o},e._deleteChainOp=function(t){var n=e.chainOps.indexOf(t);l(e.chainOps,t),e.removeChild(t);var i=e.getData("chain");return i.splice(n,1),n}}},initWidget:function(t){if(t.noVariables)e.initWidget(t);else{t.dom=document.createElement("span"),t.dom.className="joy-number";var n=function(e){var n=[];if("number_raw"!=e.type){var i=t.placeholder.value;"number"===typeof i&&n.push({label:i,value:{type:"number_raw",value:i}})}var o,r=a.getReferencesByTag(t,"number");"variableName"==e.type&&(o=e.getData("refID")),r.forEach(function(e){if(e.id!=o){var t=e.data.color;t=k(t[0],t[1],t[2]),n.push({label:"["+e.data.value+"]",value:{type:"variableName",refID:e.id},color:t})}}),n.length>0&&a.modal.Chooser({source:e.dom,options:n,onchange:function(n){var i=t._replaceChainOp(e,n);t._replaceChainEntry(e,i)}})};t._chainEntries=[],t._makeChainEntry=function(e,o){var r=document.createElement("span");if(e.createWidget(),r.appendChild(e.dom),"choose"!=e.type){var s,l=new a.ui.Button({onclick:function(){i(s)},styles:["joy-more"]});r.appendChild(l.dom)}if(void 0!==o)if(o<t.dom.childNodes.length){var c=t.dom.childNodes[o];t.dom.insertBefore(r,c)}else t.dom.appendChild(r);else t.dom.appendChild(r);"choose"!=e.type&&function(e){var t;e.dom.addEventListener("mousedown",function(){t=+new Date}),e.dom.addEventListener("mouseup",function(){var i=+new Date;i-t<500&&n(e)})}(e),s={widget:r,op:e},void 0!==o?t._chainEntries.splice(o,0,s):t._chainEntries.push(s)},t._deleteChainEntry=function(e){var n=t._chainEntries.find(function(t){return t.op==e}),i=t._chainEntries.indexOf(n),o=n.widget;return t.dom.removeChild(o),l(t._chainEntries,n),i},t._replaceChainEntry=function(e,n){var i=t._deleteChainEntry(e);t._makeChainEntry(n,i)};for(var i=function(e){var n=e.widget.innerText,i=[{label:n+" + 2",value:"+"},{label:n+" - 2",value:"-"},{label:n+" &times; 2",value:"*"},{label:n+" &divide; 2",value:"/"}],o=t._chainEntries.indexOf(e);if(t._chainEntries.length>1){var r,s;r=0==o?o+1:o-1;var l=t._chainEntries[r].widget.innerText;s=0==o?n+" "+l:l+" "+n;var c=[o,r].sort();i.push({category:"meta",label:"(delete â€œ"+s+"â€)",value:c})}a.modal.Chooser({source:e.widget,options:i,onchange:function(n){if("string"===typeof n){var i=t._chainEntries.indexOf(e);i++;var o=t._makeNewChainOp({type:"choose",value:n},i);t._makeChainEntry(o,i),i++;var a=t._makeNewChainOp({type:"number_raw",value:2},i);t._makeChainEntry(a,i)}else for(var r=n,s=r.length-1;s>=0;s--){var l=r[s],c=t._chainEntries[l].op;t._deleteChainOp(c),t._deleteChainEntry(c)}t.update()}})},o=0;o<t.chainOps.length;o++){var r=t.chainOps[o];t._makeChainEntry(r)}}},onget:function(t){if(t.op.noVariables)return e.onget(t);for(var n=[],i=0;i<t.data.chain.length;i+=2){var o,a=t.op.chainOps[i];switch(a.type){case"number_raw":o=a.get(t.target);break;case"variableName":var r=t.target._variables,s=a.get(t.target);o=r[s];break}if(i>0){var l=t.op.chainOps[i-1],c=l.get();n.push(c)}n.push(o)}for(i=1;i<n.length;i+=2){c=n[i];if("*"==c||"/"==c){var u=n[i-1],d=n[i+1];p="*"==c?u*d:u/d,n.splice(i-1,3,p),i-=2}}for(i=1;i<n.length;i+=2){c=n[i];if("+"==c||"-"==c){var p;u=n[i-1],d=n[i+1];p="+"==c?u+d:u-d,n.splice(i-1,3,p),i-=2}}return n[0]}}}),a.add({name:"Set [number]",type:"math/set",tags:["math","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to {id:'value', type:'number'}",onexecute:function(e){var t=e.target._variables,n=e.data.varname;t[n]=e.data.value}}),a.add({name:"Do math to [number]",type:"math/operation",tags:["math","op"],init:JSON.stringify({id:"operation",type:"choose",placeholder:"+",options:[{label:"+ Increase",value:"+"},{label:"- Decrease",value:"-"},{label:"&times; Multiply",value:"*"},{label:"&divide; Divide",value:"/"}]})+" {id:'varname', type:'variableName', variableType:'number', startWithExisting:true} by {id:'value', type:'number'}",onexecute:function(e){var t=e.target._variables,n=e.data.varname;switch(void 0===t[n]&&(t[n]=0),e.data.operation){case"+":t[n]+=e.data.value;break;case"-":t[n]-=e.data.value;break;case"*":t[n]*=e.data.value;break;case"/":t[n]/=e.data.value;break}}}),a.add({name:"If [math] then...",type:"math/if",tags:["math","op"],init:"If {id:'value1', type:'number'} {id:'test', type:'choose', options:['<','â‰¤','=','â‰¥','>'], placeholder:'='} {id:'value2', type:'number'}, then: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(e){var t,n=e.data.value1,i=e.data.value2;switch(e.data.test){case"<":t=n<i;break;case"â‰¤":t=n<=i;break;case"=":t=n==i;break;case"â‰¥":t=n>=i;break;case">":t=n>i;break}if(t){var o=e.op.ops.execute(e.target);if("STOP"==o)return o}}})}),a.module("random",function(){a.add({name:"With a X% chance...",type:"random/if",tags:["random","op"],init:"With a {id:'chance', type:'number', min:0, max:100, placeholder:50}% chance, do:{id:'ops', type:'ops', resetVariables:false}",onexecute:function(e){var t=e.data.chance/100;if(Math.random()<t){var n=e.op.ops.execute(e.target);if("STOP"==n)return n}}}),a.add({name:"Set random [number]",type:"random/set",tags:["random","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to a random {id:'numtype', type:'choose', options:['number','integer'], placeholder:'number'} between {id:'min', type:'number', placeholder:1} and {id:'max', type:'number', placeholder:100}",onexecute:function(e){var t,n=e.target._variables,i=e.data.varname,o=e.data.min,a=e.data.max,r=Math.min(o,a),s=Math.max(o,a);t="integer"==e.data.numtype?r+Math.floor(Math.random()*(s-r+1)):r+Math.random()*(s-r),n[i]=t}})})}).call(this,n("faff")(e))},"68c9":function(e,t,n){"use strict";var i=n("a356"),o=n.n(i);o.a},"74fa":function(e,t,n){},7544:function(e,t,n){"use strict";var i=n("9e8a"),o=n.n(i);o.a},"9c4c":function(e,t,n){"use strict";var i=n("e0de"),o=n.n(i);o.a},"9e8a":function(e,t,n){},a356:function(e,t,n){},a44c:function(e,t,n){},ac54:function(e,t,n){},c21b:function(e,t,n){},c3b4:function(e,t,n){"use strict";var i=n("5337"),o=n.n(i);o.a},c4a1:function(e,t,n){"use strict";var i=n("a44c"),o=n.n(i);o.a},d9a4:function(e,t,n){"use strict";var i=n("74fa"),o=n.n(i);o.a},db43:function(e,t,n){"use strict";var i=n("0e4f"),o=n.n(i);o.a},e0de:function(e,t,n){},ea64:function(e,t,n){},f13e:function(e,t,n){}});
//# sourceMappingURL=app.af764b6b.js.map