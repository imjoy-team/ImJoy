(function(e){function t(t){for(var i,r,s=t[0],c=t[1],l=t[2],u=0,p=[];u<s.length;u++)r=s[u],o[r]&&p.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={app:0},a=[];function r(e){return s.p+"static/js/"+({}[e]||e)+"."+{"chunk-2d0a3577":"39e7cf1b","chunk-2d0a43df":"81e6a713","chunk-2d0aab07":"b055a499","chunk-2d0abc00":"cb0aafd7","chunk-2d0ae937":"b5ac7e9f","chunk-2d0aeb45":"6c55cdde","chunk-2d0afa49":"4894f92d","chunk-2d0b2762":"9af74a19","chunk-2d0b6187":"681dc82a","chunk-2d0ba136":"bb43d210","chunk-2d0bb267":"e87b0db0","chunk-2d0bcec1":"2799d39d","chunk-2d0bff92":"a8b9d356","chunk-2d0c0494":"f85e217b","chunk-2d0c0a09":"a50b58da","chunk-2d0c1ed0":"23f7793b","chunk-2d0c4313":"fe63514b","chunk-2d0c46d1":"61fe10c9","chunk-2d0c512b":"861fc668","chunk-2d0cf16e":"fad94e68","chunk-2d0d056d":"b667c308","chunk-2d0d0645":"cada8c0b","chunk-2d0d2f22":"5cda576f","chunk-2d0d7e63":"01b36cec","chunk-2d0e1b57":"12f516f1","chunk-2d0e1fbe":"2f62965a","chunk-2d0e22d6":"ee52eea6","chunk-2d0e542a":"68be02c0","chunk-2d0e57ec":"fb4dbaaf","chunk-2d0e6553":"e47b8990","chunk-2d0ea098":"924c4eb3","chunk-2d208ac5":"c50d440f","chunk-2d209408":"f654347d","chunk-2d20f745":"4643df8b","chunk-2d20ff23":"57affc2b","chunk-2d2138c7":"b7fee596","chunk-2d217e5b":"eb2020a3","chunk-2d21dcd2":"cf0527cc","chunk-2d21f327":"61a362e2","chunk-2d2214b3":"61e57417","chunk-2d221a34":"91fff247","chunk-2d22502a":"0e24c19f","chunk-2d228ca6":"ea695b58","chunk-2d2295e9":"06490feb","chunk-2d22c171":"e9445ab1","chunk-2d22c2b8":"37e07cf8","chunk-2d22ca58":"1fbf4622","chunk-2d2311f7":"307761dc","chunk-2d2371be":"ce9111c5","chunk-2d237ee7":"3bd7755d","chunk-2d238465":"63305ded","chunk-7532b3ea":"a401d26a","chunk-77155129":"577f85eb"}[e]+".js"}function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise(function(t,i){n=o[e]=[t,i]});t.push(n[2]=i);var a,c=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=r(e),a=function(t){l.onerror=l.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+i+": "+a+")");r.type=i,r.request=a,n[1](r)}o[e]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:l})},12e4);l.onerror=l.onload=a,c.appendChild(l)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"025e":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Whenable}),__webpack_require__.d(__webpack_exports__,"c",function(){return assert}),__webpack_require__.d(__webpack_exports__,"d",function(){return compareVersions}),__webpack_require__.d(__webpack_exports__,"k",function(){return pathJoin}),__webpack_require__.d(__webpack_exports__,"j",function(){return mobileAndTabletcheck}),__webpack_require__.d(__webpack_exports__,"m",function(){return url_regex}),__webpack_require__.d(__webpack_exports__,"e",function(){return debounce}),__webpack_require__.d(__webpack_exports__,"l",function(){return randId}),__webpack_require__.d(__webpack_exports__,"f",function(){return escapeHTML}),__webpack_require__.d(__webpack_exports__,"b",function(){return _clone}),__webpack_require__.d(__webpack_exports__,"i",function(){return githubUrlRaw}),__webpack_require__.d(__webpack_exports__,"g",function(){return githubImJoyManifest}),__webpack_require__.d(__webpack_exports__,"h",function(){return githubRepo});var core_js_modules_es6_string_ends_with__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("aef6"),core_js_modules_es6_string_ends_with__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_string_ends_with__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es7_object_values__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("8615"),core_js_modules_es7_object_values__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es7_object_values__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4__),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("96cf"),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_5__),_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("1da1"),_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("3835"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("c5f6"),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("3b2b"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_13__),_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("53ca"),axios__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_15__),Whenable=function(){this._emitted=!1,this._handlers=[]};function assert(e,t){if(!e){if(t=t||"Assertion failed","undefined"!==typeof Error)throw new Error(t);throw t}}function isTouchDevice(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}function compareVersions(v1,comparator,v2){if(comparator="="==comparator?"==":comparator,-1==["==","===","<","<=",">",">=","!=","!=="].indexOf(comparator))throw new Error("Invalid comparator. "+comparator);for(var v1parts=v1.split("."),v2parts=v2.split("."),maxLen=Math.max(v1parts.length,v2parts.length),part1,part2,cmp=0,i=0;i<maxLen&&!cmp;i++)part1=parseInt(v1parts[i],10)||0,part2=parseInt(v2parts[i],10)||0,part1<part2&&(cmp=1),part1>part2&&(cmp=-1);return eval("0"+comparator+cmp)}function pathJoin(){for(var e=[],t=0,n=arguments.length;t<n;t++)e=e.concat(arguments[t].split("/"));var i=[];for(t=0,n=e.length;t<n;t++){var o=e[t];o&&"."!==o&&(".."===o?i.pop():i.push(o))}return""===e[0]&&i.unshift(""),i.join("/")||(i.length?"/":".")}function dirName(e){return pathJoin(e,"..")}function mobilecheck(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function mobileAndTabletcheck(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}Whenable.prototype.emit=function(e){if(!this._emitted){var t;this._emitted=!0,this._e=e;while(t=this._handlers.pop())setTimeout(t.bind(null,e),0)}},Whenable.prototype.whenEmitted=function(e){e=this._checkHandler(e),this._emitted?setTimeout(e.bind(null,this._e),0):this._handlers.push(e)},Whenable.prototype._checkHandler=function(e){var t=Object(_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_14__["a"])(e);if("function"!=t){var n="A function may only be subsribed to the event, "+t+" was provided instead";throw new Error(n)}return e};var arrAnimals=["Aardvark","Albatross","Alligator","Alpaca","Ant","Anteater","Antelope","Ape","Armadillo","Ass_Donkey","Baboon","Badger","Barracuda","Bat","Bear","Beaver","Bee","Bison","Boa","Buffalo","Butterfly","Camel","Capybara","Caribou","Cassowary","Cat","Caterpillar","Cattle","Chamois","Cheetah","Chicken","Chimpanzee","Chinchilla","Chough","Clam","Cobra","Cockroach","Cod","Cormorant","Coyote","Crab","Crane","Crocodile","Crow","Curlew","Deer","Dinosaur","Dog","Dogfish","Dolphin","Donkey","Dotterel","Dove","Dragonfly","Duck","Dugong","Dunlin","Eagle","Echidna","Eel","Eland","Elephant","Elephantseal","Elk","Emu","Falcon","Ferret","Finch","Fish","Flamingo","Fox","Frog","Gaur","Gazelle","Gerbil","GiantPanda","Giraffe","Gnat","Gnu","Goat","Goose","Goldfinch","Goldfish","Gorilla","Goshawk","Grasshopper","Grouse","Guanaco","Guineafowl","Guineapig","Gull","Hamster","Hare","Hawk","Hedgehog","Heron","Herring","Hippopotamus","Hornet","Horse","Human","Hummingbird","Hyena","Ibex","Ibis","Jackal","Jaguar","Jay","Jellyfish","Kangaroo","Kingfisher","Koala","Komodo","Kookabura","Kouprey","Kudu","Lapwing","Lark","Lemur","Leopard","Lion","Llama","Lobster","Locust","Loris","Louse","Lyrebird","Magpie","Mallard","Manatee","Mandrill","Mantis","Marten","Meerkat","Mink","Mole","Mongoose","Monkey","Moose","Mouse","Mosquito","Mule","Narwhal","Newt","Nightingale","Octopus","Okapi","Opossum","Oryx","Ostrich","Otter","Owl","Ox","Oyster","Panther","Parrot","Partridge","Peafowl","Pelican","Penguin","Pheasant","Pig","Pigeon","PolarBear","Pony","Porcupine","Porpoise","PrairieDog","Quail","Quelea","Quetzal","Rabbit","Raccoon","Rail","Ram","Rat","Raven","Reddeer","Redpanda","Reindeer","Rhinoceros","Rook","Salamander","Salmon","SandDollar","Sandpiper","Sardine","Scorpion","Sealion","SeaUrchin","Seahorse","Seal","Shark","Sheep","Shrew","Skunk","Snail","Snake","Sparrow","Spider","Spoonbill","Squid","Squirrel","Starling","Stingray","Stinkbug","Stork","Swallow","Swan","Tapir","Tarsier","Termite","Tiger","Toad","Trout","Turkey","Turtle","Vicuï¿½a","Viper","Vulture","Wallaby","Walrus","Wasp","Waterbuffalo","Weasel","Whale","Wolf","Wolverine","Wombat","Woodcock","Woodpecker","Worm","Wren","Yak","Zebra"],arrColours=["almond","amaranthine","amber","amethyst","antique","apple","apricot","aqua","aquamarine","argent","auburn","avocado","azure","babyblue","banana","battleshipgray","bay","beige","Bermudagreen","beryl","biceblue","bicegreen","bice","biscuit","bisque","black","blanchedalmond","blazeorange","blonde","bloodred","bluegreen","blueviolet","blue","blueberry","bone","bottlegreen","brass","brickred","bronzeyellow","bronze","brown","buckskin","buff","burgundy","burlywood","burntorange","burntsienna","burntumber","butterscotch","cadetblue","Cambridgeblue","canary","cardinal","carmine","carnation","carnelian","carroty","celadon","cerise","cerulean","chamois","champagne","charcoal","chartreuse","cherryred","chestnut","Chinesered","chocolate","cinereous","cinnabar","cinnamon","citrine","clairdelune","claret","coalblack","cobaltblue","cocoa","coffee","coolgray","Copenhagenblue","copper","coral","cornflowerblue","cornflower","cornsilk","cream","crimson","cupreous","cyan","daffodil","damask","dandelion","dovegray","duckeggblue","dun","Dodgerblue","eaudenil","ebony","ecru","eggshellblue","eggshell","electricblue","emeraldgreen","emerald","fawn","federalyellow","firebrick","fireenginered","flame","flamingo","flaxen","flesh","floralwhite","forestgreen","fuchsia","fuscous","gainsboro","gamboge","garnet","gentianblue","gentianviolet","geranium","ginger","glaucous","gold","goldenbrown","goldenrod","goldochre","grape","grassgreen","gray","green","grizzle","gules","gunmetalgray","hazel","heather","heliotrope","henna","hepatic","hoar","honey","honeydew","hotpink","huntergreen","iceblue","incarnadine","Indianred","indigo","internationalorange","irongray","ivory","jadegreen","jade","jet","jonquil","kellygreen","Kendalgreen","khaki","khakigreen","lapislazuli","laurelgreen","lavender","lemonchiffon","lemon","lilac","lime","Lincolngreen","linen","liver","loden","lovat","macaroniandcheese","madder","magenta","magicmint","magnolia","mahogany","malachite","maroon","mauve","mazarine","melon","midnightblue","mignonette","militarygrey","mint","mintcream","mistyrose","moccasin","mocha","mossgreen","mulberry","mustard","natural","navajowhite","navy","Nileblue","Nilegreen","oak","oatmeal","oceangrey","ochre","offwhite","oldgold","oldlace","olivedrab","olive","orange","orchid","outerspace","oxblood","Oxfordblue","oyster","pansy","paprika","Parisgreen","patina","peagreen","peach","peacockblue","pearlgray","pearly","periwinkle","perse","petrolblue","petunia","pewter","pillarboxred","pinegreen","pink","pistachiogreen","platinumblond","platinum","plum","Pompeianred","poppy","powderblue","primrose","Prussianblue","puce","puke","purple","purpure","quartz","quince","raspberry","rawsienna","redviolet","red","reseda","riflegreen","robin_seggblue","rose","rouge","royalblue","royalpurple","ruby","russet","rust","sable","saddlebrown","safetyorange","saffron","sagegreen","salmon","sand","sandy","sanguine","sapphire","sard","saxeblue","scarlet","schoolbusyellow","seagreen","seashell","sepia","shockingpink","sienna","silver","silvergray","skyblue","slate","slateblack","slateblue","slategray","smoke","snow","sorrel","springgreen","stammel","steelblue","stone","straw","strawberry","sulfur","sunflower","tan","tangerine","taupe","taxiyellow","teak","teal","terracotta","timberwolf","titian","topaz","towcolored","Turkeyred","turquoise","Tyrianpurple","ultramarine","umber","Vandykebrown","venetianred","verdant","vermilion","vert","violetred","violet","virid","viridian","vividorange","walnut","Wedgewoodblue","wheat","wheaten","white","wine","xanthic","yellow","zaffre"],expression=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,url_regex=new RegExp(expression);function debounce(e,t,n){var i;return function(){var o=this,a=arguments,r=function(){i=null,n||e.apply(o,a)},s=n&&!i;clearTimeout(i),i=setTimeout(r,t),s&&e.apply(o,a)}}function animalGenerator(){var e=arrAnimals[Math.floor(Math.random()*arrAnimals.length)].toLowerCase();return e}function colourGenerator(){var e=arrColours[Math.floor(Math.random()*arrColours.length)].toLowerCase();return e}function randId(){return Math.random().toString(36).substr(2,10)}function escapeHTML(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML}function _clone(e){if(!e)return e;var t,n,i;for(i in t=Array.isArray(e)?[]:{},e)n=e[i],t[i]="object"===Object(_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_14__["a"])(n)?_clone(n):n;return t}var Filters={getPixels:function(e){var t=e,n=t.getContext("2d");return n.getImageData(0,0,t.width,t.height)},filterImage:function(e,t){for(var n=[e],i=2;i<arguments.length;i++)n.push(arguments[i]);return t.apply(null,n)},grayscale:function(e){for(var t=e.data,n=0;n<t.length;n+=4){var i=t[n],o=t[n+1],a=t[n+2],r=.2126*i+.7152*o+.0722*a;t[n]=t[n+1]=t[n+2]=r}return e},brightness:function(e,t,n){for(var i,o=e.data,a=0;a<o.length;a+=4)i=parseInt((o[a]-t)*n),i>255?i=255:i<0&&(i=0),o[a]=i,o[a+1]=i,o[a+2]=i,o[a+3]=255;return e},min_max:function(e){for(var t=e.data,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=0,a=0;a<t.length;a+=4)t[a]<n&&(n=t[a]),t[a]>i&&(i=t[a]),o+=t[a]/(t.length/4);return{min:n,max:i,avg:o}},lut:function(e,t){for(var n,i=e.data,o=0;o<i.length;o+=4)n=i[o],i[o]=t[n][0],i[o+1]=t[n][1],i[o+2]=t[n][2],i[o+3]=255;return e}},protocolAndDomainRE=/^(?:\w+:)?\/\/(\S+)$/,localhostDomainRE=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,nonLocalhostDomainRE=/^[^\s\.]+\.\S{2,}$/;function isUrl(e){if("string"!==typeof e)return!1;var t=e.match(protocolAndDomainRE);if(!t)return!1;var n=t[1];return!!n&&!(!localhostDomainRE.test(n)&&!nonLocalhostDomainRE.test(n))}var laxUrlRegex=/(?:(?:[^:]+:)?[/][/])?(?:.+@)?([^/]+)([/][^?#]+)/;function githubUrlToObject(e,t){var n={};if(t=t||{},!e)return null;if(e.url&&(e=e.url),"string"!==typeof e)return null;var i=e.match(/^([\w-_]+)\/([\w-_\.]+)(?:#([\w-_\.]+))?$/),o=e.match(/^github:([\w-_]+)\/([\w-_\.]+)(?:#([\w-_\.]+))?$/),a=e.match(/^git@[\w-_\.]+:([\w-_]+)\/([\w-_\.]+)$/);if(i)n.user=i[1],n.repo=i[2],n.branch=i[3]||"master",n.host="github.com";else if(o)n.user=o[1],n.repo=o[2],n.branch=o[3]||"master",n.host="github.com";else if(a)n.user=a[1],n.repo=a[2].replace(/\.git$/i,""),n.branch="master",n.host="github.com";else{if(e=e.replace(/^git\+/,""),!isUrl(e))return null;var r=e.match(laxUrlRegex)||[],s=Object(_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__["a"])(r,3),c=s[1],l=s[2];if(!c)return null;if("github.com"!==c&&"www.github.com"!==c&&!t.enterprise)return null;var u=l.match(/^\/([\w-_]+)\/([\w-_\.]+)(\/tree\/[\w-_\.\/]+)?(\/blob\/[\w-_\.\/]+)?/);if(!u)return null;n.user=u[1],n.repo=u[2].replace(/\.git$/i,""),n.host=c||"github.com",u[3]&&/^\/tree\/master\//.test(u[3])?(n.branch="master",n.path=u[3].replace(/\/$/,"")):u[3]?n.branch=u[3].replace(/^\/tree\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:u[4]?n.branch=u[4].replace(/^\/blob\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:n.branch="master"}return"github.com"===n.host?n.apiHost="api.github.com":n.apiHost="".concat(n.host,"/api/v3"),n.tarball_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo,"/tarball/").concat(n.branch),n.clone_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),"master"===n.branch?(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/master.zip")):(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/blob/").concat(n.branch),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo,"?branch=").concat(n.branch),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/").concat(n.branch,".zip")),n.path&&(n.https_url+=n.path),n.api_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo),n}function githubUrlRaw(e){return _githubUrlRaw.apply(this,arguments)}function _githubUrlRaw(){return _githubUrlRaw=Object(_home_runner_work_ImJoy_ImJoy_web_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a,r,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.includes("gist.github.com")){e.next=11;break}return n=t.split("/").slice(-1)[0],e.next=4,axios__WEBPACK_IMPORTED_MODULE_15___default.a.get("https://api.github.com/gists/"+n);case 4:if(i=e.sent,200!==i.status){e.next=10;break}return o=Object.values(i.data.files).filter(function(e){return e.filename.endsWith(".imjoy.html")})[0],e.abrupt("return",o.raw_url);case 10:throw"Failed to fetch from Gist: "+i.statusText;case 11:if(t.includes("blob")&&t.includes("github")){e.next=13;break}return e.abrupt("return",null);case 13:return a=githubUrlToObject(t),r=a.user,s=a.repo,c=new RegExp("^https://github.com/"+r+"/"+s+"/blob/","g"),l=t.replace(c,""),e.abrupt("return","https://raw.githubusercontent.com/"+r+"/"+s+"/"+l);case 19:case"end":return e.stop()}},e,this)})),_githubUrlRaw.apply(this,arguments)}function githubImJoyManifest(e){var t=githubUrlToObject(e),n=t.user,i=t.repo,o=t.branch;return"https://raw.githubusercontent.com/"+n+"/"+i+"/"+o+"/manifest.imjoy.json"}function githubRepo(e){var t=githubUrlToObject(e);return t.user+"/"+t.repo}var hot_lut=[[10,0,0],[13,0,0],[15,0,0],[18,0,0],[21,0,0],[23,0,0],[26,0,0],[28,0,0],[31,0,0],[34,0,0],[36,0,0],[39,0,0],[42,0,0],[44,0,0],[47,0,0],[49,0,0],[52,0,0],[55,0,0],[57,0,0],[60,0,0],[63,0,0],[65,0,0],[68,0,0],[70,0,0],[73,0,0],[76,0,0],[78,0,0],[81,0,0],[84,0,0],[86,0,0],[89,0,0],[91,0,0],[94,0,0],[97,0,0],[99,0,0],[102,0,0],[105,0,0],[107,0,0],[110,0,0],[112,0,0],[115,0,0],[118,0,0],[120,0,0],[123,0,0],[126,0,0],[128,0,0],[131,0,0],[133,0,0],[136,0,0],[139,0,0],[141,0,0],[144,0,0],[147,0,0],[149,0,0],[152,0,0],[154,0,0],[157,0,0],[160,0,0],[162,0,0],[165,0,0],[168,0,0],[170,0,0],[173,0,0],[175,0,0],[178,0,0],[181,0,0],[183,0,0],[186,0,0],[189,0,0],[191,0,0],[194,0,0],[196,0,0],[199,0,0],[202,0,0],[204,0,0],[207,0,0],[210,0,0],[212,0,0],[215,0,0],[217,0,0],[220,0,0],[223,0,0],[225,0,0],[228,0,0],[231,0,0],[233,0,0],[236,0,0],[238,0,0],[241,0,0],[244,0,0],[246,0,0],[249,0,0],[252,0,0],[254,0,0],[255,2,0],[255,5,0],[255,7,0],[255,10,0],[255,12,0],[255,15,0],[255,18,0],[255,20,0],[255,23,0],[255,26,0],[255,28,0],[255,31,0],[255,33,0],[255,36,0],[255,39,0],[255,41,0],[255,44,0],[255,47,0],[255,49,0],[255,52,0],[255,54,0],[255,57,0],[255,60,0],[255,62,0],[255,65,0],[255,68,0],[255,70,0],[255,73,0],[255,75,0],[255,78,0],[255,81,0],[255,83,0],[255,86,0],[255,89,0],[255,91,0],[255,94,0],[255,96,0],[255,99,0],[255,102,0],[255,104,0],[255,107,0],[255,110,0],[255,112,0],[255,115,0],[255,117,0],[255,120,0],[255,123,0],[255,125,0],[255,128,0],[255,131,0],[255,133,0],[255,136,0],[255,138,0],[255,141,0],[255,144,0],[255,146,0],[255,149,0],[255,151,0],[255,154,0],[255,157,0],[255,159,0],[255,162,0],[255,165,0],[255,167,0],[255,170,0],[255,172,0],[255,175,0],[255,178,0],[255,180,0],[255,183,0],[255,186,0],[255,188,0],[255,191,0],[255,193,0],[255,196,0],[255,199,0],[255,201,0],[255,204,0],[255,207,0],[255,209,0],[255,212,0],[255,214,0],[255,217,0],[255,220,0],[255,222,0],[255,225,0],[255,228,0],[255,230,0],[255,233,0],[255,235,0],[255,238,0],[255,241,0],[255,243,0],[255,246,0],[255,249,0],[255,251,0],[255,254,0],[255,255,2],[255,255,6],[255,255,10],[255,255,14],[255,255,18],[255,255,22],[255,255,26],[255,255,30],[255,255,34],[255,255,38],[255,255,42],[255,255,46],[255,255,50],[255,255,54],[255,255,58],[255,255,62],[255,255,65],[255,255,69],[255,255,73],[255,255,77],[255,255,81],[255,255,85],[255,255,89],[255,255,93],[255,255,97],[255,255,101],[255,255,105],[255,255,109],[255,255,113],[255,255,117],[255,255,121],[255,255,125],[255,255,128],[255,255,132],[255,255,136],[255,255,140],[255,255,144],[255,255,148],[255,255,152],[255,255,156],[255,255,160],[255,255,164],[255,255,168],[255,255,172],[255,255,176],[255,255,180],[255,255,184],[255,255,188],[255,255,191],[255,255,195],[255,255,199],[255,255,203],[255,255,207],[255,255,211],[255,255,215],[255,255,219],[255,255,223],[255,255,227],[255,255,231],[255,255,235],[255,255,239],[255,255,243],[255,255,247],[255,255,251],[255,255,255]]},"034f":function(e,t,n){"use strict";var i=n("7dba"),o=n.n(i);o.a},"039d":function(e,t,n){},"0529":function(e,t,n){"use strict";var i=n("039d"),o=n.n(i);o.a},"0798":function(e,t,n){},"0d19":function(e,t,n){"use strict";var i=n("4c02"),o=n.n(i);o.a},"11a5":function(e,t,n){},"12e7":function(e,t,n){"use strict";var i=n("ad7a"),o=n.n(i);o.a},"147d":function(e,t){e.exports='<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "native-python",\n  "version": "0.1.0",\n  "description": "[TODO: describe this plugin with one sentence.]",\n  "tags": [],\n  "ui": "",\n  "cover": "",\n  "inputs": null,\n  "outputs": null,\n  "flags": [],\n  "icon": "extension",\n  "api_version": "0.1.7",\n  "env": "",\n  "permissions": [],\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="python">\nfrom imjoy import api\n\n\nclass ImJoyPlugin():\n    def setup(self):\n        api.log(\'initialized\')\n\n    def run(self, ctx):\n        api.alert(\'hello world.\')\n\napi.export(ImJoyPlugin())\n<\/script>\n'},"151e":function(e,t,n){"use strict";var i=n("a773"),o=n.n(i);o.a},"1eb5":function(e,t,n){"use strict";var i=n("659e"),o=n.n(i);o.a},"21f5":function(e,t,n){},2733:function(e,t,n){"use strict";var i=n("2ba2"),o=n.n(i);o.a},"27e7":function(e,t,n){"use strict";var i=n("6b72"),o=n.n(i);o.a},"2a06":function(e,t,n){"use strict";var i=n("7c77"),o=n.n(i);o.a},"2ba2":function(e,t,n){},"2d2f":function(e,t,n){"use strict";var i=n("3781"),o=n.n(i);o.a},3145:function(e,t,n){"use strict";var i=n("ca44"),o=n.n(i);o.a},"32c4":function(e,t,n){"use strict";var i=n("f9cf"),o=n.n(i);o.a},3781:function(e,t,n){},"3d32":function(e,t,n){},"3de5":function(e,t,n){},"464c":function(e,t){e.exports='<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n    "name": "Untitled Plugin",\n    "type": "jupyter-notebook",\n    "version": "0.1.0",\n    "api_version": "0.1.2",\n    "description": "[TODO: describe this plugin with one sentence.]",\n    "tags": [],\n    "ui": "",\n    "inputs": null,\n    "outputs": null,\n    "flags": [],\n    "icon": "extension",\n    "env": "",\n    "requirements": [],\n    "dependencies": []\n}\n</config>\n\n<script lang="python">\nfrom imjoy import api\n\n\nclass ImJoyPlugin():\n    def setup(self):\n        api.log(\'initialized\')\n\n    def run(self, ctx):\n        api.alert(\'hello world.\')\n\napi.export(ImJoyPlugin())\n<\/script>\n'},"4c02":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"GenericWindow",function(){return Jn}),n.d(i,"ImageWindow",function(){return Xn}),n.d(i,"ImageListWindow",function(){return ii}),n.d(i,"PanelWindow",function(){return li}),n.d(i,"MarkdownWindow",function(){return fi}),n.d(i,"PluginEditorWindow",function(){return yi}),n.d(i,"LogWindow",function(){return Pi}),n.d(i,"FilesWindow",function(){return Mi}),n.d(i,"UrlListWindow",function(){return Fi}),n.d(i,"ImageCompareWindow",function(){return Zi}),n.d(i,"TerminalWindow",function(){return uo}),n.d(i,"JoyWindow",function(){return _o}),n.d(i,"SchemaIOWindow",function(){return Po});n("cadf"),n("551c"),n("097d");var o=n("a026"),a=n("8c4f"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"imjoy noselect"},[n("md-app",[n("md-app-toolbar",{staticClass:"md-dense app-toolbar",attrs:{"md-elevation":"0"}},[e.menuVisible?e._e():n("md-button",{staticClass:"md-primary md-icon-button",on:{click:function(t){e.menuVisible=!0}}},[n("md-icon",[e._v("menu")])],1),!e.menuVisible&&e.screenWidth>400?n("md-button",{staticClass:"site-title-small",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title-small",attrs:{src:"static/img/imjoy-logo-black.svg",alt:"ImJoy"}}),n("md-tooltip",[e._v("ImJoy home")])],1):e._e(),e.workspace_dropping&&e.screenWidth>400?n("md-button",[e._v("\n        Drop files to the workspace.\n      ")]):e.screenWidth>500&&e.status_text&&e.status_text.length?n("span",{staticClass:"status-text",class:e.status_text.includes("rror")||e.status_text.includes("Traceback")||e.status_text.includes("Fail")?"error-message":"",style:{"max-width":e.menuVisible?"calc( 100vw - 500px) !important":"calc(100vw - 250px) !important"},on:{click:function(t){e.showAlert(null,e.status_text)}}},[e._v("\n        "+e._s(e.status_text)+"\n      ")]):n("span",{staticClass:"subheader-title md-medium-hide",staticStyle:{flex:"1"}},[e._v("Deep Learning Made Easy!")]),n("div",{staticClass:"md-toolbar-section-end menubar-icons"},[e.wm.selected_window&&e.wm.selected_window.standalone?n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(t){e.wm.selected_window.close()}}},[n("md-icon",[e._v("close")]),n("md-tooltip",[e._v("Close window:\n            "+e._s(e.wm.selected_window.name.slice(0,30)+"(#"+e.wm.selected_window.index+")"))])],1):e._e(),e.wm.selected_window&&e.wm.selected_window.standalone&&e.wm.selected_window.loaders.length>0?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_vert")]),n("md-tooltip",[e._v("Current window:\n              "+e._s(e.wm.selected_window.name.slice(0,30)+"(#"+e.wm.selected_window.index+")"))])],1),n("md-menu-content",[n("md-menu-item",{attrs:{disabled:!0}},[e._v("\n              "+e._s(e.wm.selected_window.name.slice(0,30)+"(#"+e.wm.selected_window.index+")")+"\n            ")]),e._l(e.wm.selected_window.loaders,function(t,i){return n("md-menu-item",{key:i,on:{click:function(n){e.wm.registered_loaders&&e.wm.registered_loaders[t](e.wm.selected_window.data)}}},[n("span",[e._v(e._s(i))]),n("md-icon",[e._v("play_arrow")])],1)})],2)],1):e._e(),e._l(e.windows.slice(0,e.max_window_buttons),function(t,i){return n("md-button",{key:t.id,staticClass:"md-icon-button",attrs:{disabled:e.wm.selected_window===t},on:{click:function(n){e.wm.selectWindow(t)}}},[n("md-icon",[e._v(e._s("filter_"+(i+1)))]),n("md-tooltip",{staticClass:"md-xsmall-hide"},[e._v(e._s(t.name.slice(0,30)+"(#"+t.index+")"))])],1)}),e.windows.length>e.max_window_buttons?n("md-menu",[e.max_window_buttons>=9?n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("filter_9_plus")])],1):n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("filter")])],1),n("md-menu-content",[e._l(e.windows.slice(e.max_window_buttons),function(t){return n("md-menu-item",{key:t.id,attrs:{disabled:e.wm.selected_window===t},on:{click:function(n){e.wm.selectWindow(t)}}},[n("span",[e._v(e._s(t.name.slice(0,30)+"(#"+t.index+")"))]),n("md-icon",[e._v("forward")])],1)}),n("md-divider"),"grid"!==e.wm.window_mode?n("md-menu-item",{staticClass:"md-accent",on:{click:function(t){e.wm.closeAll()}}},[n("md-icon",[e._v("cancel")]),n("span",[e._v("Close All")]),n("md-tooltip",[e._v("Close all windows")])],1):e._e()],2)],1):e._e(),"grid"===e.wm.window_mode&&e.windows.length>0?n("md-menu",[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("picture_in_picture")]),n("md-tooltip",[e._v("Workspace")])],1),n("md-menu-content",[n("md-menu-item",{class:e.wm.selected_window?"md-primary":"",attrs:{disabled:!e.wm.selected_window},on:{click:function(t){e.wm.selected_window=null}}},[n("md-icon",[e._v("picture_in_picture")]),n("span",[e._v("Workspace")])],1),n("md-menu-item",{staticClass:"md-accent",on:{click:function(t){e.wm.closeAll()}}},[n("md-icon",[e._v("cancel")]),n("span",[e._v("Close All")]),n("md-tooltip",[e._v("Close all windows")])],1)],1)],1):e._e(),n("engine-control-panel",{attrs:{"engine-manager":e.em},on:{"start-terminal":e.startTerminal}}),n("md-menu",[e.latest_version&&!e.is_latest_version?n("md-button",{staticClass:"md-icon-button md-accent",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("error_outline")])],1):n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("details")])],1),n("md-menu-content",[n("md-menu-item",{attrs:{disabled:!0},on:{click:function(t){e.showSettingsDialog=!0}}},[n("md-icon",[e._v("settings")]),e._v("Settings\n            ")],1),n("md-menu-item",{staticClass:"md-primary",attrs:{href:"/lite",target:"_blank"}},[n("md-icon",[e._v("open_in_new")]),e._v("ImJoy-Lite\n            ")],1),n("md-menu-item",{staticClass:"md-primary",attrs:{href:"/docs/",target:"_blank"}},[n("md-icon",[e._v("library_books")]),e._v("Documentation\n            ")],1),n("md-menu-item",{staticClass:"md-primary",attrs:{href:"/docs/#/api?id=api-functions",target:"_blank"}},[n("md-icon",[e._v("toc")]),e._v("API Functions\n            ")],1),n("md-menu-item",{staticClass:"md-primary",attrs:{href:"https://forum.image.sc/tags/imjoy",target:"_blank"}},[n("md-icon",[e._v("help")]),e._v("Forum\n            ")],1),n("md-menu-item",{staticClass:"md-primary",attrs:{href:"https://github.com/imjoy-team/ImJoy",target:"_blank"}},[n("md-icon",[e._v("code")]),e._v("Github\n            ")],1),n("md-menu-item",{staticClass:"md-primary",on:{click:function(t){e.showAboutDialog=!0}}},[n("md-icon",[e._v("info")]),e._v("About\n            ")],1),n("md-menu-item",[e.latest_version&&e.is_latest_version?n("md-icon",[e._v("check")]):n("md-icon",[e._v("error_outline")]),n("div",{staticStyle:{width:"100%",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.checkImJoyUpdate(t)}}},[e.checking?n("div",{staticClass:"loading loading-lg",staticStyle:{left:"-30px"}}):e.version_badge_url?n("img",{attrs:{src:e.version_badge_url}}):n("span",[e._v("ImJoy v"+e._s(e.imjoy_version))])]),n("md-tooltip",[e._v("click to check updates")])],1),n("md-menu-item",{staticClass:"md-primary",on:{click:e.restartImJoy}},[n("md-icon",[e._v("autorenew")]),n("span",[e._v("Restart ImJoy")]),n("md-tooltip",[e._v("click to reload")])],1)],1)],1)],2),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"folder_form"},[n("input",{ref:"folder_select",staticClass:"md-file",attrs:{type:"file",webkitdirectory:"",mozdirectory:"",msdirectory:"",odirectory:"",directory:"",multiple:""},on:{change:e.selectFileChanged}})]),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_form"},[n("input",{ref:"file_select",staticClass:"md-file",attrs:{type:"file",multiple:""},on:{change:e.selectFileChanged}})])],1),n("md-app-drawer",{attrs:{"md-active":e.menuVisible,"md-persistent":e.screenWidth>800?"full":null,"md-swipeable":!(e.screenWidth>600)},on:{"update:mdActive":function(t){e.menuVisible=t},"md-closed":function(t){e.wm.resizeAll()},"md-opened":function(t){e.wm.resizeAll()}}},[n("div",{staticClass:"md-toolbar-row title-bar"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"site-button site-title",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title",attrs:{src:"static/img/imjoy-logo-black.svg",alt:"ImJoy"}})]),n("span",{staticClass:"superscript md-small-hide"},[e._v("beta")])],1),e.pm?n("div",{staticClass:"md-toolbar-section-end"},[n("md-menu",[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("widgets")]),n("md-tooltip",[e._v("Current workspace: "+e._s(e.pm.selected_workspace))])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){e.showWorkspaceDialog=!0}}},[n("md-icon",[e._v("view_list")]),e._v("Add Workspace\n              ")],1),n("md-divider"),e._l(e.pm.workspace_list,function(t){return n("md-menu-item",{key:t,attrs:{disabled:t===e.pm.selected_workspace},on:{click:function(n){e.switchWorkspace(t)}}},[n("span",[e._v(e._s(t))]),n("md-icon",[e._v("forward")]),n("md-tooltip",[e._v("Switch to workspace: "+e._s(t)+" ")])],1)})],2)],1),n("md-button",{staticClass:"md-icon-button md-dense md-raised",on:{click:function(t){e.menuVisible=!e.menuVisible}}},[n("md-icon",[e._v("keyboard_arrow_left")])],1)],1):e._e()]),e.plugin_loaded?e._e():n("div",{staticClass:"loading loading-lg",staticStyle:{top:"10%"}}),e.pm?n("md-card",{directives:[{name:"show",rawName:"v-show",value:e.plugin_loaded,expression:"plugin_loaded"}],attrs:{id:"plugin-menu"}},[n("md-card-header",[n("md-menu",{attrs:{"md-size":"big"}},[n("md-button",{class:e.screenWidth>600?"":"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("folder_open")]),n("span",{staticClass:"md-xsmall-hide"},[e._v("Files")])],1),n("md-menu-content",[e.fm&&e.fm.fileManagers.length>0?n("md-menu-item",{staticClass:"md-button",on:{click:function(t){e.showFileManagerDialog(),e.files_expand=!1}}},[n("md-icon",[e._v("add_to_queue")]),e._v("File Manager\n                "),n("md-tooltip",[e._v("Load files through file manager")])],1):e._e(),n("md-menu-item",{staticClass:"md-button",on:{click:function(t){e.$refs.file_form.reset(),e.$refs.file_select.click(),e.files_expand=!1}}},[n("md-icon",[e._v("insert_drive_file")]),e._v("Open File\n              ")],1),n("md-menu-item",{staticClass:"md-button",on:{click:function(t){e.$refs.folder_form.reset(),e.$refs.folder_select.click(),e.files_expand=!1}}},[n("md-icon",[e._v("folder_open")]),e._v("Open Folder\n              ")],1)],1)],1),n("md-menu",{attrs:{"md-size":"big"}},[n("md-button",{class:e.screenWidth>600?"":"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("format_list_bulleted")]),n("span",{staticClass:"md-xsmall-hide"},[e._v("Workflow")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){e.clearWorkflow(),e.workflow_expand=!0}}},[n("md-icon",[e._v("playlist_add")]),e._v("New Workflow\n              ")],1),e._l(e.pm.workflow_list,function(t){return n("md-menu-item",{key:t.name,on:{click:function(n){e.workflow_expand=!0,e.loadWorkflow(t)}}},[n("span",[e._v(e._s(t.name))]),n("md-button",{staticClass:"md-icon-button",on:{click:function(n){n.stopPropagation(),e.shareWorkflow(t)}}},[n("md-icon",[e._v("share")])],1),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.pm.removeWorkflow(t)}}},[n("md-icon",[e._v("clear")])],1)],1)})],2)],1),n("md-button",{ref:"add_plugin_button",class:e.pm.installed_plugins.length>0?"":"md-primary",on:{click:function(t){e.showPluginManagement()}}},[n("md-icon",[e._v("add")]),e._v("Plugins\n          ")],1)],1),n("md-card-content",[e.pm?n("div",{directives:[{name:"show",rawName:"v-show",value:e.workflow_expand,expression:"workflow_expand"}],attrs:{id:"workflow-panel"}},[e.plugin_loaded?n("joy",{ref:"workflow",attrs:{config:e.workflow_joy_config}}):e._e(),n("p",[e.plugin_loaded?n("md-button",{staticClass:"md-button",on:{click:function(t){e.runWorkflow(e.workflow_joy_config.joy)}}},[n("md-icon",[e._v("play_arrow")]),e._v("Run\n                "),n("md-tooltip",[e._v("run the workflow")])],1):e._e(),e.plugin_loaded?n("md-button",{staticClass:"md-button",on:{click:function(t){e.pm.saveWorkflow(e.workflow_joy_config.joy)}}},[n("md-icon",[e._v("save")]),e._v("Save\n                "),n("md-tooltip",[e._v("save the workflow")])],1):e._e(),n("md-button",{staticClass:"md-accent",on:{click:function(t){e.clearWorkflow()}}},[n("md-icon",[e._v("clear")]),e._v("Clear\n                "),n("md-tooltip",[e._v("Clear workflow")])],1)],1)],1):e._e(),e._l(e.sortedRunnablePlugins(),function(t){return n("div",{key:t.name},[n("md-divider"),n("md-badge",{staticClass:"md-square md-primary",class:t.update_available?"":"hide-badge",attrs:{"md-dense":"","md-content":"NEW"}},[n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-icon-button",class:t.running?"md-accent":"",attrs:{"md-menu-trigger":""}},[t.initializing||t.terminating?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":20,"md-mode":"indeterminate"}}):n("plugin-icon",{attrs:{icon:t.config.icon}}),e.screenWidth>500?n("md-tooltip",[e._v(e._s(t.name+": "+t.config.description))]):e._e()],1),n("md-menu-content",[t.config.origin?n("md-menu-item",{class:t.update_available?"md-primary":"",on:{click:function(n){e.updatePlugin(t.id)}}},[n("md-icon",{class:t.update_available?"md-primary":""},[e._v("cloud_download")]),e._v("Update\n                  ")],1):e._e(),t._log_history&&t._log_history.length>0&&e.screenWidth<=400?n("md-menu-item",{on:{click:function(n){e.showLog(t)}}},[t._log_history._error?n("md-icon",{staticClass:"red"},[e._v("error_outline")]):n("md-icon",[e._v("info")]),e._v("Log\n                  ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.showDoc(t.id)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n                  ")],1),t.config.origin?n("md-menu-item",{on:{click:function(n){e.sharePlugin(t.id)}}},[n("md-icon",[e._v("share")]),e._v("Share\n                  ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.downloadPlugin(t.id)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Export\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.editPlugin(t.id)}}},[n("md-icon",[e._v("edit")]),e._v("Edit\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.reloadPlugin(t.config)}}},[n("md-icon",[e._v("autorenew")]),e._v("Reload\n                  ")],1),n("md-menu-item",{on:{click:function(n){e.unloadPlugin(t)}}},[n("md-icon",[e._v("clear")]),e._v("Terminate\n                  ")],1),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.removePlugin(t)}}},[n("md-icon",[e._v("delete_forever")]),e._v("Remove\n                  ")],1),t.config.engine_mode?n("div",[n("md-divider"),n("md-menu-item",{on:{click:function(n){e.switchEngine(t,"auto")}}},["auto"===t.config.engine_mode?n("md-icon",[e._v("check_box")]):n("md-icon",[e._v("check_box_outline_blank")]),n("span",{class:"auto"===t.config.engine_mode?"bold":""},[e._v("Auto")])],1),e._l(e.em.matchEngineByType(t.type),function(i){return n("md-menu-item",{key:i.name,on:{click:function(n){e.switchEngine(t,i)}}},[t.config.engine_mode===i.name||t.engine&&t.engine.name===i.name?n("md-icon",[e._v("radio_button_checked")]):n("md-icon",[e._v("radio_button_unchecked")]),n("span",{class:t.engine&&t.engine.name===i.name?"bold":""},[e._v(e._s(i.name))])],1)}),n("md-divider"),e._l(t.config.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){e.switchTag(t,i)}}},[t.config.tag===i?n("md-icon",[e._v("radio_button_checked")]):n("md-icon",[e._v("radio_button_unchecked")]),n("span",{class:t.config.tag===i?"bold":""},[e._v("Tag: "+e._s(i))])],1)})],2):e._e()],1)],1)],1),n("md-button",{staticClass:"joy-run-button",class:t.running?"busy-plugin":t._disconnected&&t.engine?"md-accent":"md-primary",attrs:{disabled:t._disconnected&&!t.engine},on:{click:function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;t._disconnected?e.connectPlugin(t):e.runOp(t.ops[t.name])},contextmenu:function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;e.logPlugin(t)}}},[e._v("\n              "+e._s(t.config.name+" "+t.config.badges)+"\n            ")]),n("div",{staticClass:"floating-right-buttons"},[t._log_history&&t._log_history.length>0&&e.screenWidth>400?n("md-button",{staticClass:"md-icon-button",on:{click:function(n){e.showLog(t)}}},[t._log_history._error?n("md-icon",{staticClass:"red"},[e._v("error_outline")]):n("md-icon",[e._v("info")]),t._log_history._error||t._log_history._info?n("md-tooltip",[e._v(e._s(t._log_history._error||t._log_history._info))]):e._e()],1):n("md-button",{staticClass:"md-icon-button md-xsmall-hide",attrs:{disabled:""}}),n("md-button",{staticClass:"md-icon-button",on:{click:function(n){t.panel_expanded=!t.panel_expanded,e.$forceUpdate()}}},[t.panel_expanded?n("md-icon",[e._v("expand_less")]):n("md-icon",[e._v("expand_more")])],1)],1),(t.running||t.initializing||t.terminating)&&t._progress?n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":t._progress}}):e._e(),e._l(t.ops,function(i){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.panel_expanded,expression:"plugin.panel_expanded"}],key:i.plugin_id+i.name},[i.name!=t.name?n("md-button",{staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[e._v("chevron_right")])],1):e._e(),i.name!=t.name?n("md-button",{staticClass:"joy-run-button md-primary op-button",class:t.running?"md-accent":"md-primary",attrs:{disabled:t._disconnected},on:{click:function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;e.runOp(i)},contextmenu:function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;e.logPlugin(t)}}},[e._v("\n                "+e._s(i.name)+"\n              ")]):e._e(),n("joy",{attrs:{config:i,show:t.panel_expanded||!1}})],1)}),n("md-divider")],2)}),n("md-divider"),n("div",e._l(e.sortedNonRunnablePlugins(),function(t){return n("div",{key:t.name},[n("md-badge",{staticClass:"md-square md-primary",class:t.update_available?"":"hide-badge",attrs:{"md-dense":"","md-content":"NEW"}},[n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-icon-button",class:t.running?"md-accent":"",attrs:{"md-menu-trigger":""}},[t.initializing||t.terminating?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":20,"md-mode":"indeterminate"}}):n("plugin-icon",{attrs:{icon:t.config.icon}}),e.screenWidth>500?n("md-tooltip",[e._v(e._s(t.name+": "+t.config.description))]):e._e()],1),n("md-menu-content",[t.config.origin?n("md-menu-item",{class:t.update_available?"md-primary":"",on:{click:function(n){e.updatePlugin(t.id)}}},[n("md-icon",{class:t.update_available?"md-primary":""},[e._v("cloud_download")]),e._v("Update\n                    ")],1):e._e(),t._log_history&&t._log_history.length>0&&e.screenWidth<=400?n("md-menu-item",{on:{click:function(n){e.showLog(t)}}},[t._log_history._error?n("md-icon",{staticClass:"red"},[e._v("error_outline")]):n("md-icon",[e._v("info")]),e._v("Log\n                    ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.showDoc(t.id)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n                    ")],1),t.config.origin?n("md-menu-item",{on:{click:function(n){e.sharePlugin(t.id)}}},[n("md-icon",[e._v("share")]),e._v("Share\n                    ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.downloadPlugin(t.id)}}},[n("md-icon",[e._v("cloud_download")]),e._v("Export\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.editPlugin(t.id)}}},[n("md-icon",[e._v("edit")]),e._v("Edit\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.reloadPlugin(t.config)}}},[n("md-icon",[e._v("autorenew")]),e._v("Reload\n                    ")],1),n("md-menu-item",{on:{click:function(n){e.unloadPlugin(t)}}},[n("md-icon",[e._v("clear")]),e._v("Terminate\n                    ")],1),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.removePlugin(t)}}},[n("md-icon",[e._v("delete_forever")]),e._v("Remove\n                    ")],1)],1)],1)],1),n("md-button",{staticClass:"joy-run-button non-runnable-btn",class:t.running?"busy-plugin":t._disconnected&&t.engine?"md-accent":"",attrs:{disabled:!t.engine||!t._disconnected},on:{click:function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;e.connectPlugin(t)},contextmenu:function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;e.logPlugin(t)}}},[e._v("\n                "+e._s(t.config.name+" "+t.config.badges)+"\n              ")]),n("div",{staticClass:"floating-right-buttons"},[t._log_history&&t._log_history.length>0&&e.screenWidth>400?n("md-button",{staticClass:"md-icon-button md-xsmall-hide",on:{click:function(n){e.showLog(t)}}},[t._log_history._error?n("md-icon",{staticClass:"red"},[e._v("error_outline")]):n("md-icon",[e._v("info")]),t._log_history._error||t._log_history._info?n("md-tooltip",[e._v(e._s(t._log_history._error||t._log_history._info))]):e._e()],1):n("md-button",{staticClass:"md-icon-button md-xsmall-hide",attrs:{disabled:""}}),n("md-button",{staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[e._v("visibility_off")])],1)],1),n("md-divider")],1)})),n("md-divider"),e.pm.installed_plugins.length<=0?n("md-empty-state",{attrs:{id:"plugin-empty-state","md-icon":"extension","md-label":"","md-description":""}},[n("md-button",{ref:"add_plugin_button",staticClass:"md-primary md-raised",on:{click:function(t){e.showPluginManagement()}}},[n("md-icon",[e._v("add")]),e._v("Add Plugins\n            ")],1)],1):e._e()],2)],1):e._e()],1),n("md-app-content",{staticClass:"whiteboard-content",class:e.workspace_dropping?"file-dropping":""},[n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":e.progress}}),e.wm?n("whiteboard",{attrs:{id:"whiteboard",mode:e.wm.window_mode,"window-manager":e.wm},on:{create:function(t){e.createWindow(t)}}}):e._e()],1)],1),n("md-snackbar",{staticClass:"md-accent",attrs:{id:"api-snackbar","md-position":"center","md-active":e.show_snackbar,"md-duration":e.snackbar_duration},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[n("span",{on:{click:function(t){e.showAlert(null,e.snackbar_info)}}},[e._v(e._s(e.snackbar_info))]),n("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[n("md-icon",[e._v("clear")])],1)],1),n("md-dialog-alert",{staticClass:"api-dialog",attrs:{"md-active":e.alert_config.show,"md-title":e.alert_config.title,"md-content":e.alert_config.content,"md-confirm-text":e.alert_config.confirm_text},on:{"update:mdActive":function(t){e.$set(e.alert_config,"show",t)}}}),n("md-dialog-confirm",{staticClass:"api-dialog",attrs:{"md-active":e.confirm_config.show,"md-title":e.confirm_config.title,"md-content":e.confirm_config.content,"md-confirm-text":e.confirm_config.confirm_text,"md-cancel-text":e.confirm_config.canel_text},on:{"update:mdActive":function(t){e.$set(e.confirm_config,"show",t)},"md-confirm":e.confirm_config.confirm,"md-cancel":e.confirm_config.cancel}}),n("md-dialog-prompt",{staticClass:"api-dialog",attrs:{"md-active":e.prompt_config.show,"md-title":e.prompt_config.title,"md-content":e.prompt_config.content,"md-input-maxlength":"100000","md-input-placeholder":e.prompt_config.placeholder,"md-confirm-text":e.prompt_config.confirm_text},on:{"update:mdActive":function(t){e.$set(e.prompt_config,"show",t)},"md-confirm":e.prompt_config.confirm,"md-cancel":e.prompt_config.cancel},model:{value:e.prompt_config.value,callback:function(t){e.$set(e.prompt_config,"value",t)},expression:"prompt_config.value"}}),n("file-dialog",{ref:"file-dialog",attrs:{id:"engine-file-dialog",file_managers:e.selected_file_managers,"upload-file-to-url":e.uploadFileToUrl}}),n("md-dialog",{staticClass:"window-dialog-container",class:e.dialog_window_config.fullscreen||e.dialog_window_config.standalone?"fullscreen-dialog":"normal-dialog",style:{height:e.dialog_auto_height,width:"800px"},attrs:{"md-active":e.showPluginDialog,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.showPluginDialog=t}}},[e.dialogWindows[0]?n("window",{key:e.dialogWindows[0].id+"_dialog",attrs:{w:e.dialogWindows[0],withDragHandle:!1},on:{close:function(t){e.closePluginDialog(e.dialogWindows[0])},fullscreen:function(t){e.dialog_window_config.fullscreen=!0,e.dialogWindows[0].fullscreen=!0,e.$forceUpdate()},normalsize:function(t){e.dialog_window_config.fullscreen=!1,e.dialogWindows[0].fullscreen=!1,e.$forceUpdate()}}}):e._e()],1),n("md-dialog",{attrs:{"md-active":e.showWorkspaceDialog,"md-click-outside-to-close":!0},on:{"update:mdActive":function(t){e.showWorkspaceDialog=t}}},[n("md-dialog-title",[e._v("Workspace Management\n      "),n("md-button",{staticClass:"md-accent",staticStyle:{position:"absolute",top:"8px",right:"5px"},on:{click:function(t){e.showWorkspaceDialog=!1}}},[n("md-icon",[e._v("clear")])],1)],1),n("md-dialog-content",[n("md-toolbar",{staticClass:"md-dense",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-field",[n("label",{attrs:{for:"workspace_name"}},[e._v("Workspace Name")]),n("md-input",{attrs:{type:"text",placeholder:"Create a new workspace",name:"workspace_name"},model:{value:e.new_workspace_name,callback:function(t){e.new_workspace_name=t},expression:"new_workspace_name"}})],1)],1),n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.switchWorkspace(e.new_workspace_name),e.showWorkspaceDialog=!1}}},[n("md-icon",[e._v("add")]),e._v("New")],1)],1)]),n("md-list",{staticClass:"md-double-line md-dense"},e._l(e.pm.workspace_list,function(t){return n("md-list-item",{key:t},[n("span",[e._v(e._s(t))]),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[e._v("more_horiz")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showWorkspaceDialog=!1,e.switchWorkspace(t)}}},[n("md-icon",[e._v("forward")]),e._v(" Switch\n              ")],1),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){e.removeWorkspace(t)}}},[n("md-icon",[e._v("delete")]),e._v(" Delete\n              ")],1)],1)],1)],1)}))],1)],1),n("md-dialog",{staticStyle:{"max-width":"800px",width:"100%",height:"100%"},attrs:{"md-active":e.showAboutDialog,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.showAboutDialog=t}}},[n("md-dialog-title",[e._v("About ImJoy\n      "),n("md-button",{staticClass:"md-accent",staticStyle:{position:"absolute",top:"8px",right:"5px"},on:{click:function(t){e.showAboutDialog=!1}}},[n("md-icon",[e._v("clear")])],1)],1),n("md-dialog-content",[n("about")],1)],1),n("md-dialog",{staticClass:"plugin-dialog",attrs:{"md-active":e.showAddPluginDialog,"md-click-outside-to-close":!0},on:{"update:mdActive":function(t){e.showAddPluginDialog=t}}},[n("md-dialog-title",[e._v(e._s(e.plugin4install?"Plugin Installation":"ImJoy Plugin Management")+"\n      "),n("md-button",{staticClass:"md-accent",staticStyle:{position:"absolute",top:"8px",right:"5px"},on:{click:function(t){e.showAddPluginDialog=!1,e.clearPluginUrl()}}},[n("md-icon",[e._v("clear")])],1)],1),n("md-dialog-content",[e.show_plugin_templates?[n("md-menu",[n("md-button",{staticClass:"md-primary md-raised",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("add")]),e._v("Create a new plugin\n            "),n("md-tooltip",[e._v("Create a new plugin")])],1),n("md-menu-content",e._l(e.plugin_templates,function(t){return n("md-menu-item",{key:t.name,on:{click:function(n){e.newPlugin(t.code),e.showAddPluginDialog=!1}}},[n("md-icon",[e._v(e._s(t.icon))]),e._v(e._s(t.name)+"\n            ")],1)}))],1),n("br"),n("br")]:e._e(),e.show_plugin_url?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Install from URL")]),n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("md-field",{staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[e._v("cloud_download")]),n("md-input",{attrs:{placeholder:"Please paste the URL here and press enter.",type:"text",name:"plugin_url"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.tag4install="",e.getPlugin4Install(e.plugin_url)}},model:{value:e.plugin_url,callback:function(t){e.plugin_url=t},expression:"plugin_url"}}),n("md-tooltip",[e._v("Press `Enter` to get the plugin")])],1)],1)],1)],1):e._e(),e.downloading_plugin&&!e.plugin4install?n("div",{staticClass:"md-toolbar-section-center"},[n("div",{staticClass:"loading loading-lg",staticStyle:{"padding-right":"30px"}})]):e._e(),e.downloading_error?n("h2",[e._v("Â Â "+e._s(e.downloading_error))]):e._e(),e.plugin4install?n("md-card",[e.plugin4install.cover&&"string"===typeof e.plugin4install.cover?n("md-card-media",{attrs:{"md-ratio":"16:9"}},[n("img",{attrs:{src:e.plugin4install.cover,alt:"plugin-cover"}})]):e.plugin4install.cover?n("div",{staticClass:"carousel"},[e._m(0),n("div",{staticClass:"carousel-container"},e._l(e.plugin4install.cover,function(e,t){return n("figure",{key:t,staticClass:"carousel-item"},[n("img",{staticClass:"img-responsive rounded",attrs:{src:e,alt:"plugin cover"}})])})),n("div",{staticClass:"carousel-nav"},e._l(e.plugin4install.cover,function(t,i){return n("label",{key:i,staticClass:"nav-item text-hide c-hand",attrs:{for:"slide-"+i}},[e._v(e._s(i))])}))],2):e._e(),n("md-card-header",[n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("div",{staticStyle:{"margin-top":"30px","margin-bottom":"30px"}},[n("h2",[n("plugin-icon",{attrs:{icon:e.plugin4install.icon}}),e._v("\n                "+e._s(e.plugin4install.name+" "+e.plugin4install.badges)+"\n              ")],1)]),e.installing||!e.plugin_loaded?n("div",{staticClass:"md-toolbar-section-end"},[n("div",{staticClass:"loading loading-lg",staticStyle:{"padding-right":"30px"}})]):e.tag4install?n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.installPlugin(e.plugin4install,e.tag4install)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(e.plugin4install._installation_text||"Install")+"\n                "),n("md-tooltip",[e._v("Install "+e._s(e.plugin4install.name)+" (tag=`"+e._s(e.tag4install)+"`)")])],1)],1):n("div",{staticClass:"md-toolbar-section-end"},[e.plugin4install.tags&&e.plugin4install.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(e.plugin4install._installation_text||"Install")+"\n                  "),n("md-tooltip",[e._v("Choose a tag to install\n                    "+e._s(e.plugin4install.name))])],1),n("md-menu-content",e._l(e.plugin4install.tags,function(t){return n("md-menu-item",{key:t,on:{click:function(n){e.installPlugin(e.plugin4install,t)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(t)+"\n                  ")],1)}))],1):n("md-button",{staticClass:"md-button md-primary",on:{click:function(t){e.installPlugin(e.plugin4install)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(e.plugin4install._installation_text||"Install")+"\n              ")],1)],1)])],1),n("md-card-content",[n("p",[e._v("Version: "+e._s(e.plugin4install.version))]),n("p",[e._v(e._s(e.plugin4install.description))]),e._l(e.plugin4install.tags,function(t){return n("md-chip",{key:t,class:e.tag4install===t?"md-primary":"",on:{click:function(n){e.tag4install=t}}},[e._v(e._s(t))])}),n("br"),e.plugin4install.code?n("md-switch",{model:{value:e.show_plugin_source,callback:function(t){e.show_plugin_source=t},expression:"show_plugin_source"}},[e._v("Show plugin source code")]):e._e(),n("p",[e._v("\n            This plugin is "),n("strong",[e._v("NOT")]),e._v(" provided by ImJoy.io. Please\n            make sure the plugin is provided by a trusted source, otherwise it\n            may "),n("strong",[e._v("harm")]),e._v(" your computer.\n          ")]),e.show_plugin_source?n("plugin-editor",{staticClass:"code-editor",attrs:{title:e.plugin4install.name},model:{value:e.plugin4install.code,callback:function(t){e.$set(e.plugin4install,"code",t)},expression:"plugin4install.code"}}):e._e()],2)],1):e._e(),n("md-card",{directives:[{name:"show",rawName:"v-show",value:e.show_plugin_store,expression:"show_plugin_store"}]},[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Install from the plugin repository")]),n("md-chips",{staticClass:"md-primary shake-on-error",attrs:{"md-placeholder":"Add a repository url (e.g. GITHUB REPO) and press enter."},on:{"md-insert":function(t){e.pm.addRepository(t)},"md-delete":function(t){e.pm.removeRepository(e.getRepository(t))}},scopedSlots:e._u([{key:"md-chip",fn:function(t){var i=t.chip;return[e.pm.selected_repository&&i===e.pm.selected_repository.name?n("strong",{staticClass:"md-primary"},[e._v(e._s(i))]):n("div",{on:{click:function(t){e.selectRepository(i)}}},[e._v(e._s(i))])]}}]),model:{value:e.pm.repository_names,callback:function(t){e.$set(e.pm,"repository_names",t)},expression:"pm.repository_names"}},[e.pm.selected_repository?n("div",{staticClass:"md-helper-text"},[e._v("\n              "+e._s(e.pm.selected_repository.name)+":\n              "+e._s(e.pm.selected_repository.description)+"\n            ")]):e._e()])],1),n("md-card-content",[e.pm?n("plugin-list",{attrs:{"plugin-manager":e.pm,"init-search":e.init_plugin_search,plugins:e.pm.available_plugins,workspace:e.pm.selected_workspace},on:{message:e.showMessage}}):e._e()],1)],1)],2)],1)],1)},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return e._l(e.plugin4install.cover,function(e,t){return n("input",{key:t,staticClass:"carousel-locator",attrs:{id:"slide-"+t,type:"radio",name:"carousel-radio",hidden:""},domProps:{checked:1===t}})})}],c=(n("f751"),n("ac4d"),n("8a81"),n("f559"),n("a481"),n("6762"),n("2fdb"),n("4917"),n("6b54"),n("96cf"),n("1da1")),l=(n("28a5"),n("ac6a"),n("456d"),n("7f7f"),n("53ca")),u=n("2440"),d=n("bc3a"),p=n.n(d),m=n("cb3a"),h=n.n(m),f=n("147d"),g=n.n(f),_=n("a4ec"),v=n.n(_),w=n("ca41"),b=n.n(w),y=n("464c"),k=n.n(y),x=n("9224"),j=n("025e"),C=n("c0c4"),O=n.n(C),P=n("d4ec"),E=n("bee2"),D=(n("7514"),n("3b2b"),n("3846"),n("b54a"),n("aef6"),n("3835")),R=n("d6e1"),I=n("69a0"),W=n.n(I),M=n("2ef0"),S=n.n(M),A=n("651e"),$=n.n(A),U=(n("0d6d"),/\r?\n/g),T=/^\s*$/,F=/^(\r?\n)*[\t\s]/,L=function(e){if(!F.test(e))return e;for(var t,n,i,o=e.split(U),a=1/0,r=0;r<o.length;r++){var s=o[r];if(!T.test(s))if(t)n=N(s,t),n<a&&(a=n);else{if(i=s.charAt(0)," "!==i&&"\t"!==i)return e;t=i,n=N(s,t),n<a&&(a=n)}}return o.map(function(e){return e.slice(a)}).join("\n")};function N(e,t){var n=0;while(e.charAt(n)===t)n++;return n}Object.freeze({});Object.prototype.toString;function q(e,t){for(var n=Object.create(null),i=e.split(","),o=0;o<i.length;o++)n[i[o]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}q("slot,component",!0),q("key,ref,slot,slot-scope,is");Object.prototype.hasOwnProperty;function z(e){var t=Object.create(null);return function(n){var i=t[n];return i||(t[n]=e(n))}}var B=/-(\w)/g;z(function(e){return e.replace(B,function(e,t){return t?t.toUpperCase():""})});function J(e,t){function n(n){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n}function K(e,t){return e.bind(t)}Function.prototype.bind;var H=function(e,t,n){return!1};q("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),q("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source");var V=q("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),G=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Y="[a-zA-Z_][\\w\\-\\.]*",X="((?:"+Y+"\\:)?"+Y+")",Z=new RegExp("^<"+X),Q=/^\s*(\/?)>/,ee=new RegExp("^<\\/"+X+"[^>]*>"),te=/^<!DOCTYPE [^>]+>/i,ne=/^<!\--/,ie=/^<!\[/,oe=!1;"x".replace(/x(.)?/g,function(e,t){oe=""===t});var ae=q("script,style,textarea",!0),re={},se={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t"},ce=/&(?:lt|gt|quot|amp);/g,le=/&(?:lt|gt|quot|amp|#10|#9);/g,ue=q("pre,textarea",!0),de=function(e,t){return e&&ue(e)&&"\n"===t[0]};function pe(e,t){var n=t?le:ce;return e.replace(n,function(e){return se[e]})}function me(e,t){var n,i,o=[],a=t.expectHTML,r=t.isUnaryTag||H,s=t.canBeLeftOpenTag||H,c=0;while(e){if(n=e,i&&ae(i)){var l=0,u=i.toLowerCase(),d=re[u]||(re[u]=new RegExp("([\\s\\S]*?)(</"+u+"[^>]*>)","i")),p=e.replace(d,function(e,n,i){return l=i.length,ae(u)||"noscript"===u||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),de(u,n)&&(n=n.slice(1)),t.chars&&t.chars(n),""});c+=e.length-p.length,e=p,O(u,c-l,c)}else{var m=e.indexOf("<");if(0===m){if(ne.test(e)){var h=e.indexOf("--\x3e");if(h>=0){t.shouldKeepComment&&t.comment(e.substring(4,h)),x(h+3);continue}}if(ie.test(e)){var f=e.indexOf("]>");if(f>=0){x(f+2);continue}}var g=e.match(te);if(g){x(g[0].length);continue}var _=e.match(ee);if(_){var v=c;x(_[0].length),O(_[1],v,c);continue}var w=j();if(w){C(w),de(i,e)&&x(1);continue}}var b=void 0,y=void 0,k=void 0;if(m>=0){y=e.slice(m);while(!ee.test(y)&&!Z.test(y)&&!ne.test(y)&&!ie.test(y)){if(k=y.indexOf("<",1),k<0)break;m+=k,y=e.slice(m)}b=e.substring(0,m),x(m)}m<0&&(b=e,e=""),t.chars&&b&&t.chars(b)}if(e===n){t.chars&&t.chars(e),!o.length&&t.warn&&t.warn('Mal-formatted tag at end of template: "'+e+'"');break}}function x(t){c+=t,e=e.substring(t)}function j(){var t=e.match(Z);if(t){var n,i,o={tagName:t[1],attrs:[],start:c};x(t[0].length);while(!(n=e.match(Q))&&(i=e.match(G)))x(i[0].length),o.attrs.push(i);if(n)return o.unarySlash=n[1],x(n[0].length),o.end=c,o}}function C(e){var n=e.tagName,c=e.unarySlash;a&&("p"===i&&V(n)&&O(i),s(n)&&i===n&&O(n));for(var l=r(n)||!!c,u=e.attrs.length,d=new Array(u),p=0;p<u;p++){var m=e.attrs[p];oe&&-1===m[0].indexOf('""')&&(""===m[3]&&delete m[3],""===m[4]&&delete m[4],""===m[5]&&delete m[5]);var h=m[3]||m[4]||m[5]||"",f="a"===n&&"href"===m[1]?t.shouldDecodeNewlinesForHref:t.shouldDecodeNewlines;d[p]={name:m[1],value:pe(h,f)}}l||(o.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:d}),i=n),t.start&&t.start(n,d,l,e.start,e.end)}function O(e,n,a){var r,s;if(null==n&&(n=c),null==a&&(a=c),e&&(s=e.toLowerCase()),e){for(r=o.length-1;r>=0;r--)if(o[r].lowerCasedTag===s)break}else r=0;if(r>=0){for(var l=o.length-1;l>=r;l--)(l>r||!e)&&t.warn&&t.warn("tag <"+o[l].tag+"> has no matching end tag."),t.end&&t.end(o[l].tag,n,a);o.length=r,i=r&&o[r-1].tag}else"br"===s?t.start&&t.start(e,[],!0,n,a):"p"===s&&(t.start&&t.start(e,[],!1,n,a),t.end&&t.end(e,n,a))}O()}var he=/\r?\n/g,fe=/./g;q("script,style,template",!0);function ge(e,t){void 0===t&&(t={});var n={script:[],style:[],config:[],window:[],docs:[],attachment:[],link:[],others:[]},i=0,o=null;function a(e,t,a,s,c){0===i&&(o={type:e,content:"",start:c,attrs:t.reduce(function(e,t){var n=t.name,i=t.value;return e[n]=i||!0,e},{})},n[e]?(r(o,t),n[e].push(o)):n.others.push(o)),a||i++}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];"lang"===i.name&&(e.lang=i.value),"scoped"===i.name&&(e.scoped=!0),"module"===i.name&&(e.module=i.value||!0),"src"===i.name&&(e.src=i.value)}}function s(n,a,r){if(1===i&&o){o.end=a;var s=L(e.slice(o.start,o.end));"template"!==o.type&&t.pad&&(s=c(o,t.pad)+s),o.content=s,o=null}i--}function c(t,n){if("space"===n)return e.slice(0,t.start).replace(fe," ");var i=e.slice(0,t.start).split(he).length,o="script"!==t.type||t.lang?"\n":"//\n";return Array(i).join(o)}return me(e,{start:a,end:s}),n}var _e=n("be94"),ve=n("783b"),we=n.n(ve),be=new we.a;be.addKeyword("instanceof",{compile:function(e){return function(t){if(Array.isArray(e)){var n=!1,i=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var c=r.value;if(t instanceof c){n=!0;break}}}catch(l){o=!0,a=l}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}return t instanceof e}}});var ye=["env","requirements","dependencies","icon","ui","type","flags","cover"],ke={"web-worker":{type:"internal",name:"Web Worker",lang:"javascript"},iframe:{type:"internal",name:"IFrame",lang:"javascript"},window:{type:"internal",name:"Window",lang:"javascript"},"web-python":{type:"internal",name:"Web Python",lang:"web-python",icon:"ð"},"web-python-window":{type:"internal",name:"Web Python (window)",lang:"web-python",icon:"ð"},collection:{type:"-",name:"Collection",lang:"",icon:""}};function xe(e){return ke[e]}function je(e){return Object(j["d"])(e.api_version,"<=","0.1.1")&&(e.type=e.type||e.mode,delete e.mode,"pyworker"===e.type?e.type="native-python":"webworker"===e.type?e.type="web-worker":"webpython"===e.type&&(e.type="web-python")),e}var Ce=be.compile({properties:{_id:{type:["null","string"]},name:{type:"string"},code:{type:"string"},lang:{type:["null","string"]},script:{type:["null","string"]}}}),Oe=(be.compile({properties:{type:{type:"string"},name:{type:"string"},lang:{type:"string"},icon:{type:["null","string"]},connection:{}}}),be.compile({properties:{name:{type:"string"},type:{type:"string"},init:{type:["null","string","array","object"]}}})),Pe=be.compile({properties:{name:{type:"string"},type:{type:"string"},config:{type:["null","object"]},data:{type:["null","number","string","array","object"]},panel:{type:["null","object"]}}}),Ee=be.compile({properties:{name:{type:"string"},type:{type:"string"},ui:{type:["null","string","array","object"]},run:{instanceof:Function},inputs:{type:["null","object"]},outputs:{type:["null","object"]}}}),De=be.compile({properties:{name:{type:"string"},type:{enum:["engine-factory"]},icon:{type:"string"},url:{type:"string"},config:{type:"object"},addEngine:{instanceof:Function},removeEngine:{instanceof:Function}}}),Re=be.compile({properties:{name:{type:"string"},type:{enum:["engine"]},pluginType:{type:"string"},factory:{type:"string"},icon:{type:"string"},url:{type:"string"},config:{type:"object"},connect:{instanceof:Function},disconnect:{instanceof:Function},listPlugins:{instanceof:Function},startPlugin:{instanceof:Function},getPlugin:{instanceof:Function},getEngineStatus:{instanceof:Function},getEngineConfig:{instanceof:[Function,null]},heartbeat:{instanceof:[Function,null]},killPlugin:{instanceof:[Function,null]},killPluginProcess:{instanceof:[Function,null]},restartPlugin:{instanceof:[Function,null]},about:{instanceof:[Function,null]}}}),Ie=be.compile({properties:{name:{type:"string"},type:{enum:["file-manager"]},url:{type:"string"},listFiles:{instanceof:Function},getFile:{instanceof:Function},putFile:{instanceof:Function},requestUploadUrl:{instanceof:Function},getFileUrl:{instanceof:Function},removeFile:{instanceof:Function},heartbeat:{instanceof:[Function,null]}}}),We={};"localhost"===location.hostname||"127.0.0.1"===location.hostname||location.hostname.startsWith("deploy-preview-")?We.asset_url="".concat(location.protocol,"//").concat(location.hostname).concat(location.port?":"+location.port:"","/static/jailed/"):We.asset_url="https://lib.imjoy.io/static/jailed/";var Me=!1,Se=function(e){return new Promise(function(t,n){if(e)for(var i in e)We[i]=e[i];We.asset_url.endsWith("/")||(We.asset_url=We.asset_url+"/");var o=document.createElement("script");o.src=We.asset_url+"_JailedSite.js";var a=function(){o.onload=null,o.onerror=null,o.onreadystatechange=null,o.parentNode.removeChild(o)},r=function(){a(),Me=!0,t()},s=function(){a(),n("Failed to load JailedSite script for jailed module.")};o.onerror=s,o.onload=r,o.onreadystatechange=function(){var e=o.readyState;"loaded"!==e&&"complete"!==e||r()},document.body.appendChild(o)})},Ae=function(e,t,n){var i=xe(t);if(!i)throw"Unsupported backend type (".concat(t,")");this._platformConnection=new $e(e,t,n),this._importCallbacks={},this._executeSCb=function(){},this._executeFCb=function(){},this._messageHandler=function(){};var o=this;this.whenInit=function(e){o._platformConnection.whenInit(e)},this.whenFailed=function(e){o._platformConnection.whenFailed(e)},this._platformConnection.onMessage(function(e){switch(e&&e.type){case"message":o._messageHandler(e.data);break;case"importSuccess":o._handleImportSuccess(e.url);break;case"importFailure":o._handleImportFailure(e.url,e.error);break;case"executeSuccess":o._executeSCb();break;case"executeFailure":o._executeFCb(e.error);break}})};Ae.prototype.hasDedicatedThread=function(){return this._platformConnection.dedicatedThread},Ae.prototype.importScript=function(e,t,n){var i=function(){};this._importCallbacks[e]={sCb:t||i,fCb:n||i},this._platformConnection.send({type:"import",url:e})},Ae.prototype.importJailedScript=function(e,t,n){var i=function(){};this._importCallbacks[e]={sCb:t||i,fCb:n||i},this._platformConnection.send({type:"importJailed",url:e})},Ae.prototype.execute=function(e){var t=this;return new Promise(function(n,i){t._executeSCb=n,t._executeFCb=i,t._platformConnection.send({type:"execute",code:e})})},Ae.prototype.onMessage=function(e){this._messageHandler=e},Ae.prototype.onDisconnect=function(e){this._platformConnection.onDisconnect(e)},Ae.prototype.send=function(e,t){this._platformConnection.send({type:"message",data:e},t)},Ae.prototype._handleImportSuccess=function(e){var t=this._importCallbacks[e].sCb;this._importCallbacks[e]=null,delete this._importCallbacks[e],t()},Ae.prototype._handleImportFailure=function(e,t){var n=this._importCallbacks[e].fCb;this._importCallbacks[e]=null,delete this._importCallbacks[e],n(t)},Ae.prototype.disconnect=function(){this._platformConnection&&this._platformConnection.disconnect()};var $e=function(){function e(t,n,i){Object(P["a"])(this,e),this._init=new j["a"],this._fail=new j["a"],this._disconnected=!1,this.id=t;var o=i.iframe_container,a=document.createElement("iframe");this._loggingHandler=function(){},a.src=We.asset_url+"_frame.html",a.sandbox="",a.frameBorder="0",a.style.width="100%",a.style.height="100%",a.style.margin="0",a.style.padding="0",a.style.display="none";var r=this;r._frame=a.cloneNode(!1);var s=["allow-scripts","allow-forms","allow-modals","allow-popups","allow-same-origin"],c="";i.permissions&&(i.permissions.includes("midi")&&!c.includes("midi *;")&&(c+="midi *;"),i.permissions.includes("geolocation")&&!c.includes("geolocation *;")&&(c+="geolocation *;"),i.permissions.includes("microphone")&&!c.includes("microphone *;")&&(c+="microphone *;"),i.permissions.includes("camera")&&!c.includes("camera *;")&&(c+="camera *;"),i.permissions.includes("encrypted-media")&&!c.includes("encrypted-media *;")&&(c+="encrypted-media *;"),i.permissions.includes("full-screen")&&(r._frame.allowfullscreen=""),i.permissions.includes("payment-request")&&(r._frame.allowpaymentrequest="")),r._frame.sandbox=s.join(" "),r._frame.allow=c,r._frame.src=r._frame.src+"?type="+n+"&name="+i.name+"&workspace="+i.workspace,r._frame.id="iframe_"+t,"iframe"==n||"window"==n||"web-python-window"==n?("string"==typeof o&&(o=document.getElementById(o)),o?(r._frame.style.display="block",o.appendChild(r._frame)):document.body.appendChild(r._frame)):document.body.appendChild(r._frame),window.addEventListener("message",function(e){e.source===r._frame.contentWindow&&("initialized"==e.data.type?(r.dedicatedThread=e.data.dedicatedThread,r._init.emit()):r._messageHandler(e.data))})}return Object(E["a"])(e,[{key:"whenInit",value:function(e){this._init.whenEmitted(e)}},{key:"whenFailed",value:function(e){this._fail.whenEmitted(e)}},{key:"send",value:function(e,t){this._frame.contentWindow&&this._frame.contentWindow.postMessage({type:"message",data:e},"*",t)}},{key:"onLogging",value:function(e){this._loggingHandler=e}},{key:"onMessage",value:function(e){this._messageHandler=e}},{key:"onDisconnect",value:function(){}},{key:"disconnect",value:function(){this._disconnected||(this._disconnected=!0,"undefined"!=typeof this._frame&&this._frame.parentNode.removeChild(this._frame))}}]),e}(),Ue=function(e,t,n,i,o){if(!Me)throw"Please call `initializeJailed()` before using Jailed.";this.config=e,this.id=e.id||Object(j["l"])(),this._id=e._id,this.name=e.name,this.type=e.type,this.tag=e.tag,this.tags=e.tags,this.type=e.type||"web-worker",this.initializing=!1,this.running=!1,this._log_history=[],this._callbacks=e._callbacks||{},this._is_proxy=i,this.backend=xe(this.type),this.engine=n,this.allow_evil=o,this._updateUI=t&&t.utils&&t.utils.$forceUpdate||function(){},i?this._disconnected=!1:(this._disconnected=!0,this._bindInterface(t),this._initialInterface.on||(this._initialInterface.on=this.on),this._initialInterface.off||(this._initialInterface.off=this.off),this._initialInterface.emit||(this._initialInterface.emit=this.emit),this._connect()),this._updateUI()};Ue.prototype._bindInterface=function(e){for(var t in e=e||{},this._initialInterface={__as_interface__:!0},e)if(e.hasOwnProperty(t))if("function"===typeof e[t])this._initialInterface[t]=e[t].bind(null,this);else if("object"===Object(l["a"])(e[t])){var n={};for(var i in e[t])e[t].hasOwnProperty(i)&&"function"===typeof e[t][i]&&(n[i]=e[t][i].bind(null,this));this._initialInterface[t]=n}else this._initialInterface[t]=e[t]},Ue.prototype._connect=function(){this.remote=null,this.api=null,this._connected=new j["a"],this._fail=new j["a"],this._disconnect=new j["a"];var e=this;if(this._fCb=function(t){if(e._fail.emit(t),e.disconnect(),e.initializing=!1,t&&e.error(t.toString()),"window"===e.config.type&&e.config.iframe_container){var n=document.getElementById(e.config.iframe_container);n.innerHTML="<h5>Oops! failed to load the window.</h5><code>Details: ".concat(O.a.sanitize(String(t)),"</code>")}e._updateUI()},e.backend)e._connection=new Ae(e.id,e.type,e.config),e.initializing=!0,e._updateUI(),e._connection.whenInit(function(){e._init()}),e._connection.whenFailed(function(t){e._fail.emit(t)}),e._connection.onDisconnect(function(t){if(t&&(t.success?e.log(t.message):e.error(t.message)),e._connection._platformConnection._frame){var n=document.getElementById(e._connection._platformConnection._frame.id);n.parentNode.removeChild(n)}e._set_disconnected()});else{if(e.engine&&e.engine._is_evil&&"eval is evil"!==e.allow_evil)return e._fail.emit("Evil engine is not allowed."),e._connection=null,e.error("Evil engine is not allowed."),void e._set_disconnected();if(!e.engine||!e.engine.connected)return e._fail.emit("Please connect to the Plugin Engine ð."),e._connection=null,e.error("Please connect to the Plugin Engine ð."),void e._set_disconnected();e.initializing=!0,e._updateUI(),e.engine.startPlugin(Object(_e["a"])({},e.config,{terminate:function(){e.terminate()}}),e._initialInterface).then(function(t){if(!e.engine)return console.warn("Plugin "+e.id+" is ready, but it was termianted."),void(e.engine&&e.engine.killPlugin&&e.engine.killPlugin({id:e.config.id,name:e.config.name}));e.remote=t,e.api=e.remote,e.api.__as_interface__=!0,e.api.__id__=e.id,e._disconnected=!1,e.initializing=!1,e._updateUI(),e._connected.emit(),e.engine.registerPlugin(e)}).catch(function(t){e.error(t),e._set_disconnected()})}},Ue.prototype._init=function(){var e=this.backend.lang;this._site=new JailedSite(this._connection,this.id,e);var t=this;this._site.onDisconnect(function(e){t._disconnect.emit(),e&&(e.success?t.log(e.message):t.error(e.message)),t._set_disconnected()}),this._site.onRemoteReady(function(){t.running&&(t.running=!1,t._updateUI())}),this._site.onRemoteBusy(function(){t._disconnected||t.running||(t.running=!0,t._updateUI())}),this.getRemoteCallStack=this._site.getRemoteCallStack;var n=function(){t._loadCore()};this._connection.importScript(We.asset_url+"_JailedSite.js",n,this._fCb)},Ue.prototype._loadCore=function(){var e=this,t=function(){e._sendInterface()};this._connection.importScript(We.asset_url+"_pluginCore.js",t,this._fCb)},Ue.prototype._sendInterface=function(){var e=this;this._site.onInterfaceSetAsRemote(function(){e._disconnected&&e._loadPlugin()}),this._site.setInterface(this._initialInterface)},Ue.prototype._loadPlugin=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.config.requirements){e.next=4;break}return e.next=4,this._connection.execute({type:"requirements",lang:this.config.lang,requirements:this.config.requirements,env:this.config.env});case 4:if("iframe"!==this.config.type&&"window"!==this.config.type&&"web-python-window"!==this.config.type){e.next=26;break}t=0;case 6:if(!(t<this.config.styles.length)){e.next=12;break}return e.next=9,this._connection.execute({type:"style",content:this.config.styles[t].content,attrs:this.config.styles[t].attrs,src:this.config.styles[t].attrs.src});case 9:t++,e.next=6;break;case 12:n=0;case 13:if(!(n<this.config.links.length)){e.next=19;break}return e.next=16,this._connection.execute({type:"link",rel:this.config.links[n].attrs.rel,type_:this.config.links[n].attrs.type,attrs:this.config.links[n].attrs,href:this.config.links[n].attrs.href});case 16:n++,e.next=13;break;case 19:i=0;case 20:if(!(i<this.config.windows.length)){e.next=26;break}return e.next=23,this._connection.execute({type:"html",content:this.config.windows[i].content,attrs:this.config.windows[i].attrs});case 23:i++,e.next=20;break;case 26:o=0;case 27:if(!(o<this.config.scripts.length)){e.next=33;break}return e.next=30,this._connection.execute({type:"script",content:this.config.scripts[o].content,lang:this.config.scripts[o].attrs.lang,attrs:this.config.scripts[o].attrs,src:this.config.scripts[o].attrs.src});case 30:o++,e.next=27;break;case 33:this._requestRemote(),e.next=39;break;case 36:e.prev=36,e.t0=e["catch"](0),this._fCb(e.t0&&e.t0.toString()||"Error");case 39:case"end":return e.stop()}},e,this,[[0,36]])})),Ue.prototype._requestRemote=function(){var e=this;this._site.onRemoteUpdate(function(){e.remote=e._site.getRemote(),e.api=e.remote,e.api.__as_interface__=!0,e.api.__id__=e.id,e._disconnected=!1,e.initializing=!1,e._updateUI(),e._connected.emit()}),this._site.requestRemote()},Ue.prototype.hasDedicatedThread=function(){return this._connection.hasDedicatedThread()},Ue.prototype.disconnect=function(){this._connection&&this._connection.disconnect(),this._disconnect.emit()},Ue.prototype.whenFailed=function(e){this._fail.whenEmitted(e)},Ue.prototype.whenConnected=function(e){this._connected.whenEmitted(e)},Ue.prototype.whenDisconnected=function(e){this._disconnect.whenEmitted(e)},Ue.prototype._set_disconnected=function(){this._disconnected=!0,this.running=!1,this.initializing=!1,this.terminating=!1,this.engine=null,this._updateUI()},Ue.prototype.terminate=function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this._disconnected){e.next=3;break}return this._set_disconnected(),e.abrupt("return");case 3:if(n=function(){i.engine&&i.engine.killPlugin&&i.engine.killPlugin({id:i.config.id,name:i.config.name}),i._set_disconnected(),i._site&&(i._site.disconnect(),i._site=null),i._connection&&(i._connection.disconnect(),i._connection=null)},!this.terminating){e.next=8;break}return e.abrupt("return");case 8:this.terminating=!0,setTimeout(function(){console.warn("Plugin termination takes more than 5s, force quiting ".concat(i.id,"!")),i.terminating&&n()},5e3);case 10:return e.prev=10,e.next=13,this.emit("close");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](10),console.error(e.t0);case 18:if(t&&n(),e.prev=19,!this.api||!this.api.exit||"function"!=typeof this.api.exit){e.next=23;break}return e.next=23,this.api.exit();case 23:e.next=28;break;case 25:e.prev=25,e.t1=e["catch"](19),console.error("error occured when terminating the plugin",e.t1);case 28:return e.prev=28,n(),e.finish(28);case 31:case"end":return e.stop()}},e,this,[[10,15],[19,25,28,31]])}));return function(t){return e.apply(this,arguments)}}(),Ue.prototype.on=function(e,t,n){this._callbacks=this._callbacks||{},this._callbacks[e]?this._callbacks[e].push(t):this._callbacks[e]=[t],n&&this._callbacks[e].emitted&&t(this._callbacks[e].emitted_data)},Ue.prototype.off=function(e,t){if(this._callbacks[e])if(t){var n=this._callbacks[e],i=n.indexOf(t);i>=0?n.splice(i,1):console.warn("callback ".concat(e," does not exist."))}else delete this._callbacks[e];else console.warn("callback ".concat(e," does not exist."))},Ue.prototype.emit=function(e,t){var n=this;return new Promise(function(){var i=Object(c["a"])(regeneratorRuntime.mark(function i(o,a){var r,s,c,l,u,d,p;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(r=[],i.prev=1,!n._callbacks[e]){i.next=38;break}s=!0,c=!1,l=void 0,i.prev=6,u=n._callbacks[e][Symbol.iterator]();case 8:if(s=(d=u.next()).done){i.next=22;break}return p=d.value,i.prev=10,i.next=13,p(void 0!==t?t:void 0);case 13:i.next=19;break;case 15:i.prev=15,i.t0=i["catch"](10),r.push(i.t0),console.error(i.t0);case 19:s=!0,i.next=8;break;case 22:i.next=28;break;case 24:i.prev=24,i.t1=i["catch"](6),c=!0,l=i.t1;case 28:i.prev=28,i.prev=29,s||null==u.return||u.return();case 31:if(i.prev=31,!c){i.next=34;break}throw l;case 34:return i.finish(31);case 35:return i.finish(28);case 36:i.next=41;break;case 38:n._callbacks[e]=[],n._callbacks[e].emitted=!0,n._callbacks[e].emitted_data=t;case 41:r.length<=0?o():a(r),i.next=47;break;case 44:i.prev=44,i.t2=i["catch"](1),a(i.t2);case 47:case"end":return i.stop()}},i,this,[[1,44],[6,24,28,36],[10,15],[29,,31,35]])}));return function(e,t){return i.apply(this,arguments)}}())},Ue.prototype.log=function(e){if("object"===Object(l["a"])(e))this._log_history.push(e),console.log("Plugin ".concat(this.id,":"),e);else{var t=Array.prototype.slice.call(arguments).join(" ");this._log_history._info=t.slice(0,100),this._log_history.push({type:"info",value:t}),console.log("Plugin ".concat(this.id,": ").concat(t))}},Ue.prototype.error=function(){var e=Array.prototype.slice.call(arguments).join(" ");this._log_history._error=e.slice(0,100),this._log_history.push({type:"error",value:e}),console.error("Error in Plugin ".concat(this.id,": ").concat(e))},Ue.prototype.progress=function(e){this._progress=e<1?100*e:e};var Te=n("733d"),Fe=n("65d2"),Le=new we.a,Ne=function(){function e(t){var n=this,i=t.event_bus,o=void 0===i?null:i,a=t.config_db,r=void 0===a?null:a,s=t.engine_manager,d=void 0===s?null:s,p=t.window_manager,m=void 0===p?null:p,h=t.file_manager,f=void 0===h?null:h,g=t.imjoy_api,_=void 0===g?{}:g,v=t.show_message_callback,w=void 0===v?null:v,b=t.update_ui_callback,y=void 0===b?null:b,k=t.jailed_asset_url,x=void 0===k?null:k;Object(P["a"])(this,e),this.event_bus=o,this.em=d,this.wm=m,this.fm=f,this.config_db=r,Object(j["c"])(this.event_bus,"event bus is not available"),Object(j["c"])(this.em,"engine manager is not available"),Object(j["c"])(this.wm,"window manager is not available"),Object(j["c"])(this.config_db,"config database is not available"),this.jailed_asset_url=x,this.show_message_callback=w,this.update_ui_callback=y||function(){},this._allowed_evil_plugin={},this.internal_plugins=Te,this.default_repository_list=[{name:"ImJoy Repository",url:"imjoy-team/imjoy-plugins",description:"The official plugin repository provided by ImJoy.io."},{name:"ImJoy Demos",url:"imjoy-team/imjoy-demo-plugins",description:"A set of demo plugins provided by ImJoy.io"}],this.IMJOY_PLUGIN={_id:"IMJOY_APP"},this.repository_list=[],this.repository_names=[],this.available_plugins=[],this.installed_plugins=[],this.workspace_list=[],this.selected_workspace=null,this.selected_repository=null,this.workflow_list=[],this.db=null;var C=_.utils;for(var O in this.imjoy_api={alert:function(e,t){return window.alert(t.content||t)},prompt:function(e,t){return window.prompt(t.content||t)},confirm:function(e,t){return window.confirm(t.content||t)},requestUploadUrl:this.requestUploadUrl,getFileUrl:this.getFileUrl,getFilePath:this.getFilePath,log:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];e.log.apply(e,i),n.update_ui_callback()},error:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];e.error.apply(e,i),n.update_ui_callback()},progress:function(e,t){e.progress(t),n.update_ui_callback()},exportFile:function(e,t,n){"string"===typeof t&&(t=new Blob([t],{type:"text/plain;charset=utf-8"})),Object(u["saveAs"])(t,n||t._name||"file_export")},showDialog:function(){throw"`api.showDialog` is not implemented."},showFileDialog:function(){throw"`api.showDialog` is not implemented."},showProgress:function(e,t){console.log("api.showProgress: ",t)},showStatus:function(e,t){console.log("api.showStatus: ",t)},showSnackbar:function(e,t,n){console.log("api.showSnackbar: ",t,n)},showMessage:function(e,t,n){console.log("api.showMessage: ",t,n)},register:this.register,unregister:this.unregister,createWindow:this.createWindow,run:this.runPlugin,call:this.callPlugin,getPlugin:this.getPlugin,getFileManager:this.getFileManager,getEngineFactory:this.getEngineFactory,getEngine:this.getEngine,setConfig:this.setPluginConfig,getConfig:this.getPluginConfig,getAttachment:this.getAttachment,onClose:function(e,t){console.warn('`api.onClose` is deprecated, please use `api.on("close", ...)` instead.'),e.on("close",t)},utils:{}},this.imjoy_api)if("function"===typeof this.imjoy_api[O])this.imjoy_api[O]=this.imjoy_api[O].bind(this);else if("object"===Object(l["a"])(this.imjoy_api[O]))for(var E in this.imjoy_api[O])this.imjoy_api[O][E]=this.imjoy_api[O][E].bind(this);if(this.imjoy_api=S.a.assign({},this.imjoy_api,_),C)for(var D in C)this.imjoy_api.utils[D]=C[D];window.api=this.imjoy_api,this.event_bus.on("engine_connected",function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(n.plugins);case 1:if((e.t1=e.t0()).done){e.next=22;break}if(i=e.t1.value,!n.plugins.hasOwnProperty(i)){e.next=20;break}if(o=n.plugins[i],e.prev=5,o.engine!==t){e.next=9;break}return e.next=9,n.reloadPlugin(o);case 9:if("auto"!==o.config.engine_mode||!o._disconnected&&!o.terminating){e.next=12;break}return e.next=12,n.reloadPlugin(o);case 12:if(o.config.engine_mode!==t.name){e.next=15;break}return e.next=15,n.reloadPlugin(o);case 15:e.next=20;break;case 17:e.prev=17,e.t2=e["catch"](5),n.showMessage(e.t2);case 20:e.next=1;break;case 22:case"end":return e.stop()}},e,this,[[5,17]])}));return function(t){return e.apply(this,arguments)}}()),this.event_bus.on("engine_disconnected",function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(i in n.plugins)n.plugins.hasOwnProperty(i)&&(o=n.plugins[i],o.engine===t&&n.unloadPlugin(o));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())}return Object(E["a"])(e,[{key:"getFileUrl",value:function(e,t){if(console.warn("`api.getFileUrl` is deprecated, please use `api.getFileManager` (https://imjoy.io/docs/#/api?id=apigetfilemanager) and access `getFileUrl` from the file manager."),"object"!==Object(l["a"])(t)||!t.path)throw"You must pass an object contains keys named `path` and `engine`";if(e=e||this.IMJOY_PLUGIN,t.engine&&(console.warn("The `engine` option for `api.getFileUrl` is deprecated, please use `file_manager` instead of `engine`."),t.file_manager=t.engine,delete t.engine),!t.file_manager)throw"Please specify a file manager via the `file_manager` option.";var n=this.fm.getFileManagerByUrl(t.file_manager);if(!n)throw"File manager ".concat(t.file_manager," not found");if(!n.connected)throw this.showMessage("File manager (".concat(n.url,") is not connected.")),"File manager (".concat(n.url,") is not connected.");return n.getFileUrl(t)}},{key:"requestUploadUrl",value:function(e,t){if(console.warn("`api.requestUploadUrl` is deprecated, please use `api.getFileManager` (https://imjoy.io/docs/#/api?id=apigetfilemanager) and access `requestUploadUrl` from the file manager."),"object"!==Object(l["a"])(t))throw"You must pass an object contains keys named `engine` and `path` (or `dir`, optionally `overwrite`)";if(e=e||this.IMJOY_PLUGIN,t.engine&&(console.warn("The `engine` option for `api.requestUploadUrl` is deprecated, please use `file_manager` instead of `engine`."),t.file_manager=t.engine,delete t.engine),!t.file_manager)throw"Please specify a file manager via the `file_manager` option.";var n=this.fm.getFileManagerByUrl(t.file_manager);if(!n)throw"File manager ".concat(t.file_manager," not found");if(!n.connected)throw this.showMessage("File manager (".concat(n.url,") is not connected.")),"File manager (".concat(n.url,") is not connected.");return n.requestUploadUrl({path:t.path,overwrite:t.overwrite,dir:t.dir})}},{key:"showMessage",value:function(e,t){this.show_message_callback?this.show_message_callback(e,t):console.log("PLUGIN MESSAGE: ".concat(e))}},{key:"init",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={},this.jailed_asset_url&&(t.asset_url=this.jailed_asset_url),e.next=4,Se(t);case 4:this.plugins={},this.plugin_names={},this.registered={ops:{},windows:{},extensions:{},internal_inputs:{},inputs:{},outputs:{},loaders:{},engines:{},engine_factories:{},file_managers:{}};case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadRepositoryList",value:function(){var e=this;return new Promise(function(t,n){e.config_db.get("repository_list").then(function(n){e.repository_list=n.list;var i=!0,o=!1,a=void 0;try{for(var r,s=e.default_repository_list[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var c=r.value,l=!1,u=!0,d=!1,p=void 0;try{for(var m,h=e.repository_list[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var f=m.value;if(f.url===c.url&&f.name===c.name){l=f;break}}}catch(k){d=!0,p=k}finally{try{u||null==h.return||h.return()}finally{if(d)throw p}}l||e.addRepository(c)}}catch(k){o=!0,a=k}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}e.repository_names=[];var g=!0,_=!1,v=void 0;try{for(var w,b=e.repository_list[Symbol.iterator]();!(g=(w=b.next()).done);g=!0){var y=w.value;e.repository_names.push(y.name)}}catch(k){_=!0,v=k}finally{try{g||null==b.return||b.return()}finally{if(_)throw v}}t(e.repository_list)}).catch(function(i){"not_found"!=i.name?console.error("Database Error",i):console.log("Failed to load repository list",i),e.repository_list=e.default_repository_list,e.repository_names=[];var o=!0,a=!1,r=void 0;try{for(var s,c=e.repository_list[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;e.repository_names.push(l.name)}}catch(i){a=!0,r=i}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}e.config_db.put({_id:"repository_list",list:e.repository_list},{force:!0}).then(function(){t(e.repository_list)}).catch(function(){n("Failed to load the repository list or save the default repositories.")}),e.saveRepositoryList().then(function(){t(e.repository_list)}).catch(n)})})}},{key:"saveRepositoryList",value:function(){var e=this;return new Promise(function(t,n){var i=null;e.config_db.get("repository_list").then(function(e){i=e._rev}).finally(function(){e.config_db.put({_id:"repository_list",_rev:i||void 0,list:e.repository_list},{force:!0}).then(function(){t(e.repository_list)}).catch(function(t){e.showMessage("Failed to save repository, database Error:"+t.toString()),n("Failed to save repository, database Error:"+t.toString())})})})}},{key:"addRepository",value:function(e){var t=this;return new Promise(function(n,i){"string"===typeof e&&(e={name:e,url:e,description:e}),e.name&&e.url?t.reloadRepository(e).then(function(o){e.name=o.name||e.name,e.description=o.description||e.description;var a=e.url&&e.url.replace("https://github.com/","").replace("http://github.com/",""),r=!0,s=!1,c=void 0;try{for(var l,u=t.repository_list[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var d=l.value;d.url&&d.url.replace("https://github.com/","").replace("http://github.com/","")===a&&(t.repository_list.splice(t.repository_list.indexOf(d),1),t.showMessage("Repository with the same url already exists."))}}catch(j){s=!0,c=j}finally{try{r||null==u.return||u.return()}finally{if(s)throw c}}var p=!0,m=!1,h=void 0;try{for(var f,g=t.repository_list[Symbol.iterator]();!(p=(f=g.next()).done);p=!0){var _=f.value;if(_.name===e.name){e.name=a;break}}}catch(j){m=!0,h=j}finally{try{p||null==g.return||g.return()}finally{if(m)throw h}}if(e.name&&e.url){t.repository_list.push(e),t.repository_names=[];var v=!0,w=!1,b=void 0;try{for(var y,k=t.repository_list[Symbol.iterator]();!(v=(y=k.next()).done);v=!0){var x=y.value;t.repository_names.push(x.name)}}catch(j){w=!0,b=j}finally{try{v||null==k.return||k.return()}finally{if(w)throw b}}t.saveRepositoryList().then(function(){n(e)}).catch(i)}else i("You need to provide name and url")}).catch(function(){t.repository_names.indexOf(e.name)>=0&&t.repository_names.splice(t.repository_names.indexOf(e.name),1),t.showMessage("Failed to load repository from: "+e.url),i("Failed to load repository from: "+e.url)}):i("You need to provide name and url")})}},{key:"removeRepository",value:function(e){var t=this;return new Promise(function(n,i){if(e&&e.name&&e.url){var o=!1,a=!0,r=!1,s=void 0;try{for(var c,l=t.repository_list[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;u.url!==e.url&&u.name!==e.name||(o=u)}}catch(v){r=!0,s=v}finally{try{a||null==l.return||l.return()}finally{if(r)throw s}}if(o){var d=t.repository_list.indexOf(o);t.repository_list.splice(d,1),t.repository_names=[];var p=!0,m=!1,h=void 0;try{for(var f,g=t.repository_list[Symbol.iterator]();!(p=(f=g.next()).done);p=!0){var _=f.value;t.repository_names.push(_.name)}}catch(v){m=!0,h=v}finally{try{p||null==g.return||g.return()}finally{if(m)throw h}}t.saveRepositoryList().then(function(){t.showMessage("Repository has been deleted."),n()}).catch(function(){t.showMessage("Error occured when removing repository."),i("Error occured when removing repository.")})}else i("Repository not found: "+e.name)}else i("You need to provide name and url")})}},{key:"reloadRepository",value:function(e){var t=this;return e=e||this.selected_repository,new Promise(function(n,i){t.getRepoManifest(e.url).then(function(i){t.available_plugins=i.plugins;for(var o=function(e){var n=t.available_plugins[e],i=t.installed_plugins.filter(function(e){return n.name===e.name});i.length>0&&(n.installed=!0,n.tag=i[0].tag)},a=0;a<t.available_plugins.length;a++)o(a);t.selected_repository=e,n(i)}).catch(i)})}},{key:"loadWorkspaceList",value:function(){var e=this;return new Promise(function(t,n){e.config_db.get("workspace_list").then(function(n){e.workspace_list=n.list,e.selected_workspace=e.workspace_list[0],t(e.workspace_list)}).catch(function(i){"not_found"!=i.name&&console.error("Database Error",i),e.workspace_list=["default"],e.config_db.put({_id:"workspace_list",list:e.workspace_list}).then(function(){e.selected_workspace=e.workspace_list[0],t(e.workspace_list)}).catch(function(){n("Failed to load Plugin Engine list, database Error:"+i.toString())})})})}},{key:"loadWorkspace",value:function(e){var t=this;return new Promise(function(n,i){e=e||t.selected_workspace;var o=function(){try{t.event_bus.emit("workspace_list_updated",t.workspace_list),t.db=new R["a"](e+"_workspace",{revs_limit:2,auto_compaction:!0}),t.selected_workspace=e,n()}catch(o){i(o)}};t.workspace_list.includes(e)?o():(t.workspace_list.includes(e)||t.workspace_list.push(e),t.saveWorkspaceList().then(function(){o()}).catch(i))})}},{key:"saveWorkspaceList",value:function(){var e=this;return new Promise(function(t,n){e.config_db.get("workspace_list").then(function(i){e.config_db.put({_id:i._id,_rev:i._rev,list:e.workspace_list,default:"default"}).then(t).catch(function(e){n("Failed to save workspace, database Error: ".concat(e.toString()))})}).catch(function(e){n("Failed to save workspaces, database Error: ".concat(e.toString()))})})}},{key:"removeWorkspace",value:function(e){var t=this;return new Promise(function(n,i){if(t.workspace_list.includes(e)){var o=t.workspace_list.indexOf(e);t.workspace_list.splice(o,1),t.saveWorkspaceList().then(function(){n(),t.selected_workspace===e.name&&(t.selected_workspace=null)}).catch(i)}})}},{key:"saveWorkflow",value:function(e){var t=this,n=prompt("Please enter a name for the workflow","default");if(n){var i={};i.name=n,i._id=n+"_workflow",i.workflow=JSON.stringify(e.top.data),this.db.get(i._id).then(function(e){i._rev=e._rev}).finally(function(){t.db.put(i).then(function(){t.workflow_list.push(i),t.showMessage('Workflow "'.concat(n,'" has been successfully saved.'))}).catch(function(e){t.showMessage("Failed to save the workflow."),console.error(e)})})}}},{key:"removeWorkflow",value:function(e){var t=this;this.db.get(e._id).then(function(e){return t.db.remove(e)}).then(function(){var n=t.workflow_list.indexOf(e);n>-1&&t.workflow_list.splice(n,1),t.showMessage('Workflow "'.concat(e.name,'" has been successfully removed.'))}).catch(function(e){t.showMessage("Failed to remove the workflow."),console.error(e)})}},{key:"reloadDB",value:function(){var e=this;return new Promise(function(t,n){try{if(e.db)try{e.db.close().finally(function(){e.db=new R["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")})}catch(i){console.error("Failed to reload database: ",i),e.db=new R["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")}else e.db=new R["a"](e.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e.db?t():n("Failed to reload database.")}catch(i){console.error("Failed to reload database."),n("Failed to reload database.")}})}},{key:"setInputLoaders",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;this.wm.registerInputLoader(r.loader_key,r,r.loader)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}}},{key:"reloadPlugins",value:function(){var e=this;return new Promise(function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(n,i){var o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e.plugins)for(o in e.plugins)if(e.plugins.hasOwnProperty(o)){if(a=e.plugins[o],"function"===typeof a.terminate)try{a.terminate().then(function(){e.update_ui_callback()})}catch(r){console.error(r)}e.plugins[o]=null,e.plugin_names[a.name]=null}return t.next=3,e.init();case 3:e.reloadDB().then(function(){e.db.allDocs({include_docs:!0,attachments:!0,sort:"name"}).then(function(t){e.workflow_list=[],e.installed_plugins=[];for(var i=function(n){var i=t.rows[n].doc;if(i.workflow)e.workflow_list.push(i);else{if(i.hash&&W.a.hash(i.code)!==i.hash)return console.error("Plugin source code signature mismatch, skip loading plugin",i),"continue";i.installed=!0,e.installed_plugins.push(i),e.reloadPlugin(i).catch(function(t){console.error(i,t),e.showMessage("<".concat(i.name,">: ").concat(t))})}},o=0;o<t.total_rows;o++)i(o);e.reloadInternalPlugins(!0),n()}).catch(function(e){console.error(e),i()})});case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"reloadInternalPlugins",value:function(e){var t=this,n=function(n){if(t.internal_plugins[n].startup){if(e&&t.plugin_names[n])return"continue";console.log('Loading internal plugin "'.concat(n,'"...')),t.reloadPluginRecursively({uri:t.internal_plugins[n].uri},null,"eval is evil").then(function(){console.log("".concat(n," plugin loaded."))}).catch(function(e){console.error(e)})}};for(var i in this.internal_plugins)n(i)}},{key:"getPluginFromUrl",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o,a,r,s,c,l,u,d,m,h,f,g,_,v,w,b,y,k;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=n||this.available_plugins,!(t.includes("github.com")&&t.includes("/blob/")||t.includes("gist.github.com"))){e.next=5;break}return e.next=4,Object(j["i"])(t);case 4:t=e.sent;case 5:if(t.startsWith("http")||!t.includes("/")||!t.includes(":")){e.next=51;break}return o=t.split(":"),a=Object(D["a"])(o,2),r=a[0],s=a[1],i=s.split("@")[1],s=s.split("@")[0],s=s.trim(),c=r.split("@")[1],r=r.split("@")[0],r=r.trim(),Object(j["c"])(r&&s,'Wrong URI format, it must be "REPO_NAME:PLUGIN_NAME"'),e.next=16,this.getRepoManifest(r,c);case 16:l=e.sent,u=null,d=!0,m=!1,h=void 0,e.prev=21,f=l.plugins[Symbol.iterator]();case 23:if(d=(g=f.next()).done){e.next=31;break}if(_=g.value,_.name!==s){e.next=28;break}return u=_,e.abrupt("break",31);case 28:d=!0,e.next=23;break;case 31:e.next=37;break;case 33:e.prev=33,e.t0=e["catch"](21),m=!0,h=e.t0;case 37:e.prev=37,e.prev=38,d||null==f.return||f.return();case 40:if(e.prev=40,!m){e.next=43;break}throw h;case 43:return e.finish(40);case 44:return e.finish(37);case 45:if(u){e.next=47;break}throw"plugin not found ".concat(r,":").concat(s);case 47:t=u.uri,n=l.plugins,e.next=64;break;case 51:if(t.match(j["m"])){e.next=62;break}if(v=t.split("@"),i=v[1],w=n.filter(function(e){return v[0]&&e.name===v[0].trim()}),!(w.length<=0)){e.next=59;break}throw'Plugin "'.concat(v[0],'" cannot be found in the repository.');case 59:t=w[0].uri;case 60:e.next=64;break;case 62:i=t.split(".imjoy.html@")[1],i&&(t=t.split("@"+i)[0]);case 64:if(t.split("?")[0].endsWith(".imjoy.html")){e.next=66;break}throw'Plugin url must be ends with ".imjoy.html"';case 66:return-1===t.indexOf("?")&&(t=t+"?"+Object(j["l"])()),e.next=69,p.a.get(t);case 69:if(b=e.sent,b&&b.data&&""!==b.data){e.next=73;break}throw alert("failed to get plugin code from "+t),"failed to get code.";case 73:return y=b.data,k=this.parsePluginCode(y,{tag:i,origin:t,uri:t}),k.scoped_plugins=n,e.abrupt("return",k);case 77:case"end":return e.stop()}},e,this,[[21,33,37,45],[38,,40,44]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"reloadPluginRecursively",value:function(e,t,n){var i=this;return new Promise(function(o,a){var r="string"===typeof e?e:e.uri,s=i.available_plugins;e.scoped_plugins&&(s=e.scoped_plugins,delete e.scoped_plugins),r?i.getPluginFromUrl(r,s).then(function(){var l=Object(c["a"])(regeneratorRuntime.mark(function c(l){var u,d,p;return regeneratorRuntime.wrap(function(c){while(1)switch(c.prev=c.next){case 0:if(l.engine_mode&&(u=i.plugin_names[l.name],u&&(l.engine_mode=u.config.engine_mode)),l.origin=e.origin||r,l){c.next=6;break}return console.error('Failed to fetch the plugin from "'.concat(r,'".')),a('Failed to fetch the plugin from "'.concat(r,'".')),c.abrupt("return");case 6:xe(l.type)||console.warn("Installed plugin ".concat(l.name," with unsupported plugin type: ").concat(l.type)),l.tag=t||i.plugin_names[l.name]&&i.plugin_names[l.name].config.tag||l.tag,l.tag&&(d=l.origin.split(":"),d[1]&&d[1].split("@")[1]&&(l.origin=d[0]+":"+d[1].split("@")[0])),l._id=l.name&&l.name.replace(/ /g,"_")||Object(j["l"])(),l.dependencies=l.dependencies||[],c.prev=11,p=0;case 13:if(!(p<l.dependencies.length)){c.next=19;break}return c.next=16,i.reloadPluginRecursively({uri:l.dependencies[p],scoped_plugins:l.scoped_plugins||s},null,n);case 16:p++,c.next=13;break;case 19:i.reloadPlugin(l,n).then(function(e){o(e)}).catch(a),c.next=25;break;case 22:c.prev=22,c.t0=c["catch"](11),a("Failed to load dependencies for ".concat(l.name,": ").concat(c.t0));case 25:case"end":return c.stop()}},c,this,[[11,22]])}));return function(e){return l.apply(this,arguments)}}()).catch(function(e){console.error(e),i.showMessage("Failed to download, if you download from github, please use the url to the raw file",10),a(e)}):a("No url found for plugin "+e.name)})}},{key:"installPlugin",value:function(e,t,n){var i=this;return new Promise(function(o,a){var r="string"===typeof e?e:e.uri,s=i.available_plugins;e.scoped_plugins&&(s=e.scoped_plugins,delete e.scoped_plugins),r?i.getPluginFromUrl(r,s).then(function(){var l=Object(c["a"])(regeneratorRuntime.mark(function c(l){var u,d,p,m,h,f,g,_,v,w;return regeneratorRuntime.wrap(function(c){while(1)switch(c.prev=c.next){case 0:if(l.engine_mode&&(u=i.plugin_names[l.name],u&&(l.engine_mode=u.config.engine_mode)),l.origin=e.origin||r,l){c.next=6;break}return console.error('Failed to fetch the plugin from "'.concat(r,'".')),a('Failed to fetch the plugin from "'.concat(r,'".')),c.abrupt("return");case 6:xe(l.type)||console.warn("Installed plugin ".concat(l.name," with unsupported plugin type: ").concat(l.type)),l.tag=t||i.plugin_names[l.name]&&i.plugin_names[l.name].config.tag||l.tag,l.tag&&(d=l.origin.split(":"),d[1]&&d[1].split("@")[1]&&(l.origin=d[0]+":"+d[1].split("@")[0])),l._id=l.name&&l.name.replace(/ /g,"_")||Object(j["l"])(),l.dependencies=l.dependencies||[],c.prev=11,p=0;case 13:if(!(p<l.dependencies.length)){c.next=19;break}return c.next=16,i.installPlugin({uri:l.dependencies[p],scoped_plugins:l.scoped_plugins||s},null,n);case 16:p++,c.next=13;break;case 19:return c.next=21,i.savePlugin(l);case 21:for(m=c.sent,h=!0,f=!1,g=void 0,c.prev=25,_=i.available_plugins[Symbol.iterator]();!(h=(v=_.next()).done);h=!0)w=v.value,w.name!==m.name||w.installed||(w.installed=!0,w.tag=t);c.next=33;break;case 29:c.prev=29,c.t0=c["catch"](25),f=!0,g=c.t0;case 33:c.prev=33,c.prev=34,h||null==_.return||_.return();case 36:if(c.prev=36,!f){c.next=39;break}throw g;case 39:return c.finish(36);case 40:return c.finish(33);case 41:i.showMessage('Plugin "'.concat(m.name,'" has been successfully installed.')),i.event_bus.emit("plugin_installed",m),o(m),n||i.reloadPlugin(m),c.next=50;break;case 47:c.prev=47,c.t1=c["catch"](11),a("Failed to install dependencies for ".concat(l.name,": ").concat(c.t1));case 50:case"end":return c.stop()}},c,this,[[11,47],[25,29,33,41],[34,,36,40]])}));return function(e){return l.apply(this,arguments)}}()).catch(function(e){console.error(e),i.showMessage("Failed to download, if you download from github, please use the url to the raw file",10),a(e)}):a("No url found for plugin "+e.name)})}},{key:"removePlugin",value:function(e){var t=this;return new Promise(function(n,i){t.db.get(e._id).then(function(o){t.db.remove(o).then(function(){for(var i=0;i<t.installed_plugins.length;i++)t.installed_plugins[i].name===e.name&&t.installed_plugins.splice(i,1);var o=!0,a=!1,r=void 0;try{for(var s,c=t.available_plugins[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;l.name===e.name&&(l.installed=!1,l.tag=null)}}catch(u){a=!0,r=u}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}n(),t.showMessage('"'.concat(e.name,'" has been removed.')),t.unloadPlugin(e,!0)}).catch(function(n){t.showMessage(n.toString()),console.error("Failed to remove plugin: ",e,n),i(n)})}).catch(function(i){t.unloadPlugin(e,!0),t.showMessage('"'.concat(e.name,'" has been unloaded.')),console.log("Plugin does not exist in the database",e,i),n(i)})})}},{key:"getPluginDocs",value:function(e){var t=this;return new Promise(function(n,i){t.db.get(e).then(function(e){var t=ge(e.code),i=t.docs&&t.docs[0]&&t.docs[0].content;n(i)}).catch(function(e){i(e)})})}},{key:"getPluginSource",value:function(e){var t=this;return new Promise(function(n,i){t.db.get(e).then(function(e){n(e.code)}).catch(function(e){i(e)})})}},{key:"unloadPlugin",value:function(e,t){var n=this,i=e.name;for(var o in this.plugins)if(this.plugins.hasOwnProperty(o)){var a=this.plugins[o];if(a.name===i)try{t&&(delete this.plugins[o],delete this.plugin_names[i]),a._unloaded=!0,this.unregister(a),"function"===typeof a.terminate&&a.terminate().then(function(){n.update_ui_callback()}),this.update_ui_callback()}catch(r){console.error(r)}}this.unregister(e),"function"===typeof e.terminate&&e.terminate().finally(function(){n.update_ui_callback()}),this.update_ui_callback()}},{key:"reloadPlugin",value:function(e,t){var n=this;return new Promise(function(i,o){try{e instanceof Ue&&(e=e.config),n.unloadPlugin(e,!0);var a,r=n.parsePluginCode(e.code,{engine_mode:e.engine_mode,tag:e.tag,_id:e._id,origin:e.origin});if(r.engine=null,"collection"===r.type)return;n.unloadPlugin(r,!0),"window"===r.type||"web-python-window"===r.type?a=n.preLoadPlugin(r):("eval is evil"===t?n._allowed_evil_plugin[r.name]=r.code:n._allowed_evil_plugin[r.name]===r.code&&(t="eval is evil"),a=n.loadPlugin(r,null,t)),a.then(function(t){t._id=e._id,e.name=t.name,e.type=t.type,e.plugin=t,n.update_ui_callback(),i(t)}).catch(function(t){e.plugin=null,o(t)})}catch(s){n.showMessage(s||"Error.",15),o(s)}})}},{key:"savePlugin",value:function(e){var t=this;return new Promise(function(n,i){var o=e.code;try{var a=t.parsePluginCode(o,{tag:e.tag,origin:e.origin,engine_mode:e.engine_mode});a.code=o,a._id=a.name.replace(/ /g,"_"),a.hash=W.a.hash(a.code);var r=function(e){t.db.put(e).then(function(){for(var i=0;i<t.installed_plugins.length;i++)t.installed_plugins[i].name===e.name&&t.installed_plugins.splice(i,1);e.installed=!0,t.installed_plugins.push(e),n(e),t.showMessage("".concat(e.name," has been successfully saved."))}).catch(function(e){t.showMessage("Failed to save the plugin.",15),console.error(e),i("failed to save")})};t.db.get(a._id).then(function(e){a._rev=e._rev,r(a)}).catch(function(){r(a)})}catch(s){t.showMessage(s||"Error.",15),i(s)}})}},{key:"getBadges",value:function(e){var t=xe(e.type);return t?t.icon||"":"ð"}},{key:"parsePluginCode",value:function(e,t){t=t||{};try{var n,i=ge(e);if("yaml"===i.config[0].attrs.lang)n=$.a.load(i.config[0].content);else if("json"===i.config[0].attrs.lang)n=JSON.parse(i.config[0].content);else if(n=JSON.parse(i.config[0].content),Object(j["d"])(n.api_version,">","0.1.5"))throw"Unsupported config language ".concat(i.config[0].attrs.lang,', please set lang="json" or lang="yaml"');n.tag=t.tag||n.tags&&n.tags[0],n.scripts=[];for(var o=0;o<i.script.length;o++)i.script[o].attrs.tag===n.tag&&(n.script=i.script[o].content),i.script[o].attrs.tag&&i.script[o].attrs.tag!==n.tag||n.scripts.push(i.script[o]);!n.script&&i.script.length>0&&(n.script=i.script[0].content,n.lang=i.script[0].attrs.lang),n.links=i.link||null,n.windows=i.window||null,n.styles=i.style||null,n.docs=i.docs||null,n.attachments=i.attachment||null,n._id=t._id||n.name.replace(/ /g,"_"),n.uri=t.uri,n.origin=t.origin,n.code=e,n.id=n.name.trim().replace(/ /g,"_")+"_"+Object(j["l"])(),n.runnable=!1!==n.runnable,n.requirements=n.requirements||[];for(var a=0;a<ye.length;a++){var r=n[ye[a]];if(r&&"object"===Object(l["a"])(r)&&!(r instanceof Array)){if(!n.tag)throw"You must use 'tags' with configurable fields.";n[ye[a]]=r[n.tag],r.hasOwnProperty(n.tag)||console.log("WARNING: "+ye[a]+" do not contain a tag named: "+n.tag)}}if(n.lang=n.lang||"javascript",n=je(n),!Ce(n)){var s=Ce.errors;throw console.error("Invalid plugin config: "+n.name,s),s}var c=xe(n.type);return n.badges=this.getBadges(n),n.engine_mode=c?null:t.engine_mode||"auto",n.flags&&(n.flags.indexOf("engine")>=0||n.flags.indexOf("engine-factory")>=0)&&(n.badges=n.badges+"â"),n.flags&&n.flags.indexOf("file-manager")>=0&&(n.badges=n.badges+"ð"),n}catch(u){throw console.error(u),"Failed to parse the plugin file, error: ".concat(u)}}},{key:"validatePluginConfig",value:function(e){if(e.name.indexOf("/")<0)return!0;throw"Plugin name should not contain '/'."}},{key:"preLoadPlugin",value:function(e,t){var n=this,i={_id:e._id,name:e.name,type:e.type,ui:e.ui,tag:e.tag,inputs:e.inputs,outputs:e.outputs,docs:e.docs,attachments:e.attachments};return this.validatePluginConfig(i),new Promise(function(o,a){t?(i.id=t.id,i.initialized=!0):(i.id=e.name.trim().replace(/ /g,"_")+"_"+Object(j["l"])(),i.initialized=!1);var r=S.a.assign({},e,i),s=S.a.assign({TAG:r.tag,WORKSPACE:n.selected_workspace},n.imjoy_api);try{var l=new Ue(r,s,null,!0);l.api={__as_interface__:!0,__id__:l.id,setup:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),run:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(i){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(o=Object(j["b"])(e.defaults)||{},o.type=e.name,o.name=e.name,o.tag=e.tag,o.data=i&&i.data||{},o.config=i&&i.config||{},o.id=i&&i.id,!o.as_dialog||!n.imjoy_api.showDialog){t.next=14;break}return o.standalone&&(o.fullscreen=!0,o.standalone=!1),t.next=11,n.imjoy_api.showDialog(null,o);case 11:return t.abrupt("return",t.sent);case 14:return t.next=16,n.createWindow(null,o);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},n.register(l,i),n.plugins[l.id]=l,n.plugin_names[l.name]=l,n.event_bus.emit("plugin_loaded",l),o(l)}catch(u){a(u)}})}},{key:"loadPlugin",value:function(e,t,n){var i=this;return e=Object(j["b"])(e),this.validatePluginConfig(e),new Promise(function(o,a){var r={};t?(r.id=t.id,r.initialized=!0):(r.id=e.name.trim().replace(/ /g,"_")+"_"+Object(j["l"])(),r.initialized=!1),r._id=e._id;var s=null;xe(e.type)||(s=i.em.findEngine(e),s&&s.connected?i.showMessage("Connected to ð ".concat(s.name)):console.error("Please connect to the Plugin Engine ð"));var c=S.a.assign({},e,r);c.workspace=i.selected_workspace;var l=S.a.assign({TAG:c.tag,WORKSPACE:i.selected_workspace,ENGINE_URL:s&&s.url||void 0},i.imjoy_api);try{var u=new Ue(c,l,s,!1,n);u._log_history.push("Loading plugin ".concat(u.id," (TAG=").concat(l.TAG,", WORKSPACE=").concat(l.WORKSPACE,")")),l.ENGINE_URL&&u._log_history.push("ENGINE_URL=".concat(l.ENGINE_URL));var d=setTimeout(function(){u.initializing=!1,console.warn("Plugin ".concat(u.name," failed to load in 180s."))},18e4);u.whenConnected(function(){if(clearTimeout(d),!u.api)throw console.error("Error occured when loading plugin."),i.showMessage("Error occured when loading plugin."),a("Error occured when loading plugin."),"Error occured when loading plugin.";if(u._log_history.push("Plugin connected."),u._unloaded)return console.log("WARNING: this plugin is ready but unloaded: "+u.id),void u.terminate().then(function(){i.update_ui_callback()});e.type&&i.register(u,e),u.config.resumed&&u.api.resume?(u._log_history.push("Resuming plugin."),u.api.resume().then(function(){i.event_bus.emit("plugin_loaded",u),o(u)}).catch(function(t){console.error("error occured when loading plugin "+e.name+": ",t),i.showMessage("<".concat(e.name,">: ").concat(t),15),a(t),u.terminate().then(function(){i.update_ui_callback()})})):u.api.setup?(u._log_history.push("Setting up plugin."),u.api.setup().then(function(){i.event_bus.emit("plugin_loaded",u),o(u)}).catch(function(t){console.error("error occured when loading plugin "+e.name+": ",t),i.showMessage("<".concat(e.name,">: ").concat(t),15),a(t),u.terminate().then(function(){i.update_ui_callback()})})):(console.warn('No "setup()" function is defined in plugin "'.concat(u.name,'".')),o(u))}),u.whenFailed(function(t){clearTimeout(d),u.error(t),t?i.showMessage("<".concat(e.name,">: ").concat(t)):i.showMessage("Error occured when loading ".concat(e.name,".")),console.error("error occured when loading "+e.name+": ",t),u.terminate().then(function(){i.update_ui_callback()}),a(t)}),u.docs=e.docs,u.attachments=e.attachments,i.plugins[u.id]=u,i.plugin_names[u.name]=u}catch(p){a(p)}})}},{key:"renderWindow",value:function(e){var t=this;return new Promise(function(n,i){var o=S.a.assign({},e.plugin,e);o.workspace=t.selected_workspace;var a=S.a.assign({},t.imjoy_api),r=function(t){e.api.hasOwnProperty(t)&&(a[t]=function(){var n=Array.prototype.slice.call(arguments,1);e.api[t].apply(e,n)})};for(var s in e.api)r(s);var c=S.a.assign({TAG:o.tag,WORKSPACE:t.selected_workspace},a);try{var l=new Ue(o,c);l.whenConnected(function(){if(!e.standalone&&e.focus&&e.focus(),!l.api)return console.error("the window plugin seems not ready."),void i("the window plugin seems not ready.");l.api.setup().then(function(){if(e.data=e.data||{},e.data._source_op=e.data&&e.data._op,e.data._op=l.name,e.data._workflow_id=e.data&&e.data._workflow_id,e.plugin=l,e.update=l.api.run,l.config.runnable&&!l.api.run){var o="You must define a `run` function for "+l.name+" or set its `runnable` field to false.";return i(o),void l.error(o)}l.api.run?l.api.run(t.filter4plugin(e)).then(function(t){if(t)for(var i in t)e[i]=t[i];n(l)}).catch(function(e){l.error("<".concat(l.name,">: (").concat(e&&e.toString(),' || "Error.")')),i(e)}):n(l)}).catch(function(n){l.error("Error occured when loading the window plugin ".concat(e.name,": ").concat(n&&n.toString())),l.terminate().then(function(){t.update_ui_callback()}),i(n)})}),l.whenFailed(function(n){!e.standalone&&e.focus&&e.focus(),l.error("Error occured when loading ".concat(e.name,": ").concat(n,".")),l.terminate().then(function(){t.update_ui_callback()}),i(n)})}catch(u){i(u)}})}},{key:"plugin2joy",value:function(e){if(!e)return null;var t={};return t.__as_interface__=e.__as_interface__,t.__id__=e.__id__,e.type&&e.data?(t.data=e.config,t.target=e.data,t.target.name=e.name||"",t.target.type=e.type||""):(t.data=null,t.target=e),t.target=t.target||{},Array.isArray(t.target)&&t.target.length>0&&void 0!==e.select&&t.target[e.select]&&(t.target=t.target[e.select]),"object"===Object(l["a"])(t.target)?(t.target._variables=e._variables||{},t.target._workflow_id=e._workflow_id||null,t.target._op=e._op||null,t.target._source_op=e._source_op||null,t.target._transfer=e._transfer||!1,Object.keys(t.target).length>4?t:null):t}},{key:"filter4plugin",value:function(e){return e&&{_variables:e._variables||null,_op:e._op,_source_op:e._source_op,_transfer:e._transfer,_workflow_id:e._workflow_id,config:e.config,data:e.data}}},{key:"joy2plugin",value:function(e){if(!e)return null;e.target=e.target||{};var t={__as_interface__:e.__as_interface__,__id__:e.__id__,_variables:e.target._variables||null,_op:e.target._op,_source_op:e.target._source_op,_transfer:e.target._transfer,_workflow_id:e.target._workflow_id,config:e.data,data:e.target,name:e.target.name||"",type:e.target.type||""};return delete e.target._op,delete e.target._workflow_id,delete e.target._variables,delete e.target._source_op,delete e.target._transfer,t}},{key:"getRepoManifest",value:function(e,t){var n=this;return new Promise(function(i,o){var a,r,s=new RegExp("^[^/.]+/[^/.]+$");e.match(s)?(r=e,t&&(e=e+"/tree/"+t,r=r+"@"+t),a=Object(j["g"])("https://github.com/"+e)):e.includes("github.com")?(a=Object(j["g"])(e),r=Object(j["h"])(e)):(a=e,r=a),p.a.get(a).then(function(e){if(e&&e.data&&e.data.plugins){var t=e.data;t.plugins=t.plugins.filter(function(e){return!e.disabled}),t.uri_root.startsWith("http")||(t.uri_root=a.replace(new RegExp("manifest.imjoy.json$"),S.a.trim(t.uri_root,"/")));for(var s=0;s<t.plugins.length;s++){var c=t.plugins[s];c.uri=c.uri||c.name+".imjoy.html",c.origin=r+":"+c.name,c.uri.startsWith(t.uri_root)||c.uri.startsWith("http")||(c.uri=t.uri_root+"/"+c.uri),c._id=c._id||c.name.replace(/ /g,"_"),c.badges=n.getBadges(c)}i(t)}else o("failed to load url: "+a)}).catch(o)})}},{key:"destroy",value:function(){for(var e in this.plugins)if(this.plugins.hasOwnProperty(e)){var t=this.plugins[e];try{"function"===typeof t.terminate&&t.terminate()}catch(n){}}}},{key:"registerOp",value:function(e,t){var n=this;try{if(!e)throw"Plugin not found.";if(t=Object(j["b"])(t),t.name=t.name||e.name,t.show_panel=t.show_panel||!1,e.name===t.name&&(t.ui=t.ui||e.config.description),t.inputs=t.inputs||null,t.outputs=t.outputs||null,t.run=t.run||null,t.run=t.run||e&&e.api&&e.api.run,!Ee(t)){var i=Ee.errors;throw console.error("Error occured during registering "+t.name,i),i}var o=e.name,a=t.name,r=a===o?o:o+"/"+a,s={name:t.name,tags:["op","plugin"],type:r,init:Fe["a"].normalizeUI(t.ui)};"window"===t.type?s.tags.push("window"):"native-python"===t.type?s.tags.push("python"):"web-worker"===t.type?s.tags.push("web-worker"):"web-python"===t.type?s.tags.push("web-python"):"web-python-window"===t.type?s.tags.push("web-python-window"):"iframe"===t.type&&s.tags.push("iframe");var u=t.run;if(e&&u){var d=function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(i){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u(n.joy2plugin(i));case 3:return o=t.sent,t.abrupt("return",n.plugin2joy(o));case 7:throw t.prev=7,t.t0=t["catch"](0),e.error(t.t0&&t.t0.toString()),t.t0;case 11:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e){return t.apply(this,arguments)}}();s.onexecute=d}else s.onexecute=function(){e.log("WARNING: no run function defined.")};if(t.update&&"function"===typeof t.update){var p=function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(i){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.update(n.joy2plugin(i));case 2:return o=e.sent,e.abrupt("return",n.plugin2joy(o));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();s.onupdate=Object(j["e"])(p,300)}else if(e&&e.api&&e.api.update){var m=function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(i){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.api.update(n.joy2plugin(i));case 2:return o=t.sent,t.abrupt("return",n.plugin2joy(o));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();s.onupdate=Object(j["e"])(m,300)}if(!Oe(s)){var h=Oe.errors;throw console.error("Error occured during registering op to joy "+s.name,h),h}Fe["a"].add(s);var f={plugin_id:e.id,name:s.name,ui:"{id: '__op__', type: '"+s.type+"'}",onexecute:s.onexecute};if(e.ops=e.ops||{},e.ops[t.name]=f,t.inputs)try{if(("object"!=t.inputs.type||!t.inputs.properties)&&("array"!=t.inputs.type||!t.inputs.items)){if("object"!==Object(l["a"])(t.inputs))throw"inputs schema must be an object.";t.inputs={properties:t.inputs,type:"object"}}"object"===t.inputs.type&&t.inputs.properties&&!t.inputs.required&&(t.inputs.required=Object.keys(t.inputs.properties));var g=Le.compile(t.inputs);f.inputs_schema=g,this.registered.inputs[r]={loader_key:r,op_name:a,plugin_name:o,schema:g},this.registered.loaders[r]=function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(i){var o,r,s,c,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(o={},!e.config||!e.config.ui){t.next=5;break}return t.next=4,n.imjoy_api.showDialog(e,{type:"imjoy/joy",ui:e.config.ui,name:e.config.name});case 4:o=t.sent;case 5:return i.transfer=i.transfer||!1,i._source_op=i._op,i._op=a,i._workflow_id=i._workflow_id||"data_loader_"+a.trim().replace(/ /g,"_")+Object(j["l"])(),r={op:{name:a},target:i,data:o},t.next=12,e.api.run(n.joy2plugin(r));case 12:if(s=t.sent,!s){t.next=23;break}if(c=n.plugin2joy(s),!c||c.__as_interface__){t.next=23;break}return l={},l.name=c.name||"result",l.type=c.type||"imjoy/generic",l.config=c.data||{},l.data=c.target||{},t.next=23,n.createWindow(e,l);case 23:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),this.wm.registerInputLoader(r,this.registered.inputs[r],this.registered.loaders[r])}catch(v){console.error('error occured when parsing the inputs schema of "'.concat(t.name,'"'),v)}if(t.outputs)try{if("object"!=t.outputs.type||!t.outputs.properties){if("object"!==Object(l["a"])(t.outputs))throw"inputs schema must be an object.";t.outputs={properties:t.outputs,type:"object"}}"object"===t.outputs.type&&t.outputs.properties&&!t.outputs.required&&(t.outputs.required=Object.keys(t.outputs.properties));var _=Le.compile(t.outputs);f.outputs_schema=_,this.registered.outputs[r]={op_name:t.name,plugin_name:e.name,schema:_}}catch(v){console.error('error occured when parsing the outputs schema of "'.concat(t.name,'"'),v)}return this.registered.ops[r]=f,this.registered.windows[t.name]=e.config,this.event_bus.emit("op_registered",f),!0}catch(v){throw console.error(v),v}}},{key:"unregisterOp",value:function(e,t){if(!e)throw"Plugin not found.";var n=e.name;if(t){var i="string"===typeof t?t:t.name,o=i===n?n:n+"/"+i;this.registered.inputs[o]&&delete this.registered.inputs[o],this.registered.loaders[o]&&delete this.registered.loaders[o],i===n&&this.registered.windows[n]&&delete this.registered.windows[n],this.registered.ops[o]&&delete this.registered.ops[o],e.ops&&e.ops[i]&&delete e.ops[i],this.wm.unregisterInputLoader(o),Fe["a"].remove(o)}else{if(e.ops&&Object.keys(e.ops).length>0)for(var a in e.ops){var r=e.ops[a];r.name&&this.unregisterOp(e,r.name)}e.name&&this.unregisterOp(e,e.name)}}},{key:"register",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o,a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("engine"!==n.type){e.next=12;break}if(Object(j["c"])(t.config.flags&&t.config.flags.indexOf("engine")>=0,"Please add `engine` to `config.flags` before registering an engine."),Re(n)){e.next=6;break}throw i=Re.errors,console.error("Error occured registering engine ",n,i),i;case 6:return e.next=8,this.em.register(n);case 8:this.registered.engines[n.name]=n,t.on("close",function(){r.em.unregister(n)}),e.next=34;break;case 12:if("engine-factory"!==n.type){e.next=23;break}if(Object(j["c"])(t.config.flags&&t.config.flags.indexOf("engine-factory")>=0,"Please add `engine-factory` to `config.flags` before registering an engine factory."),De(n)){e.next=18;break}throw o=De.errors,console.error("Error occured registering engine factory",n,o),o;case 18:this.em.registerFactory(n),this.registered.engine_factories[n.name]=n,t.on("close",function(){r.em.unregisterFactory(n)}),e.next=34;break;case 23:if("file-manager"!==n.type){e.next=33;break}if(Object(j["c"])(t.config.flags&&t.config.flags.indexOf("file-manager")>=0,"Please add `file-manager` to `config.flags` before registering a file manager."),Ie(n)){e.next=29;break}throw a=Ie.errors,console.error("Error occured registering file manager",n,a),a;case 29:return e.next=31,this.fm.register(n);case 31:e.next=34;break;case 33:this.registerOp(t,n);case 34:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"unregister",value:function(e,t){t=t||e,"engine"===t.type?this.em.unregister(t):"engine-factory"===t.type?this.em.unregisterFactory(t):"file-manager"===t.type?this.fm.unregister(t):this.unregisterOp(e,t)}},{key:"createWindow",value:function(e,t){var n=this;return new Promise(function(e,i){if(t.data=t.data||null,t.panel=t.panel||null,!Pe(t)){var o=Pe.errors;throw console.error("Error occured during creating window ",t,o),o}if(t.name=t.name||"untitled window",t.type&&t.type.startsWith("imjoy/"))t.id="imjoy_"+Object(j["l"])(),t.window_type=t.type,n.wm.addWindow(t).then(function(n){t.api.on("ready",function(){t.refresh(),t.api=t.api||{},t.api=Object.assign(t.api,{__as_interface__:!0,__id__:n,run:function(e){for(var n in e)t[n]=e[n]}}),e(t.api)},!0)}).catch(i);else{var a=n.registered.windows[t.type];if(!a)throw console.error("No plugin registered for window type: "+t.type,n.registered.windows),i("No plugin registered for window type: "+t.type),"No plugin registered for window type: "+t.type;var r=t;if(r.id=r.id||a.id+"_"+Object(j["l"])(),r.window_type=r.type,r.type=a.type,"window"!==r.type&&"web-python-window"!==r.type)throw'Window plugin must be with type "window"';if(r.iframe_container=r.window_container||"plugin_window_"+r.id+Object(j["l"])(),r.iframe_window=null,r.plugin=a,!Pe(r)){var s=Pe.errors;throw console.error("Error occured during creating window ",r,s),s}r.window_container?(n.wm.setupCallbacks(r),setTimeout(function(){n.renderWindow(r).then(function(t){r.$el&&t.api.emit("window_size_changed",r.$el.getBoundingClientRect()),t.api.refresh(),t.api.on("close",Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n.event_bus.emit("closing_window_plugin",t),e.next=3,t.terminate();case 3:case"end":return e.stop()}},e,this)}))),e(t.api)}).catch(i)},0)):n.wm.addWindow(r).then(function(){r.loading=!0,setTimeout(function(){r.refresh(),n.renderWindow(r).then(function(t){r.api.on("close",Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n.event_bus.emit("closing_window_plugin",t),e.next=3,t.terminate();case 3:case"end":return e.stop()}},e,this)}))),r.loading=!1,r.refresh(),e(t.api)}).catch(function(e){r.loading=!1,r.refresh(),i(e)})},0)})}})}},{key:"callPlugin",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n,i){var o,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=this.plugin_names[n],!o){e.next=9;break}if(o.api[i]){e.next=4;break}throw'function "'.concat(i,'" of ').concat(n," is not available.");case 4:return e.next=6,o.api[i].apply(null,Array.prototype.slice.call(a,3,a.length));case 6:return e.abrupt("return",e.sent);case 9:throw"plugin with type ".concat(n," not found.");case 10:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}()},{key:"getPlugins",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(i in n=[],this.plugins)this.plugins.hasOwnProperty(i)&&n.push({name:this.plugins[i].name,config:this.plugins[i].config,api:this.plugins[i].api});return console.log(n),e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPlugin",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.plugin_names[n],!i){e.next=5;break}return e.abrupt("return",i.api);case 5:if(!this.internal_plugins[n]){e.next=11;break}return e.next=8,this.reloadPluginRecursively({uri:this.internal_plugins[n].uri},null,"eval is evil");case 8:return o=e.sent,console.log("".concat(o.name," loaded.")),e.abrupt("return",o.api);case 11:throw"plugin with type ".concat(n," not found.");case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getFileManager",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.fm.getFileManagerByUrl(n),!i){e.next=5;break}return e.abrupt("return",i.api);case 5:throw"file manager with url ".concat(n," not found.");case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getEngine",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.em.getEngineByUrl(n),!i){e.next=5;break}return e.abrupt("return",i.api);case 5:throw"engine with url ".concat(n," not found.");case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getEngineFactory",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.em.getFactory(n),!i){e.next=5;break}return e.abrupt("return",i.api);case 5:throw"engine factory with name ".concat(n," not found.");case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"runPlugin",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n,i){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t&&t.id){e.next=2;break}throw"source plugin is not available.";case 2:if(o=this.plugin_names[n],!o){e.next=9;break}return e.next=6,o.api.run(i||{});case 6:return e.abrupt("return",e.sent);case 9:throw"plugin with type "+n+" not found.";case 10:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}()},{key:"setPluginConfig",value:function(e,t,n){if(!e)throw"setConfig Error: Plugin not found.";if(t.startsWith("_")&&e.config.hasOwnProperty(t.slice(1)))throw"'".concat(t.slice(1),"' is a readonly field defined in <config> block, please avoid using it");return n?localStorage.setItem("config_"+e.name+"_"+t,n):localStorage.removeItem("config_"+e.name+"_"+t)}},{key:"getPluginConfig",value:function(e,t){if(!e)throw"getConfig Error: Plugin not found.";return t.startsWith("_")&&e.config.hasOwnProperty(t.slice(1))?e.config[t.slice(1)]:localStorage.getItem("config_"+e.name+"_"+t)}},{key:"getAttachment",value:function(e,t){if(!e.config.attachments)return null;for(var n=0;n<e.config.attachments.length;n++)if(e.config.attachments[n].attrs.name===t)return e.config.attachments[n].content}},{key:"checkPluginUpdate",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.config,e.next=3,this.getPluginFromUrl(n.origin,this.available_plugins);case 3:i=e.sent,n.hash?n.hash!==W.a.hash(i.code)&&Object(j["d"])(n.version,"<=",i.version)?t.update_available=!0:t.update_available=!1:Object(j["d"])(n.version,"<",i.version)?t.update_available=!0:t.update_available=!1,this.update_ui_callback();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"checkUpdates",value:function(){var e=this;for(var t in this.plugins)this.plugins.hasOwnProperty(t)&&function(){var n=e.plugins[t];if(n.config.origin)e.checkPluginUpdate(n);else{var i=e.available_plugins.find(function(e){return n.name===e.name});i&&(n.config.origin=i.uri,e.checkPluginUpdate(n))}}()}}]),e}(),qe=(n("5df3"),function(){function e(t){var n=t.event_bus,i=void 0===n?null:n,o=t.show_message_callback,a=void 0===o?null:o,r=t.add_window_callback,s=void 0===r?null:r;Object(P["a"])(this,e),this.event_bus=i,Object(j["c"])(this.event_bus),this.windows=[],this.window_ids={},this.active_windows=[],this.show_message_callback=a,this.add_window_callback=s,this.selected_window=null,this.window_mode="grid",this.registered_inputs={},this.registered_loaders={},this.default_window_pos={x:0,y:0,w:20,h:10,index:0}}return Object(E["a"])(e,[{key:"showMessage",value:function(e,t){this.show_message_callback?this.show_message_callback(e,t):console.log("WINDOW MESSAGE: ".concat(e))}},{key:"generateGridPosition",value:function(e){e.i=Object(j["l"])(),e.index=this.default_window_pos.index,e.w=e.w||this.default_window_pos.w,e.h=e.h||this.default_window_pos.h,e.x=this.default_window_pos.x,e.y=this.default_window_pos.y,this.default_window_pos.x=this.default_window_pos.x+this.default_window_pos.w,this.default_window_pos.x>=20&&(this.default_window_pos.x=0,this.default_window_pos.y=this.default_window_pos.y+this.default_window_pos.h),this.default_window_pos.index=this.default_window_pos.index+1}},{key:"registerInputLoader",value:function(e,t,n){this.registered_inputs[e]&&console.log("WARNING: input loader ".concat(e," already exists, it will be replaced.")),this.registered_inputs[e]=t,this.registered_loaders[e]=n}},{key:"unregisterInputLoader",value:function(e){delete this.registered_inputs[e],delete this.registered_loaders[e]}},{key:"getDataLoaders",value:function(e){var t={};for(var n in this.registered_inputs)if(this.registered_inputs.hasOwnProperty(n)&&this.registered_inputs[n].loader_key&&this.registered_inputs[n].schema(e))try{var i=this.registered_inputs[n].loader_key;this.registered_loaders[i]&&(t[i]=i)}catch(o){console.error("Failed to get loaders.",o)}return t}},{key:"setupCallbacks",value:function(e){var t=this;e._callbacks=e._callbacks||{},e.api=e.api||{},e.api.on=function(t,n,i){e._callbacks[t]?e._callbacks[t].push(n):e._callbacks[t]=[n],i&&e._callbacks[t].emitted&&n(e._callbacks[t].emitted_data)},e.api.off=function(t,n){if(e._callbacks[t])if(n){var i=e._callbacks[t],o=i.indexOf(n);o>=0?i.splice(o,1):console.warn("callback ".concat(t," does not exist."))}else delete e._callbacks[t];else console.warn("callback ".concat(t," does not exist."))},e.api.emit=function(t,n){return new Promise(function(){var i=Object(c["a"])(regeneratorRuntime.mark(function i(o,a){var r,s,c,l,u,d,p;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(r=[],i.prev=1,!e._callbacks[t]){i.next=38;break}s=!0,c=!1,l=void 0,i.prev=6,u=e._callbacks[t][Symbol.iterator]();case 8:if(s=(d=u.next()).done){i.next=22;break}return p=d.value,i.prev=10,i.next=13,p(void 0!==n?n:void 0);case 13:i.next=19;break;case 15:i.prev=15,i.t0=i["catch"](10),r.push(i.t0),console.error(i.t0);case 19:s=!0,i.next=8;break;case 22:i.next=28;break;case 24:i.prev=24,i.t1=i["catch"](6),c=!0,l=i.t1;case 28:i.prev=28,i.prev=29,s||null==u.return||u.return();case 31:if(i.prev=31,!c){i.next=34;break}throw l;case 34:return i.finish(31);case 35:return i.finish(28);case 36:i.next=41;break;case 38:e._callbacks[t]=[],e._callbacks[t].emitted=!0,e._callbacks[t].emitted_data=n;case 41:r.length<=0?o():a(r),i.next=47;break;case 44:i.prev=44,i.t2=i["catch"](1),a(i.t2);case 47:case"end":return i.stop()}},i,this,[[1,44],[6,24,28,36],[10,15],[29,,31,35]])}));return function(e,t){return i.apply(this,arguments)}}())},e._refresh_callbacks=[],e.api.refresh=e.refresh=Object(c["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e._refresh_callbacks.map(function(e){return e()}));case 2:case"end":return t.stop()}},t,this)})),e._resize_callbacks=[],e.api.resize=e.resize=function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=n||e.$el&&e.$el.getBoundingClientRect(),e.api.emit("resize",n);case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.api.focus=e.focus=function(){e.api.emit("focus")},e.api.close=e.close=Object(c["a"])(regeneratorRuntime.mark(function n(){var i,o;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:i=setTimeout(function(){console.warn("Force quitting the window due to timeout."),o()},2e3),o=function(){var n=t.windows.indexOf(e);n>-1&&(t.windows.splice(n,1),delete t.window_ids[e.id]),(e.selected||t.selected_window===e)&&(e.selected=!1,"single"===t.window_mode?t.selected_window=t.windows[0]:t.selected_window=null),t.event_bus.emit("close_window",e)};try{e.api.emit("close")}catch(a){console.error(a)}finally{o(),clearTimeout(i)}case 3:case"end":return n.stop()}},n,this)}))}},{key:"addWindow",value:function(e){var t=this;return new Promise(function(n,i){try{e.id=e.id||e.name+Object(j["l"])(),e.loaders=t.getDataLoaders(e.data),e.dialog||t.generateGridPosition(e),e.standalone&&(e.h=0,e.w=0),t.window_ids[e.id]&&t.windows.splice(t.windows.indexOf(t.window_ids[e.id]),1),t.windows.push(e),t.window_ids[e.id]=e,t.setupCallbacks(e),t.selectWindow(e,e.dialog),t.add_window_callback?t.add_window_callback(e).then(function(){t.event_bus.emit("add_window",e),n(e.id)}):(t.event_bus.emit("add_window",e),n(e.id)),e.__test__mode__&&e.api.emit("ready")}catch(o){i(o)}})}},{key:"selectWindow",value:function(e,t){if(!t){for(var n=0;n<this.active_windows.length;n++)this.active_windows[n].selected=!1,this.active_windows[n]&&this.active_windows[n].refresh();"single"===this.window_mode||e.standalone?this.selected_window=e:this.selected_window=null,this.active_windows=[e],!e.standalone&&e.focus&&e.focus()}e.selected=!0,e.refresh&&e.refresh()}},{key:"resizeAll",value:function(){for(var e=this.windows.length;e--;)try{this.windows[e].resize()}catch(t){}}},{key:"closeAll",value:function(){var e=this.default_window_pos&&this.default_window_pos.index||0;this.default_window_pos={i:0,x:0,y:0,w:20,h:10,index:e},this.status_text="";for(var t=this.windows.length;t--;)"imjoy/plugin-editor"!=this.windows[t].type&&this.windows[t].close();0===this.windows.length&&(this.default_window_pos.index=0)}},{key:"destroy",value:function(){this.disconnect()}}]),e}());function ze(e,t){return Be.apply(this,arguments)}function Be(){return Be=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.a.get(t+"?"+Object(j["l"])());case 2:if(i=e.sent,!i||200!=i.status||!i.data){e.next=8;break}o=i.data,Je(o,n),e.next=9;break;case 8:throw"Faild to fetch code from "+t;case 9:case"end":return e.stop()}},e,this)})),Be.apply(this,arguments)}function Je(e,t){var n=Object.keys(t),i=n.map(function(e){return t[e]}),o=Function(n.join(", "),e);return o.apply(void 0,i)}var Ke=function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("requirements"!=t.type){e.next=32;break}if(!t.requirements||!Array.isArray(t.requirements)&&"string"!==typeof t.requirements){e.next=30;break}if(e.prev=2,t.requirements="string"===typeof t.requirements?[t.requirements]:t.requirements,!Array.isArray(t.requirements)){e.next=24;break}i=0;case 6:if(!(i<t.requirements.length)){e.next=22;break}if(!t.requirements[i].toLowerCase().endsWith(".js")&&!t.requirements[i].startsWith("js:")){e.next=13;break}return t.requirements[i].startsWith("js:")&&(t.requirements[i]=t.requirements[i].slice(3)),e.next=11,ze(t.requirements[i],{api:n});case 11:e.next=19;break;case 13:if(!t.requirements[i].startsWith("http")){e.next=18;break}return e.next=16,ze(t.requirements[i],{api:n});case 16:e.next=19;break;case 18:t.requirements[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+t.requirements[i]);case 19:i++,e.next=6;break;case 22:e.next=25;break;case 24:throw"Unsupported requirements definition";case 25:e.next=30;break;case 27:throw e.prev=27,e.t0=e["catch"](2),"Failed to import required scripts ".concat(t.requirements,": ").concat(e.t0);case 30:e.next=37;break;case 32:if("script"!=t.type){e.next=36;break}t.src?(o=document.createElement("script"),o.setAttribute("type",t.attrs.type),o.setAttribute("src",t.src),document.head.appendChild(o)):!t.content||t.attrs.type&&"text/javascript"!==t.attrs.type?(a=document.createElement("script"),a.setAttribute("type",t.attrs.type),a.appendChild(document.createTextNode(t.content)),document.body.appendChild(a)):Je(t.content,{api:n}),e.next=37;break;case 36:throw"unsupported code type.";case 37:case"end":return e.stop()}},e,this,[[2,27]])}));return function(t,n){return e.apply(this,arguments)}}();function He(e){for(var t in e)"function"===typeof e[t]&&function(){var n=e[t];"AsyncFunction"!==n.constructor.name&&(e[t]=function(){return Promise.resolve(n.apply(void 0,arguments))})}()}var Ve={type:"engine",pluginType:"evil",icon:"ð",name:"imjoy engine",url:"https://imjoy.io",config:{},connect:function(){return this._disconnected=!1,!0},disconnect:function(){this._disconnected=!0},startPlugin:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this._disconnected){e.next=2;break}throw"engine is disconnected.";case 2:return e.abrupt("return",new Promise(function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(i,o){var a,r,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=function(e){console.log("plugin ".concat(t.name," (id=").concat(t.id,") initialized."),e),He(e),i(e)},n=Object.assign({},n),n.export=a,r=n.register,n.register=function(e){return He(e),r(e)},s=n.on,n.on=function(e,t){var n=function(){return Promise.resolve(t.apply(void 0,arguments))};return s(e,n)},He(n),e.prev=8,e.next=11,Ke({type:"requirements",lang:t.lang,requirements:t.requirements,env:t.env},n);case 11:c=0;case 12:if(!(c<t.scripts.length)){e.next=18;break}return e.next=15,Ke({type:"script",content:t.scripts[c].content,lang:t.scripts[c].attrs.lang,attrs:t.scripts[c].attrs,src:t.scripts[c].attrs.src},n);case 15:c++,e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](8),o(e.t0);case 23:case"end":return e.stop()}},e,this,[[8,20]])}));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),heartbeat:null},Ge=function(){function e(t){var n=t.event_bus,i=void 0===n?null:n,o=t.config_db,a=void 0===o?null:o,r=t.client_id,s=void 0===r?null:r;Object(P["a"])(this,e),this.event_bus=i,this.config_db=a,Object(j["c"])(this.event_bus),Object(j["c"])(this.config_db,"config database is not available"),this.client_id=s||Object(j["l"])(),this.engines=[],this.engine_factories=[]}return Object(E["a"])(e,[{key:"init",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.register(Ve);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"matchEngineByType",value:function(e){return this.engines.filter(function(t){return t.pluginType===e})}},{key:"findEngine",value:function(e){var t=this.engines.filter(function(t){return e.type&&t.pluginType===e.type});if(!t||t.length<=0)return null;if("auto"===e.engine_mode){var n=t.filter(function(e){return e.connected});return n.length<=0?null:n[n.length-1]}return t.filter(function(t){return t.name===e.engine_mode})[0]}},{key:"getEngineByUrl",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.engines[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.url===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"getEngineByName",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.engines[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"register",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a,r,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(n=Object.assign({},t),n.api=t,t&&t===Ve?"127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?n._is_evil=!1:n._is_evil=!0:n._is_evil=!1,i=0;i<this.engines.length;i++)if(n.name&&this.engines[i].name===n.name)try{this.unregister(this.engines[i])}catch(l){console.error(l)}for(o=0;o<this.engines.length;o++)if(n.url&&this.engines[o].url===n.url)try{this.unregister(this.engines[o])}catch(l){console.error(l)}return n.connected=!1,n.engine_status=n.engine_status||{},n.getEngineConfig&&Promise.resolve(n.getEngineConfig()).then(function(e){n.engine_config=e}),a=function(){n.connected?s.event_bus.emit("engine_connected",n):s.event_bus.emit("engine_disconnected",n)},r=function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,i,o,r,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.heartbeat();case 2:if(t=e.sent,n.connected||!t){e.next=8;break}n.connected=!0,a(),e.next=33;break;case 8:if(!n.connected||t){e.next=32;break}for(n.connected=!1,a(),i=!0,o=!1,r=void 0,e.prev=14,s=n._plugins[Symbol.iterator]();!(i=(c=s.next()).done);i=!0)l=c.value,l.terminate();e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](14),o=!0,r=e.t0;case 22:e.prev=22,e.prev=23,i||null==s.return||s.return();case 25:if(e.prev=25,!o){e.next=28;break}throw r;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=33;break;case 32:n.connected=t;case 33:case"end":return e.stop()}},e,this,[[14,18,22,30],[23,,25,29]])}));return function(){return e.apply(this,arguments)}}(),n._plugins=[],n.registerPlugin=function(e){n._plugins.push(e)},this.engines.push(n),e.next=15,n.connect();case 15:if(n.connected=e.sent,a(),!n.heartbeat){e.next=21;break}return e.next=20,r();case 20:n.heartbeat_timer=setInterval(r,5e3);case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unregister",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a,r,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.url,t=this.getEngineByUrl(n),t){e.next=4;break}throw"Engine ".concat(n," not found.");case 4:for(i=this.engines.indexOf(t),o=!0,a=!1,r=void 0,e.prev=8,s=t._plugins[Symbol.iterator]();!(o=(c=s.next()).done);o=!0)l=c.value,l.terminate();e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](8),a=!0,r=e.t0;case 16:e.prev=16,e.prev=17,o||null==s.return||s.return();case 19:if(e.prev=19,!a){e.next=22;break}throw r;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return i>-1&&this.engines.splice(i,1),t.heartbeat_timer&&clearInterval(t.heartbeat_timer),e.next=28,t.disconnect();case 28:t.connected=!1,this.event_bus.emit("engine_disconnected",t);case 30:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])}));return function(t){return e.apply(this,arguments)}}()},{key:"registerFactory",value:function(e){var t=Object.assign({},e);t.api=e;for(var n=0;n<this.engine_factories.length;n++)if(this.engine_factories[n].name===t.name){this.engine_factories.splice(n,1);break}this.engine_factories.push(t)}},{key:"unregisterFactory",value:function(e){e=this.getFactory(e.name);var t=this.engine_factories.indexOf(e);t>-1&&this.engine_factories.splice(t,1)}},{key:"getFactory",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.engine_factories[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"destroy",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=this.engines[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.unregister(a)}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}}]),e}(),Ye=function(){function e(t){var n=t.event_bus,i=void 0===n?null:n,o=t.client_id,a=void 0===o?null:o;Object(P["a"])(this,e),this.event_bus=i,Object(j["c"])(this.event_bus),this.client_id=a||Object(j["l"])(),this.fileManagers=[]}return Object(E["a"])(e,[{key:"init",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFileManagerByName",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.fileManagers[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"getFileManagerByUrl",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.fileManagers[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.url===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"register",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=Object.assign({},t),n.api=t,i=0;case 3:if(!(i<this.fileManagers.length)){e.next=10;break}if(this.fileManagers[i].name!==n.name){e.next=7;break}return this.fileManagers.splice(i,1),e.abrupt("break",10);case 7:i++,e.next=3;break;case 10:return n.connected=!1,o=function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.heartbeat();case 2:n.connected=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.next=14,o();case 14:n.heart_beat_timer=setInterval(o,1e4),this.fileManagers.push(n);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unregister",value:function(e){e=this.getFileManagerByUrl(e.url);var t=this.fileManagers.indexOf(e);t>-1&&this.fileManagers.splice(t,1),e.heart_beat_timer&&clearInterval(e.heart_beat_timer)}},{key:"destroy",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=this.fileManagers[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.destroy()}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}}]),e}(),Xe=n("e61b"),Ze=n.n(Xe),Qe=(Fe["a"],function(){function e(t){var n=t.imjoy_api,i=void 0===n?null:n,o=t.event_bus,a=void 0===o?null:o,r=t.client_id,s=void 0===r?null:r,c=t.config_db,l=void 0===c?null:c,u=t.show_message_callback,d=void 0===u?null:u,p=t.update_ui_callback,m=void 0===p?null:p,h=t.add_window_callback,f=void 0===h?null:h,g=t.jailed_asset_url,_=void 0===g?null:g;Object(P["a"])(this,e),this.config_db=l||new R["a"]("imjoy_config",{revs_limit:2,auto_compaction:!0}),this.event_bus=a||Ze.a.create(),this.client_id=s||"imjoy_web_"+Object(j["l"])(),this.imjoy_api=i||{},this.update_ui_callback=m||function(){},this.show_message_callback=d||function(e){console.log("show message: ",e)},this.add_window_callback=f||function(e){console.log("add window: ",e)},this.em=new Ge({event_bus:this.event_bus,config_db:this.config_db,show_message_callback:this.show_message_callback,client_id:this.client_id}),this.wm=new qe({event_bus:this.event_bus,show_message_callback:this.show_message_callback,add_window_callback:this.add_window_callback}),this.fm=new Ye({event_bus:this.event_bus}),this.pm=new Ne({event_bus:this.event_bus,config_db:this.config_db,engine_manager:this.em,window_manager:this.wm,file_manager:this.fm,imjoy_api:this.imjoy_api,show_message_callback:this.show_message_callback,update_ui_callback:this.update_ui_callback,jailed_asset_url:_})}return Object(E["a"])(e,[{key:"init",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fm.init();case 2:return e.next=4,this.pm.init();case 4:return e.next=6,this.pm.loadWorkspaceList();case 6:return e.prev=6,e.next=9,this.em.init();case 9:console.log("Successfully initialized the engine manager."),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](6),console.error(e.t0),this.show_message_callback("Failed to initialize the engine manager: "+e.t0.toString());case 16:case"end":return e.stop()}},e,this,[[6,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:if(!t.workspace){e.next=7;break}return e.next=5,this.pm.loadWorkspace(t.workspace);case 5:return e.next=7,this.pm.reloadPlugins();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.pm.destroy(),this.em.destroy();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}()),et=new we.a,tt={name:"imjoy",data:function(){return{imjoy:null,pm:null,em:null,wm:null,workflow_expand:!1,file_select:null,folder_select:null,selected_file:null,selected_files:null,showPluginDialog:!1,showSettingsDialog:!1,showAboutDialog:!1,showAddPluginDialog:!1,permission_message:"No permission message.",share_url_message:"No url",resolve_permission:null,reject_permission:null,plugin_url:null,downloading_plugin:!1,downloading_error:"",plugin4install:null,tag4install:"",show_plugin_source:!1,init_plugin_search:null,show_plugin_templates:!0,show_plugin_store:!0,show_plugin_url:!0,show_installed_plugins:!1,progress:0,status_text:"",showWorkspaceDialog:!1,showWelcomeDialog:!1,show_file_dialog:!1,plugins:null,registered:null,menuVisible:!1,snackbar_info:"",snackbar_duration:3e3,show_snackbar:!1,screenWidth:1024,plugin_loaded:!1,new_workspace_name:"",workspace_dropping:!1,max_window_buttons:9,installing:!1,dialog_auto_height:"100%",dialog_window_config:{},latest_version:null,is_latest_version:!1,checking:!1,alert_config:{show:!1},confirm_config:{show:!1,confirm:function(){},cancel:function(){}},prompt_config:{show:!1,confirm:function(){},cancel:function(){}},selected_file_managers:[]}},watch:{},computed:{version_badge_url:function(){if(this.latest_version){var e=this.is_latest_version?"success":"orange";return"https://img.shields.io/badge/imjoy-v"+this.imjoy_version+"-"+e+".svg"}return null},dialogWindows:function(){return this.wm.windows.filter(function(e){return e.dialog}).reverse()},windows:function(){return this.wm.windows.filter(function(e){return!e.dialog})}},created:function(){var e=this;this.imjoy_version=x["a"],this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus||Ze.a.create();var t={alert:this.showAlert,prompt:this.showPrompt,confirm:this.showConfirm,showDialog:this.showDialog,showProgress:this.showProgress,showStatus:this.showStatus,showFileDialog:this.showFileDialog,showSnackbar:this.showSnackbar,uploadFileToUrl:this.uploadFileToUrl,downloadFileFromUrl:this.downloadFileFromUrl,showMessage:function(t,n,i){e.showMessage(n,i)},utils:{$forceUpdate:this.$forceUpdate,openUrl:this.openUrl,sleep:this.sleep,assert:j["c"]}};for(var n in this.imjoy_api)if("function"===typeof this.imjoy_api[n])this.imjoy_api[n]=this.imjoy_api[n].bind(this);else if("object"===Object(l["a"])(this.imjoy_api[n]))for(var i in this.imjoy_api[n])this.imjoy_api[n][i]=this.imjoy_api[n][i].bind(this);this.client_id=localStorage.getItem("imjoy_client_id"),this.client_id||(this.client_id="imjoy_web_"+Object(j["l"])(),localStorage.setItem("imjoy_client_id",this.client_id)),this.imjoy=new Qe({imjoy_api:t,event_bus:this.event_bus,show_message_callback:this.showMessage,update_ui_callback:function(){e.$forceUpdate()},add_window_callback:this.addWindowCallback,client_id:this.client_id}),this.pm=this.imjoy.pm,this.em=this.imjoy.em,this.fm=this.imjoy.fm,this.wm=this.imjoy.wm,this.IMJOY_PLUGIN={_id:"IMJOY_APP"},this.plugin_templates=[{name:"Default template",code:h.a,icon:"code"},{name:"Web Worker (JS)",code:h.a,icon:"swap_horiz"},{name:"Window (HTML/CSS/JS)",code:b.a,icon:"picture_in_picture"},{name:"Native Python",code:g.a,icon:"ð"},{name:"Web Python",code:v.a,icon:"ð"}],this.workflow_joy_config={expanded:!0,name:"Workflow",ui:"{id:'workflow', type:'ops'}"};var o=function(e){var t=document.getElementById("whiteboard");return e&&t&&t.contains(e)},a=function(e){var t=document.getElementById("engine-file-dialog");return e&&t&&t.contains(e)};document.addEventListener("dragover",function(t){t.preventDefault(),t.stopPropagation(),o(t.target)&&(e.workspace_dropping||(e.workspace_dropping=!0,e.$forceUpdate())),a(t.target)&&e.event_bus.emit("drag_upload_enter")}),document.addEventListener("dragenter",function(t){t.preventDefault(),t.stopPropagation(),o(t.target)&&(e.workspace_dropping=!0,e.$forceUpdate()),a(t.target)&&e.event_bus.emit("drag_upload_enter")}),document.addEventListener("dragleave",function(t){t.preventDefault(),t.stopPropagation(),e.workspace_dropping&&(e.workspace_dropping=!1,e.$forceUpdate()),a(t.target)||e.event_bus.emit("drag_upload_leave")});var r=function(t){return new Promise(function(n,i){var o=[],a=!1,r=function e(t,i,a,r){if(i=i||"",t&&t.isFile)t.file(function(e){e.relativePath=i+e.name,e.loaders=a(e),o.push(e),r&&n(o)});else if(t&&t.isDirectory){var s=t.createReader();s.readEntries(function(n){for(var o=0;o<n.length;o++)e(n[o],i+t.name+"/",a,r&&o===n.length-1)})}else r&&n(o)},s=t.dataTransfer.items.length;if(0!==s){for(var c=0;c<s;c++)if(t.dataTransfer.items[c].webkitGetAsEntry){a=!0;var l=t.dataTransfer.items[c].webkitGetAsEntry();r(l,null,function(t){return e.wm.getDataLoaders(t)},c===s-1)}e.selected_files=a?o:t.dataTransfer.files}else i()})};document.addEventListener("drop",function(t){t.preventDefault(),o(t.target)?(r(t).then(e.loadFiles),e.workspace_dropping=!1,e.$forceUpdate()):a(t.target)&&(e.event_bus.emit("drag_upload_leave"),r(t).then(function(t){e.event_bus.emit("drag_upload",t)}))})},beforeRouteLeave:function(e,t,n){if(this.wm&&this.wm.windows.length>0){var i=window.confirm("Do you really want to leave? you have unsaved changes!");i?n():n(!1)}else n()},mounted:function(){var e=this;this.event_bus.on("resize",this.updateSize),this.event_bus.on("plugin_loaded",function(){e.$refs.workflow&&e.$refs.workflow.setupJoy&&e.$refs.workflow.setupJoy()}),this.event_bus.on("op_registered",function(){e.$refs.workflow&&e.$refs.workflow.setupJoy&&e.$refs.workflow.setupJoy()}),this.event_bus.on("closing_window_plugin",function(t){e.dialogWindows[0]&&e.dialogWindows[0].plugin===t&&(e.showPluginDialog=!1)}),this.updateSize({width:window.innerWidth}),this.wm&&(this.screenWidth>800?this.wm.window_mode="grid":this.wm.window_mode="single"),setInterval(function(){e.$forceUpdate()},5e3),this.welcome?this.showWelcomeDialog=!0:this.startImJoy(this.$route).then(function(){e.showAddPluginDialog||e.pm.plugins&&!(Object.keys(e.pm.plugins)<=0)||e.pm.reloadPluginRecursively({uri:"imjoy-team/imjoy-plugins:Welcome"}).then(function(){e.showDialog(null,{type:"Welcome",name:"Welcome to ImJoy"})}),window.gtag&&window.gtag("config","UA-134837258-1",{page_location:location.href.split("#")[0],page_path:"/#/app"})})},beforeDestroy:function(){this.imjoy.destroy()},methods:{startImJoy:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a,r,s,c,l,u,d,m,h,f,g,_,v,w,b,y,x,C,O,P,E,D,R,I=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.imjoy.init();case 2:if(n=(t.query.repo||t.query.r||"").trim(),!n){e.next=22;break}return this.plugin_url=null,this.init_plugin_search=null,this.show_plugin_store=!0,this.show_plugin_url=!1,this.downloading_plugin=!0,e.prev=9,e.next=12,this.pm.addRepository(n);case 12:this.pm.selected_repository=e.sent,this.downloading_plugin=!1,e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](9),this.downloading_plugin=!1,this.downloading_error="Sorry, the repository URL is invalid: "+e.t0.toString();case 20:this.show_plugin_templates=!1,this.showAddPluginDialog=!0;case 22:if(i=(t.query.plugin||t.query.p||"").trim(),o=null,!i){e.next=52;break}if(!(i.match(j["m"])||i.includes("/")&&i.includes(":"))){e.next=44;break}return this.plugin_url=i,this.init_plugin_search=null,this.show_plugin_store=!1,this.show_plugin_url=!1,e.prev=30,e.next=33,this.getPlugin4Install(i);case 33:o=e.sent,!this.pm.plugin_names[o.name]||t.query.upgrade||o.version!==this.pm.plugin_names[o.name].config.version?(this.show_plugin_templates=!1,this.showAddPluginDialog=!0):this.showMessage('Plugin "'.concat(o.name,'" is already installed.')),e.next=42;break;case 37:return e.prev=37,e.t1=e["catch"](30),console.error(e.t1),e.next=42,this.showAlert(null,e.t1);case 42:e.next=50;break;case 44:this.plugin_url=null,this.init_plugin_search=i,this.show_plugin_store=!0,this.show_plugin_url=!1,this.show_plugin_templates=!1,this.showAddPluginDialog=!0;case 50:e.next=53;break;case 52:t.query.workflow&&this.loadWorkfowFromUrl();case 53:for(a=!0,r=!1,s=void 0,e.prev=56,c=this.getDefaultInputLoaders()[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)u=l.value,this.wm.registerInputLoader(u.loader_key,u,u.loader);e.next=64;break;case 60:e.prev=60,e.t2=e["catch"](56),r=!0,s=e.t2;case 64:e.prev=64,e.prev=65,a||null==c.return||c.return();case 67:if(e.prev=67,!r){e.next=70;break}throw s;case 70:return e.finish(67);case 71:return e.finish(64);case 72:return e.next=74,this.pm.loadRepositoryList();case 74:return this.repository_list=e.sent,this.pm.selected_repository=this.repository_list[0],e.prev=76,t.query.start||t.query.s?this.menuVisible=!1:this.menuVisible=!0,d=t.query.workspace||t.query.w||this.pm.workspace_list[0],e.next=81,this.pm.loadWorkspace(d);case 81:return e.next=83,this.pm.reloadPlugins();case 83:if(!t.query.jupyter_plugin){e.next=97;break}if(m="Jupyter-Notebook",this.pm.plugin_names[m]){e.next=96;break}return console.log('Loading internal plugin "'.concat(m,'"...')),e.prev=87,e.next=90,this.pm.reloadPluginRecursively({uri:this.pm.internal_plugins[m].uri},null,"eval is evil");case 90:console.log("".concat(m," plugin loaded.")),e.next=96;break;case 93:e.prev=93,e.t3=e["catch"](87),console.error(e.t3);case 96:this.pm.reloadPlugin({code:k.a.replace(/Untitled Plugin/g,t.query.jupyter_plugin)}).catch(function(e){console.error(e)});case 97:if(t.query.engine&&t.query.start&&(h=this.em.getEngineByUrl(t.query.engine),f=this.pm.plugin_names[t.query.start],h&&f&&(console.log("setting plugin engine of ".concat(f.name," to ").concat(h.name)),f.engine_mode=h.name,f.config.engine_mode=h.name),h||this.showMessage("Plugin engine ".concat(t.query.engine," not found.")),f||this.showMessage("Plugin ".concat(t.query.start," not found."))),g=null,(t.query.token||t.query.t)&&(g=(t.query.token||t.query.t).trim()),t.query.engine||t.query.e){_=(t.query.engine||t.query.e).trim();try{this.em.addEngine({type:"default",url:_,token:g},!1)}finally{this.em.getEngineByUrl(_).connect(),this.$forceUpdate()}}this.plugin_loaded=!0,this.event_bus.emit("plugins_loaded",this.pm.plugins),e.prev=103,v=this.pm.reloadRepository(),this.event_bus.emit("repositories_loaded",v);case 106:if(e.prev=106,!t.query.start&&!t.query.s){e.next=155;break}if(w=t.query.start||t.query.s,b=this.pm.installed_plugins.filter(function(e){return e.name===w}),this.showAddPluginDialog||!(b.length<=0)){e.next=114;break}alert('Plugin "'.concat(w,'" cannot be started, please install it.')),e.next=155;break;case 114:if(y=Object(j["b"])(t.query),x=t.query.load||t.query.l,!x){e.next=129;break}return e.prev=117,e.next=120,p.a.get(x);case 120:C=e.sent,y.loaded=C.data,e.next=129;break;case 124:e.prev=124,e.t4=e["catch"](117),console.error(e.t4),this.showMessage("Failed to load data from:"+x+" Error:"+e.t4.toString()),y.loaded=null;case 129:if(this.showAddPluginDialog||!this.pm.registered.windows[w]&&!w.startsWith("imjoy/")){e.next=151;break}return e.prev=130,O=this.pm.registered.windows[w]||{},P=Object(j["b"])(O.defaults)||{},P.type=w,P.name=w,P.w=P.w||t.query.w,P.h=P.h||t.query.h,P.tag=O.tag,P.fullscreen=t.query.fullscreen||P.fullscreen||!1,P.standalone=t.query.standalone||P.standalone||!1,P.data=y,P.config={},e.next=144,this.createWindow(P);case 144:e.next=149;break;case 146:e.prev=146,e.t5=e["catch"](130),console.error("Plugin ".concat(w," failed to load data."),e.t5);case 149:e.next=155;break;case 151:E=null,D=function e(t){if(t.name===w){try{t.api.run({data:y,config:{}})}catch(n){console.error("Plugin ".concat(w," failed to load data."),n)}I.event_bus.off("plugin_loaded",e)}E&&E.api.close&&E.api.close(),E=t},R=function e(t){t.name===w&&(I.event_bus.on("plugin_loaded",D),I.event_bus.off("plugin_installed",e))},this.event_bus.on("plugin_installed",R);case 155:return this.$nextTick(function(){I.event_bus.emit("imjoy_ready")}),e.finish(106);case 157:e.next=162;break;case 159:e.prev=159,e.t6=e["catch"](76),this.showMessage(e.t6);case 162:this.$forceUpdate(),this.$nextTick(function(){I.checkImJoyUpdate(),window.setInterval(function(){I.checkImJoyUpdate(!0)},12e5)});case 164:case"end":return e.stop()}},e,this,[[9,16],[30,37],[56,60,64,72],[65,,67,71],[76,159],[87,93],[103,,106,157],[117,124],[130,146]])}));return function(t){return e.apply(this,arguments)}}(),addWindowCallback:function(e){var t=this;return new Promise(function(n,i){if(t.wm.window_ids[e.id])try{e.api.on("refresh",function(){t.$forceUpdate()});var o=e.refresh;o&&(e.refresh=function(){t.$nextTick(function(){o()})}),t.$nextTick(function(){t.$forceUpdate(),n()})}catch(a){i(a)}else i("window was closed")})},createWindow:function(e){return this.pm.createWindow(null,e)},restartImJoy:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:window.location.reload(!0);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),checkImJoyUpdate:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.checking=!0,e.prev=1,e.next=4,p.a.get("https://imjoy.io/version.json?"+Object(j["l"])());case 4:if(n=e.sent,n&&n.data){e.next=8;break}return this.showMessage("Failed to fetch imjoy version information."),e.abrupt("return");case 8:i=n.data,i&&i.version?(this.latest_version=i.version,this.is_latest_version=Object(j["d"])(this.imjoy_version,">=",i.version),this.is_latest_version?t||(Object(j["d"])(this.imjoy_version,">",i.version)?this.showMessage("ð» Your ImJoy (v".concat(this.imjoy_version,") is newer than the release (v").concat(this.latest_version,").")):this.showMessage("ð ImJoy is up to date (version ".concat(this.latest_version,")."))):this.showMessage("ð£ A newer version of ImJoy (version ".concat(this.latest_version,") is available, please restart ImJoy."))):this.latest_version=null,e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),this.showMessage("Failed to fetch imjoy version information");case 15:return e.prev=15,this.checking=!1,e.finish(15);case 18:this.pm.checkUpdates();case 19:case"end":return e.stop()}},e,this,[[1,12,15,18]])}));return function(t){return e.apply(this,arguments)}}(),getDefaultInputLoaders:function(){var e=this,t=function(t){var n=new FileReader;n.onload=function(){e.createWindow({name:t.name,type:"imjoy/image",data:{type:"imjoy/image",src:n.result,file:t}})},n.readAsDataURL(t)},n=function(t){var n={name:"New Plugin",type:"imjoy/plugin-editor",config:{},plugin_manager:e.pm,engine_manager:e.em,w:30,h:20,standalone:e.screenWidth<1200,plugin:{},data:{type:"imjoy/code",name:"new plugin",id:"plugin_"+Object(j["l"])(),code:"",local_file_obj:t}};e.createWindow(n)},i=function(t){var n={name:"New Plugin",type:"imjoy/plugin-editor",config:{},plugin_manager:e.pm,engine_manager:e.em,w:30,h:20,standalone:e.screenWidth<1200,plugin:{},data:{type:"imjoy/code",name:"new plugin",id:"plugin_"+Object(j["l"])(),code:"",engine_file_obj:t}};e.createWindow(n)},o=function(t){var n=t.url.split("/"),i=n[n.length-1];e.createWindow({name:i,type:"imjoy/image",data:{type:"imjoy/image",src:t.url}})};return[{loader_key:"Code Editor (file)",schema:et.compile({properties:{type:{type:"string"},name:{type:"string",pattern:".*\\.imjoy.html$",maxLength:1024},size:{type:"number"}},required:["name","size","type"]}),loader:n},{loader_key:"Code Editor (url)",schema:et.compile({properties:{type:{type:"string",enum:["imjoy/url"]},url:{type:"string",pattern:".*\\.imjoy.html$",maxLength:1024},path:{type:"string"},engine:{type:"string"}},required:["url","path","engine"]}),loader:i},{loader_key:"Image (file)",schema:et.compile({properties:{type:{type:"string",enum:["image/jpeg","image/png","image/gif"]},size:{type:"number"}},required:["type","size"]}),loader:t},{loader_key:"Image (url)",schema:et.compile({properties:{type:{type:"string",enum:["imjoy/url"]},url:{type:"string",maxLength:1024,pattern:"(.*\\.jpg|\\.jpeg|\\.png|\\.gif)$"},path:{type:"string"},engine:{type:"string"}},required:["url","path","engine","type"]}),loader:o}]},updateSize:function(e){this.screenWidth=e.width,this.wm&&(this.screenWidth>800?(0===this.windows.length&&(this.wm.window_mode="grid"),this.max_window_buttons=9):(0===this.windows.length&&(this.wm.window_mode="single"),this.max_window_buttons=parseInt(this.screenWidth/36-4),this.max_window_buttons>9&&(this.max_window_buttons=9)),this.wm.resizeAll()),this.$forceUpdate()},showEngineConnection:function(e,t){this.event_bus.emit("show_engine_dialog",{show:e,engine:t})},getRepository:function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=this.pm.repository_list[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.name===e)return r}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}},selectRepository:function(e){var t=this,n=!0,i=!1,o=void 0;try{for(var a,r=this.pm.repository_list[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(s.name===e)return this.pm.reloadRepository(s).then(function(){t.$forceUpdate()}),s}}catch(c){i=!0,o=c}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}},switchEngine:function(e,t){var n=this;e.config.engine_mode=t&&t.name||"auto",this.pm.savePlugin(e.config).then(function(e){n.pm.reloadPlugin(e)}).catch(function(e){n.showMessage("Failed to save settings: "+e.toString())})},switchTag:function(e,t){var n=this;e.config.tag=t,this.pm.savePlugin(e.config).then(function(e){n.pm.reloadPlugin(e)}).catch(function(e){n.showMessage("Failed to save settings: "+e.toString())})},connectPlugin:function(e){e._disconnected&&(e.engine&&!e.engine.connected?e.engine.connect():this.pm.reloadPlugin(e.config))},getPlugin4Install:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.plugin4install=null,this.downloading_error="",this.downloading_plugin=!0,e.prev=3,e.next=6,this.pm.getPluginFromUrl(t);case 6:return n=e.sent,this.pm.plugin_names[n.name]&&(Object(j["d"])(n.version,">",this.pm.plugin_names[n.name].config.version)?n._installation_text="Upgrade":Object(j["d"])(n.version,"<",this.pm.plugin_names[n.name].config.version)&&(n._installation_text="Downgrade")),this.plugin4install=n,this.tag4install=n.tag,this.downloading_plugin=!1,e.abrupt("return",n);case 14:throw e.prev=14,e.t0=e["catch"](3),this.downloading_plugin=!1,this.downloading_error="Failed to fetch plugin, error: ".concat(e.t0),this.showMessage(this.downloading_error),e.t0;case 20:case"end":return e.stop()}},e,this,[[3,14]])}));return function(t){return e.apply(this,arguments)}}(),showPluginManagement:function(){this.plugin4install=null,this.downloading_error="",this.downloading_plugin=!1,this.init_plugin_search="",this.show_plugin_templates=!0,this.show_plugin_store=!0,this.show_plugin_url=!0,this.showAddPluginDialog=!0;var e=!0,t=!1,n=void 0;try{for(var i,o=this.pm.repository_list[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.name===this.pm.default_repository_list[0].name&&this.selectRepository(a.name)}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}},sortedRunnablePlugins:function(){return S.a.orderBy(this.pm.plugins,"name").filter(function(e){return e.config.runnable})},sortedNonRunnablePlugins:function(){return S.a.orderBy(this.pm.plugins,"name").filter(function(e){return!e.config.runnable})},switchWorkspace:function(e){if(!e||""==e.trim())throw this.showMessage("Workspace name should not be empty."),"Workspace name should not be empty.";var t={workspace:e};"default"===e&&(t=null),this.$router.push({name:"app",query:t}),window.location.reload()},removeWorkspace:function(e){var t=this,n=this.pm.selected_workspace===e.name;this.pm.removeWorkspace(e).then(function(){t.showMessage("Workspace ".concat(e," has been deleted.")),n&&t.$router.replace({query:{w:"default"}})}).catch(function(e){t.showMessage(e)})},showMessage:function(e,t){e=String(e),this.snackbar_info=e,t&&(t*=1e3),this.snackbar_duration=t||1e4,this.show_snackbar=!0,this.status_text=e,this.$forceUpdate()},showFileManagerDialog:function(){var e=this;this.showFileDialog(this.IMJOY_PLUGIN,{uri_type:"url",root:"./"}).then(function(t){if(e.screenWidth<=800&&(e.menuVisible=!1),t){var n=e.wm.getDataLoaders(t),i=Object.keys(n);if(i.length>1){var o={name:"Engine Files",type:"imjoy/generic",scroll:!0,data:t};e.createWindow(o)}else if(1===i.length)e.wm.registered_loaders[n[i[0]]](t);else{Array.isArray(t)||(t=[t]);var a=[],r=!0,s=!1,c=void 0;try{for(var l,u=t[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var d=l.value;d.url?a.push(d):a.push({url:d})}}catch(m){s=!0,c=m}finally{try{r||null==u.return||u.return()}finally{if(s)throw c}}var p={name:"Files",type:"imjoy/url_list",scroll:!0,data:a};e.createWindow(p)}}}).catch(function(e){throw e})},processPermission:function(e){e&&this.resolve_permission?(this.resolve_permission(),this.resolve_permission=null):this.reject_permission?(this.reject_permission("Permission Denied!"),this.reject_permission=null):console.error("permission handler not found.")},showDoc:function(e){var t=this.pm.plugins[e],n=t.config,i={name:"About "+n.name,type:"imjoy/markdown",w:20,h:10,scroll:!0,data:{name:n.name,id:t.id,plugin_info:n,source:n&&n.docs[0]&&n.docs[0].content}};this.createWindow(i)},clearPluginUrl:function(){var e=Object.assign({},this.$route.query);delete e.upgrade,this.$router.replace({query:e})},sharePlugin:function(e){var t=this.pm.plugins[e],n=t.config,i="".concat(location.protocol,"//").concat(location.hostname).concat(location.port?":"+location.port:"","/#/app/?p=").concat(n.origin);this.showAlert(null,{content:'<h3>Sharing "'.concat(t.name,'"</h3> <br> <a style="word-wrap: break-word;" href="').concat(encodeURI(i),'" target="_blank">').concat(i,'</a> <br> (Right click on the link and select "Copy Link Address")')});var o=Object.assign({},this.$route.query);o.p=n.origin,this.$router.replace({query:o})},downloadPlugin:function(e){var t=this.pm.plugins[e],n=t.config,i=t.name+"_"+Object(j["l"])()+".imjoy.html",o=new Blob([n.code],{type:"text/plain;charset=utf-8"});Object(u["saveAs"])(o,i)},installPlugin:function(e,t){var n=this;this.installing=!0,this.pm.installPlugin(e,t).then(function(e){n.showAddPluginDialog=!1,n.clearPluginUrl(e),n.$forceUpdate()}).finally(function(){n.installing=!1})},updatePlugin:function(e){var t=this,n=this.pm.plugins[e],i=n.config;i.origin?(this.showMessage("Fetching plugin file..."),this.getPlugin4Install(i.origin).then(function(){t.showStatus(null," "),t.show_plugin_templates=!1,t.showAddPluginDialog=!0,t.init_plugin_search=null,t.show_plugin_store=!1,t.show_plugin_url=!1}).catch(function(e){t.showMessage("Failed to fetch plugin source code (".concat(e,").")),console.error(e)})):this.showAlert(null,"Origin not found for this plugin.")},reloadPlugin:function(e){var t=this;this.pm.unloadPlugin(e),this.$nextTick(function(){t.pm.reloadPlugin(e).finally(function(){t.$forceUpdate()})})},unloadPlugin:function(e){this.pm.unloadPlugin(e)},removePlugin:function(e){var t=this;this.showConfirm(null,{title:"Removing Plugin",content:"Do you really want to <strong>delete</strong> this plugin",confirm_text:"Yes"}).then(function(n){n&&t.pm.removePlugin(e)})},logPlugin:function(e){console.log(e,this.pm,this.em,this.fm)},startTerminal:function(e){e.startTerminal()},editPlugin:function(e){var t=this.pm.plugins[e],n=t.config,i={name:"Edit-"+n.name||!1,type:"imjoy/plugin-editor",config:t.config,plugin:t,plugin_manager:this.pm,engine_manager:this.em,w:30,h:20,standalone:this.screenWidth<1200,data:{name:n.name,id:t.id,code:n.code}};this.createWindow(i)},newPlugin:function(e){var t={name:"New Plugin",type:"imjoy/plugin-editor",config:{},plugin_manager:this.pm,engine_manager:this.em,w:30,h:20,standalone:this.screenWidth<1200,plugin:null,data:{type:"imjoy/code",name:"new plugin",id:"plugin_"+Object(j["l"])(),code:JSON.parse(JSON.stringify(e))}};this.createWindow(t)},loadFiles:function(e){if(1===e.length){var t=e[0],n=this.wm.getDataLoaders(t),i=Object.keys(n);if(1===i.length)try{return this.wm.registered_loaders[n[i[0]]](t)}catch(s){console.error("Failed to load with the matched loader ".concat(n[0]),s)}}for(var o=0;o<e.length;o++){var a=e[o];a.loaders=a.loaders||this.wm.getDataLoaders(a)}var r={name:"Files",type:"imjoy/files",config:{},select:-1,_op:"__file_loader__",_source_op:null,_workflow_id:"files_"+Object(j["l"])(),_transfer:!1,data:e};this.createWindow(r)},clearWorkflow:function(){this.workflow_joy_config.data=null,this.$refs.workflow.setupJoy(!0)},runWorkflow:function(e){var t=this;this.status_text="",this.progress=0;var n=this.wm.active_windows[this.wm.active_windows.length-1]||{},i=this.pm.plugin2joy(n)||{};i.target=i.target||{},i.target._op="workflow",i.target._source_op=null,i.target._workflow_id=i.target._workflow_id||"workflow_"+Object(j["l"])(),e.workflow.execute(i.target).catch(function(e){console.error(e),t.showMessage(e||"Error.",12)})},loadWorkflow:function(e){this.workflow_joy_config.data=JSON.parse(e.workflow),this.$refs.workflow.setupJoy(!0)},loadWorkfowFromUrl:function(){var e=this,t=Fe["a"].decodeWorkflow(this.$route.query.workflow);if(t)try{this.workflow_expand=!0,this.workflow_joy_config.data=JSON.parse(t),this.$nextTick(function(){try{e.$refs.workflow.setupJoy(!0);var t=Object.assign({},e.$route.query);delete t.workflow,e.$router.replace({query:t})}catch(n){console.error(n),e.showMessage("Failed to load workflow: "+n)}})}catch(n){console.error(n),this.showMessage("Failed to parse workflow: "+n)}else console.log("failed to workflow")},shareWorkflow:function(e){var t=Fe["a"].encodeWorkflow(e.workflow);this.showAlert(null,{content:'<h3>Sharing Workflow</h3><a style="word-wrap: break-word;" href="'.concat(location.protocol,"//").concat(location.hostname).concat(location.port?":"+location.port:"","/#/app/?workflow=").concat(t,'" target="_blank">').concat(location.protocol,"//").concat(location.hostname).concat(location.port?":"+location.port:"","/#/app/?workflow=").concat(t,'</a><br> (Right click on the link and select "Copy Link Address")')})},runOp:function(e){var t,n=this;if(!e||!e.name)throw"op not found.";if(this.status_text="",this.progress=0,e.inputs_schema){var i=this.wm.active_windows[this.wm.active_windows.length-1]||{};t=i.data&&e.inputs_schema(i.data)&&this.pm.plugin2joy(i)||{}}else t={};t.target=t.target||{},t.target._op=e.name,t.target._source_op=null,t.target._workflow_id=t.target._workflow_id||"op_"+e.name.trim().replace(/ /g,"_")+Object(j["l"])(),e.joy.__op__.execute(t.target).then(function(e){var t=n.pm.joy2plugin(e);t&&!e.__as_interface__&&(t.name=t.name||"result",t.type=t.type||"imjoy/generic",n.createWindow(t)),n.progress=100}).catch(function(t){n.showMessage("<"+e.name+">"+(t||"Error."),15)}),this.screenWidth<=800&&(this.menuVisible=!1)},selectFileChanged:function(e){this.selected_file=e.target.files[0],this.selected_files=e.target.files;for(var t=0;t<e.target.files.length;t++){var n=e.target.files[t];n.relativePath=n.webkitRelativePath,n.loaders=this.wm.getDataLoaders(n)}this.loadFiles(this.selected_files)},showSnackbar:function(e,t,n){t=String(t),this.snackbar_info=t,n&&(n*=1e3),this.snackbar_duration=n||1e4,this.show_snackbar=!0,this.$forceUpdate()},showFileDialog:function(e,t){if(t=t||{},e&&e.id){if(t.file_manager?"string"===typeof t.file_manager&&(t.file_manager=this.fm.getFileManagerByUrl(t.file_manager)):e.api.FILE_MANAGER_URL&&(t.file_manager=this.fm.getFileManagerByUrl(e.api.FILE_MANAGER_URL)),t.root=t.root||e.config&&e.config.work_dir,t.uri_type=t.uri_type||"path",t.root&&"string"!==typeof t.root)throw"You need to specify a root with string type ";e.config.api_version&&Object(j["d"])(e.config.api_version,"<=","0.1.3")?t.return_object=void 0!==t.return_object&&t.return_object:t.return_object=void 0===t.return_object||t.return_object}return t.file_manager&&t.hide_unselected?this.selected_file_managers=[t.file_manager]:this.selected_file_managers=this.fm.fileManagers,this.$refs["file-dialog"].showDialog(e,t)},uploadFileToUrl:function(e,t){var n=this;if("object"!==Object(l["a"])(t)||!t.file||!t.url)throw"You must pass an object contains keys named `file` and `url`";return console.warn("WARNING: api.uploadFileToUrl is deprecated and it will be removed soon."),e=e||{},new Promise(function(i,o){var a=new FormData;a.append("file",new Blob([t.file],{type:t.file.type||"application/octet-stream"})),n.showMessage("Uploading a file to "+t.url);var r=null;p()({method:"post",url:t.url,data:a,headers:t.headers||{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){if(r=r||e.lengthComputable?e.total:e.target.getResponseHeader("content-length")||e.target.getResponseHeader("x-decompressed-content-length"),null!==r){var i=100*e.loaded/r;parseInt(i)%5==0&&(n.showProgress(null,i),n.$forceUpdate())}t.progress&&t.progress(e.loaded,r)}}).then(function(a){200!==a.status?(console.error(a),o(a.statusText)):(n.showMessage("File uploaded to ".concat(t.url)),e.log&&e.log("File uploaded to ".concat(t.url)),i(a.data))}).catch(function(e){n.showMessage("Failed to upload files, error: ".concat(e.status)),console.error(e),o(e.status)})})},downloadFileFromUrl:function(e,t){var n=this;if("object"!==Object(l["a"])(t)||!t.url)throw"You must pass an object contains keys named `url`";return console.warn("WARNING: api.uploadFileToUrl is deprecated and it will be removed soon."),new Promise(function(e,i){n.showMessage("Downloading from "+t.url);var o=null;p.a.get({url:t.url,method:t.method||"GET",responseType:t.responseType||"blob",onDownloadProgress:function(e){if(o=o||e.lengthComputable?e.total:e.target.getResponseHeader("content-length")||e.target.getResponseHeader("x-decompressed-content-length"),null!==o){var i=100*e.loaded/o;parseInt(i)%5==0&&(n.showProgress(null,i),n.$forceUpdate())}t.progress&&t.progress(e.loaded,o)}}).then(function(o){200!==o.status?(console.error(o),i(o.statusText)):(n.showMessage("File downloaded from ".concat(t.url)),e(o.data))}).catch(function(e){n.showMessage("Failed to download files, error: ".concat(e.statusText)),console.error(e),i(e.statusText)})})},showProgress:function(e,t){this.progress=t<1?100*t:t},showStatus:function(e,t){this.status_text=String(t),this.screenWidth<500&&this.showMessage(t)},showDialog:function(e,t){var n=this;return t.dialog=!0,t.type=t.type||"imjoy/joy",this.showPluginDialog=!0,this.dialog_auto_height="700px",this.dialog_window_config.fullscreen=t.fullscreen||t.standalone||!1,new Promise(function(i,o){n.pm.createWindow(e,t).then(function(e){e.on("window_size_changed",function(e){n.dialog_auto_height="".concat(e.height+40,"px"),n.$forceUpdate()},!0),e.on("close",function(){n.showPluginDialog=!1}),"imjoy/joy"===t.type?(t.ok=function(){n.closePluginDialog(t),i(t.get_config())},t.cancel=function(){n.closePluginDialog(t),i()}):i(e)}).catch(function(e){n.showAlert(null,e),n.showPluginDialog=!1,o(e)})})},closePluginDialog:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.close();case 2:this.dialogWindows.forEach(function(e){e.close()}),this.showPluginDialog=!1;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showAlert:function(e,t){console.log("alert: ",t),"string"===typeof t?(this.alert_config.title=null,this.alert_config.content=Object(j["f"])(t).replace(/\n/g,"<br>"),this.alert_config.confirm_text="OK"):"object"===Object(l["a"])(t)&&t.content?(this.alert_config.title=t.title,this.alert_config.content=O.a.sanitize(String(t.content))||"undefined",this.alert_config.confirm_text=t.confirm_text||"OK"):this.alert_config.content=JSON.stringify(t),this.alert_config.show=!0,this.$forceUpdate()},showPrompt:function(e,t,n){var i=this;return new Promise(function(e,o){if("string"===typeof t)i.prompt_config.title=null,i.prompt_config.content=Object(j["f"])(t).replace(/\n/g,"<br>"),i.prompt_config.placeholder=n,i.prompt_config.cancel_text="Cancel",i.prompt_config.confirm_text="OK";else{if("object"!==Object(l["a"])(t)||!t.content)throw o("unsupported prompt arguments"),"unsupported prompt arguments";i.prompt_config.title=t.title,i.prompt_config.content=O.a.sanitize(String(t.content))||"undefined",i.prompt_config.placeholder=t.placeholder||null,i.prompt_config.cancel_text=t.cancel_text||"Cancel",i.prompt_config.confirm_text=t.confirm_text||"OK"}i.prompt_config.confirm=function(){e(i.prompt_config.value||i.prompt_config.placeholder)},i.prompt_config.cancel=function(){o()},i.prompt_config.show=!0})},showConfirm:function(e,t){var n=this;return new Promise(function(e,i){if("string"===typeof t)n.confirm_config.title=null,n.confirm_config.content=Object(j["f"])(t).replace(/\n/g,"<br>"),n.confirm_config.cancel_text="Cancel",n.confirm_config.confirm_text="OK";else{if("object"!==Object(l["a"])(t)||!t.content)throw i("unsupported prompt arguments"),"unsupported prompt arguments";n.confirm_config.title=t.title,n.confirm_config.content=O.a.sanitize(String(t.content))||"undefined",n.confirm_config.cancel_text=t.cancel_text||"Cancel",n.confirm_config.confirm_text=t.confirm_text||"OK"}n.confirm_config.confirm=function(){e(!0)},n.confirm_config.cancel=function(){e(!1)},n.confirm_config.show=!0})},showLog:function(e){var t={name:"Log (".concat(e.name,")"),type:"imjoy/log",data:{plugin_id:e.id,plugin_name:e.name,log_history:e._log_history}};this.createWindow(t)},openUrl:function(e,t){Object(j["c"])(t),Object.assign(document.createElement("a"),{target:"_blank",href:t}).click()},sleep:function(e,t){return Object(j["c"])(t),new Promise(function(e){return setTimeout(e,Math.round(1e3*t))})}}},nt=tt,it=(n("fb5a"),n("2877")),ot=Object(it["a"])(nt,r,s,!1,null,"6e83626c",null);ot.options.__file="Imjoy.vue";var at=ot.exports,rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("a",{attrs:{href:"https://github.com/imjoy-team/imjoy-engine",target:"_blank"}},[n("img",{attrs:{src:"https://img.shields.io/badge/imjoy-v"+e.app_version+"-success.svg",alt:"ImJoy"}})]),e._v("Â \n  "),e._m(0),e._v("Â \n  "),e._m(1),e._v("Â \n\n  "),e._m(2),e._v("Â \n  "),e._m(3),e._v("Â \n  "),n("br"),n("br"),n("img",{staticStyle:{width:"300px"},attrs:{src:"static/img/imjoy-logo-black.svg"}}),n("br"),n("md-button",{staticClass:"normal-text",attrs:{href:"https://github.com/imjoy-team",target:"_blank"}},[e._v("Version: "+e._s(e.app_version)+" "),n("br"),e._v("\n    Made by the ImJoy-Team with "),n("span",{staticClass:"red"},[e._v("â¤")])]),n("br"),n("br"),e._m(4),e._m(5),n("p",[e._v("Main Contributors:")]),e._m(6),e._m(7),n("p",[e._v("This project is mainly funded by")]),e._m(8)],1)},st=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://github.com/imjoy-team/imjoy-engine",target:"_blank"}},[n("img",{attrs:{src:"https://img.shields.io/badge/dynamic/json.svg?color=success&label=imjoy%20engine&prefix=v&query=version&url=https%3A%2F%2Fraw.githubusercontent.com%2Fimjoy-team%2Fimjoy-engine%2Fmaster%2Fimjoy%2FVERSION",alt:"ImJoy-Engine"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://travis-ci.com/imjoy-team/ImJoy",target:"_blank"}},[n("img",{attrs:{src:"https://travis-ci.com/imjoy-team/ImJoy.svg?branch=master",alt:"Travis-CI"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://zenodo.org/badge/latestdoi/137741898",target:"_blank"}},[n("img",{attrs:{src:"https://zenodo.org/badge/137741898.svg",alt:"DOI"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://github.com/imjoy-team/ImJoy",target:"_blank"}},[n("img",{attrs:{src:"https://img.shields.io/github/license/imjoy-team/imjoy-engine.svg",alt:"LICENSE"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n    The ImJoy project was originally carried out in\n    "),n("a",{attrs:{href:"https://research.pasteur.fr/en/team/imaging-and-modeling/",target:"_blank"}},[e._v("Imaging and Modeling Unit")]),e._v("\n    at Institut Pasteur.\n  ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n    Ongoing development of ImJoy is mainly supported by the\n    "),n("a",{attrs:{href:"https://cellprofiling.org/",target:"_blank"}},[e._v("Cell Profiling Group")]),e._v("\n    headed by Emma Lundberg at\n    "),n("a",{attrs:{href:"https://www.scilifelab.se/",target:"_blank"}},[e._v("SciLifeLab")]),e._v(".\n  ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[e._v("Wei OUYANG")]),n("li",[e._v("Florian MUELLER")]),n("li",[e._v("Martin HJELMARE")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n    We also thank\n    "),n("a",{attrs:{href:"https://sites.google.com/site/imagingandmodeling/people",target:"_blank"}},[e._v("all the team members")]),e._v("\n    from the Imaging and Modeling Unit and people who have been using,\n    testing, contributing valuable feedbacks and suggestions for improving\n    ImJoy.\n  ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[n("img",{staticStyle:{width:"150px",margin:"10px"},attrs:{src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}}),e._v("\n      Â Â \n      "),n("img",{staticStyle:{width:"150px",margin:"10px"},attrs:{src:"static/img/logga-KAW-300x155.png"}})])])}],ct={name:"about",created:function(){this.app_version=x["a"]}},lt=ct,ut=(n("7f55"),Object(it["a"])(lt,rt,st,!1,null,"11783b62",null));ut.options.__file="About.vue";var dt=ut.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("a",{staticClass:"github-corner",attrs:{href:"https://github.com/imjoy-team/ImJoy","aria-label":"View source on Github"}},[n("svg",{attrs:{viewBox:"0 0 250 250","aria-hidden":"true"}},[n("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),n("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),n("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])]),n("section",{staticClass:"cover show",staticStyle:{background:"rgb(209, 220, 239)"}},[n("div",{attrs:{id:"particles-js"}}),n("div",{staticClass:"cover-main"},[e._m(0),n("h1",[e._v("Deep Learning Made Easy!")]),n("p",{staticClass:"badges"},[n("a",{attrs:{href:"https://github.com/imjoy-team/ImJoy",target:"_blank"}},[n("img",{attrs:{src:"https://img.shields.io/badge/imjoy-v"+e.app_version+"-success.svg",alt:"ImJoy"}})]),e._v("\n        Â \n\n        "),e._m(1),e._v("Â \n        "),e._m(2),e._v("Â \n      ")]),e._m(3)]),n("div",{staticClass:"mask"})])])},mt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("img",{attrs:{src:"/static/img/imjoy-logo-black.svg?sanitize=true",width:"380"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://travis-ci.com/imjoy-team/ImJoy",target:"_blank"}},[n("img",{attrs:{src:"https://travis-ci.com/imjoy-team/ImJoy.svg?branch=master",alt:"Travis-CI"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://github.com/imjoy-team/ImJoy",target:"_blank"}},[n("img",{attrs:{src:"https://img.shields.io/github/license/imjoy-team/imjoy-engine.svg",alt:"LICENSE"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("a",{attrs:{href:"https://rdcu.be/bYbGO",target:"_blank"}},[e._v("Publication")]),n("a",{attrs:{href:"/docs"}},[e._v("Docs")]),n("a",{attrs:{href:"/repo",onclick:"removeWelcomePage()",target:"_self"}},[e._v("Plugins")]),n("a",{attrs:{href:"/#/app",onclick:"removeWelcomePage()",target:"_self"}},[e._v("Start ImJoy")])])}],ht={name:"home",created:function(){this.app_version=x["a"],document.addEventListener("DOMContentLoaded",function(){particlesJS.load("particles-js","/static/js/particlesjs-config.json",function(){console.log("particles.js config loaded")})})},beforeDestroy:function(){particlesJS.stop()}},ft=ht,gt=(n("12e7"),Object(it["a"])(ft,pt,mt,!1,null,"eaa88410",null));gt.options.__file="Home.vue";var _t=gt.exports;o["default"].use(a["a"]);var vt={base:window.location.pathName,routes:[{path:"/",name:"Home",component:_t},{path:"/app",name:"app",component:at},{path:"/:)",redirect:{name:"joy"}},{path:"/%F0%9F%98%82",name:"joy",component:at},{path:"/imjoy",name:"Imjoy",component:at},{path:"/about",name:"About",component:dt},{path:"*",redirect:"/"}]},wt=new a["a"](vt),bt=n("43f9"),yt=n.n(bt),kt=(n("51de"),n("e094"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-app",{attrs:{id:"app","md-waterfall":"","md-mode":"fixed"}},[n("md-app-content",[n("router-view")],1)],1)}),xt=[],jt={name:"app",data:function(){return{}},mounted:function(){var e=this;this.$nextTick(function(){var t=function(){e.$root.$data.store.event_bus.emit("resize",{height:window.innerHeight,width:window.innerWidth})};t(),window.addEventListener("resize",t),document.addEventListener("orientationchange",t);var n=document.getElementById("welcome-page");n&&n.parentNode.removeChild(n);var i=document.getElementById("loading-imjoy-section");i&&i.parentNode.removeChild(i)})},methods:{},watch:{}},Ct=jt,Ot=(n("034f"),Object(it["a"])(Ct,kt,xt,!1,null,null,null));Ot.options.__file="App.vue";var Pt=Ot.exports,Et=n("7be8"),Dt=n.n(Et),Rt=Ze.a.create(),It={event_bus:Rt},Wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("md-button",{staticClass:"site-title",on:{click:function(t){e.$router.push("/")}}},[n("img",{staticClass:"site-title",attrs:{src:"static/img/imjoy-logo-white.svg",alt:"ImJoy"}}),n("span",{staticClass:"superscript"},[e._v("beta")])]),n("span",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path != '/'"}],staticClass:"md-layout-item md-medium-hide subheader-title"},[e._v("Deep Learning Made Easy!")]),n("div",{staticClass:"md-toolbar-section-end"},[e.screenWidth<600?n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-primary md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("menu")])],1),n("md-menu-content",[n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path != '/'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/")}}},[e._v("Home")]),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/app"!=e.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/app")}}},[e._v("Start ImJoy")]),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"https://github.com/imjoy-team/ImJoy"}},[e._v("Source")]),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"/docs"}},[e._v("Docs")]),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/about"!=e.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-primary md-button menu-button",on:{click:function(t){e.$router.push("/about")}}},[e._v("About")])],1)],1):e._e(),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/"!=e.$route.path,expression:"$route.path != '/'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/")}}},[n("md-icon",[e._v("home")]),e._v(" Home\n        "),n("md-tooltip",[e._v("Home Page")])],1):e._e(),e._v("\n      Â \n      "),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/app"!=e.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/app")}}},[n("md-icon",{staticClass:"md-size-1x svg-icon",attrs:{"md-src":"static/img/imjoy-icon-white.svg"}}),e._v("\n        ImJoy App\n        "),n("md-tooltip",[e._v("Start ImJoy App")])],1):e._e(),e._v("\n      Â \n      "),e.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"https://github.com/imjoy-team/ImJoy",target:"_blank"}},[n("md-icon",{staticClass:"md-size-1x svg-icon",attrs:{"md-src":"static/img/github.svg"}}),e._v("source\n        "),n("md-tooltip",[e._v("Source code on Github")])],1):e._e(),e._v("\n      Â \n      "),e.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"/docs"}},[n("md-icon",[e._v("library_books")]),e._v("Docs\n        "),n("md-tooltip",[e._v("Documentation")])],1):e._e(),e._v("\n      Â \n      "),e.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/about"!=e.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-accent",on:{click:function(t){e.$router.push("/about")}}},[n("md-icon",[e._v("info")]),e._v(" About\n        "),n("md-tooltip",[e._v("About ImJoy.io")])],1):e._e()],1)],1)])},Mt=[],St={name:"navbar",data:function(){return{screenWidth:window.innerWidth}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus},mounted:function(){this.screenWidth=window.innerWidth,this.event_bus.on("resize",this.updateSize)},beforeDestroy:function(){this.event_bus.off("resize",this.updateSize)},methods:{updateSize:function(e){this.screenWidth=e.width},shareOnTwitter:function(){var e="https://imjoy.io",t=" #ImJoy ";window.open("http://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(t),"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")}}},At=St,$t=(n("2d2f"),Object(it["a"])(At,Wt,Mt,!1,null,"fbddfd62",null));$t.options.__file="Navbar.vue";var Ut=$t.exports,Tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"/app"!=e.$route.path&&"/app"!=e.$route.path?n("div",{staticClass:"footer"},[n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"md-accent footer-button",attrs:{target:"_blank",href:"https://github.com/imjoy-team/ImJoy/issues"}},[e._v("Create an issue on Github")])],1),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://creativecommons.org/licenses/by/4.0/",target:"_blank"}},[n("md-tooltip",[e._v("Except where otherwise noted, content on this site is licensed under\n        a Creative Commons Attribution 4.0 International license.")]),n("img",{attrs:{id:"cc-by-img",src:"static/img/by.svg",alt:"CC BY 4.0"}})],1),n("md-button",{staticClass:"footer-button",on:{click:function(t){e.$router.push("/about")}}},[e._v("About ImJoy.io")])],1),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://github.com/imjoy-team",target:"_blank"}},[e._v("Made by the ImJoy Team with "),n("span",{staticClass:"red"},[e._v("â¤")])]),n("md-button",{staticClass:"footer-button",attrs:{target:"_blank",href:"https://sites.google.com/site/imagingandmodeling/"}},[e._v("Powered by Imaging and Modeling Unit")]),e._m(0)],1)]):e._e()},Ft=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[n("img",{attrs:{id:"ip-img",src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}})])}],Lt={name:"main-footer",data:function(){return{mode:"about",showDialog:!1,showQuestion:!1}},created:function(){this.store=this.$root.$data.store},mounted:function(){},methods:{}},Nt=Lt,qt=(n("3145"),Object(it["a"])(Nt,Tt,Ft,!1,null,"48776f65",null));qt.options.__file="Footer.vue";var zt=qt.exports,Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"whiteboard",staticClass:"whiteboard noselect",on:{mouseup:function(t){e.show_overlay=!1},click:function(t){e.unselectWindows(t)}}},[e.show_overlay?n("div",{staticClass:"overlay",on:{mousemove:e.overlayMousemove,click:function(t){e.show_overlay=!1}}}):e._e(),e.gridWindows?n("grid-layout",{directives:[{name:"show",rawName:"v-show",value:!e.wm.selected_window&&e.gridWindows.length>0,expression:"!wm.selected_window && gridWindows.length > 0"}],ref:"window_grid",staticStyle:{"min-height":"100%"},attrs:{layout:e.gridWindows,"col-num":e.col_num,"is-mirrored":!1,"auto-size":!0,"row-height":e.row_height,"is-responsive":!0,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!0,margin:[3,3],"use-css-transforms":!0},on:{"update:layout":function(t){e.gridWindows=t},"update:colNum":function(t){e.col_num=t},"update:rowHeight":function(t){e.row_height=t}}},e._l(e.gridWindows,function(t){return n("grid-item",{key:t.id,attrs:{"drag-allow-from":".drag-handle","drag-ignore-from":".no-drag",x:t.x,y:t.y,w:t.w,h:t.h,i:t.i},on:{"update:w":function(n){e.$set(t,"w",n)},"update:h":function(n){e.$set(t,"h",n)},resize:function(n){e.viewChanging(t)},move:function(n){e.viewChanging(t)},resized:function(n){e.show_overlay=!1,t.resize&&t.resize(),e.focusWindow(t)},moved:function(n){e.show_overlay=!1,t.move&&t.move(),e.focusWindow(t)}}},[n("window",{attrs:{w:t,withDragHandle:!0,loaders:e.wm.registered_loaders},on:{detach:e.detach,duplicate:e.duplicate,select:e.selectWindow,close:e.close,fullscreen:e.fullScreen,normalsize:e.normalSize}})],1)})):e._e(),e.gridWindows&&0!==e.gridWindows.length?e._e():n("div",{staticClass:"md-layout md-gutter md-alignment-center-center"},[n("md-empty-state",{attrs:{"md-icon":"static/img/imjoy-io-icon.svg","md-label":"","md-description":""}})],1),e._l(e.standaloneWindows,function(t){return n("window",{directives:[{name:"show",rawName:"v-show",value:e.wm.selected_window===t,expression:"wm.selected_window === w"}],key:t.id+"_standalone",attrs:{w:t,loaders:e.wm.registered_loaders,withDragHandle:!1},on:{detach:e.detach,duplicate:e.duplicate,select:e.selectWindow,close:e.close,fullscreen:e.fullScreen,normalsize:e.normalSize}})})],2)},Jt=[],Kt={name:"whiteboard",props:{mode:{type:String,default:function(){return"grid"}},windowManager:{type:qe,default:function(){return null}}},data:function(){return{row_height:30,column_width:30,col_num:20,active_windows:[],show_overlay:!1,scrolling:!1,scrollClientY:0,screenWidth:window.innerWidth,windows:[]}},created:function(){this.wm=this.windowManager,this.windows=this.wm&&this.wm.windows,Object(j["c"])(this.windows),this.event_bus=this.wm.event_bus,this.event_bus.on("add_window",this.onWindowAdd),this.event_bus.on("close_window",this.onWindowClose),this.event_bus.on("resize",this.updateSize)},mounted:function(){this.screenWidth=window.innerWidth,this.col_num=parseInt(this.$refs.whiteboard.clientWidth/this.column_width),window.onbeforeunload=function(e){var t="Are you sure you want to leave?";return"undefined"==typeof e&&(e=window.event),e&&(e.returnValue=t),t}},beforeDestroy:function(){this.event_bus.off("add_window",this.onWindowAdd),this.event_bus.off("close_window",this.onWindowClose),this.event_bus.off("resize",this.updateSize)},computed:{gridWindows:function(){var e=this;return this.windows.filter(function(t){return!t.dialog&&!t.standalone&&"grid"===e.mode})},standaloneWindows:function(){var e=this;return this.windows.filter(function(t){return!t.dialog&&("grid"!==e.mode||t.standalone)})}},methods:{overlayMousemove:function(e){var t,n=this,i=this.$refs.whiteboard.getBoundingClientRect(),o=i.y,a=i.y+i.height;this.scrollClientY=e.clientY,this.scrollClientY<o+10?(t=function(){n.$refs.whiteboard.scrollTop=n.$refs.whiteboard.scrollTop-(o-n.scrollClientY)/2,n.show_overlay&&n.scrollClientY<o?(n.scrolling=!0,window.requestAnimationFrame(t)):n.scrolling=!1},this.scrolling||t()):this.scrollClientY>a-20&&(t=function(){n.$refs.whiteboard.scrollTop=n.$refs.whiteboard.scrollTop+(n.scrollClientY-a+20)/2,n.show_overlay&&n.scrollClientY>a-10?(n.scrolling=!0,window.requestAnimationFrame(t)):n.scrolling=!1},this.scrolling||t())},updateSize:function(e){this.screenWidth=e.width,this.col_num=parseInt(this.$refs.whiteboard.clientWidth/this.column_width)},onWindowAdd:function(e){e.fullscreen&&this.fullScreen(e),this.selectWindow(e,{}),this.$forceUpdate()},onWindowClose:function(){this.$forceUpdate()},detach:function(e){var t=this;this.close(e);var n=Object.assign({},e,{name:e.name,type:e.window_type,data:e.data,config:e.config,w:e.w,h:e.h,fullscreen:e.fullscreen,standalone:!0});this.$nextTick(function(){t.$emit("create",n)})},close:function(e){var t=this.active_windows.indexOf(e);t>=0&&(this.active_windows[t].selected=!1,this.active_windows[t].refresh(),this.active_windows.splice(t,1),this.wm.active_windows=this.active_windows,this.$emit("select",this.active_windows,null)),e.close(),this.$emit("close",e)},isTypedArray:function(e){return!!e&&void 0!==e.byteLength},fullScreen:function(e){e.fullscreen=!0,this.col_num=parseInt(this.$refs.whiteboard.clientWidth/this.column_width);var t=parseInt((this.$refs.whiteboard.clientHeight-76)/this.row_height),n=parseInt(this.$refs.whiteboard.clientWidth/this.column_width)+1;e._h=e.h,e._w=e.w,e.h=t,e.w=n,this.$refs.window_grid.layoutUpdate(),setTimeout(function(){e.resize(),e.refresh(),e.focus()},500)},normalSize:function(e){this.col_num=parseInt(this.$refs.whiteboard.clientWidth/this.column_width),e.fullscreen=!1,e.h=e._h||5,e.w=e._w||5,e._w=null,e._h=null,this.$refs.window_grid.layoutUpdate(),setTimeout(function(){e.resize(),e.refresh(),e.focus()},500)},duplicate:function(e){this.$emit("create",{name:e.name+Object(j["l"])(),type:e.window_type,data:e.data,config:e.config,w:e.w,h:e.h,fullscreen:e.fullscreen,standalone:e.standalone})},unselectWindows:function(e){if(e.target.classList.contains("vue-grid-layout")&&this.active_windows&&this.active_windows.length>0){for(var t=0;t<this.active_windows.length;t++)this.active_windows[t].selected=!1,this.active_windows[t].refresh();this.active_windows=[],this.wm.active_windows=this.active_windows,this.$emit("select",this.active_windows,null),this.$forceUpdate()}},selectWindow:function(e,t){if(e.selected=!0,e.refresh&&e.refresh(),this.active_windows.length<=0||this.active_windows[this.active_windows.length-1]!==e){if(!t.shiftKey)for(var n=0;n<this.active_windows.length;n++)this.active_windows[n].selected=!1,this.active_windows[n].refresh();t.shiftKey&&this.active_windows.length>0?this.active_windows.push(e):this.active_windows=[e],this.wm.active_windows=this.active_windows,this.$emit("select",this.active_windows,e)}else if(!t.shiftKey&&this.active_windows.length>1){for(var i=0;i<this.active_windows.length;i++)this.active_windows[i]!==e&&(this.active_windows[i].selected=!1),this.active_windows[i].refresh();this.active_windows=[e]}this.$forceUpdate()},viewChanging:function(){this.show_overlay=!0},focusWindow:function(e){this.show_overlay=!1,this.selectWindow(e,{})},stopDragging:function(){var e=this;setTimeout(function(){e.show_overlay=!1,e.$forceUpdate()},300)}}},Ht=Kt,Vt=(n("9e742"),Object(it["a"])(Ht,Bt,Jt,!1,null,"603c4155",null));Vt.options.__file="Whiteboard.vue";var Gt=Vt.exports,Yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"joy"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"joy-container"},[n("div",{ref:"editor",staticClass:"joy-editor"})])])},Xt=[],Zt={name:"joy",props:{show:{type:Boolean,default:function(){return!0}},config:{type:Object,default:function(){return{}}}},data:function(){return{joy:null,isRunning:!1}},created:function(){this.store=this.$root.$data.store},mounted:function(){setTimeout(this.setupJoy,500)},watch:{config:function(){this.setupJoy()}},methods:{editSource:function(){this.$emit("edit",this.config)},setupJoy:function(e){var t=this;!e&&this.joy&&(this.config.data=this.joy.top.data),this.$nextTick(function(){if(t.$refs.editor){t.$refs.editor.innerHTML="";var e={container:t.$refs.editor,init:Fe["a"].normalizeUI(t.config.ui)||"",data:t.config.data,modules:t.config.modules||["instructions","math"],onexecute:t.config.onexecute,onupdate:t.config.onupdate};try{t.joy=new Fe["a"](e)}catch(n){throw console.error("error occured when loading the workflow",n),e.data="",t.joy=new Fe["a"](e),n}t.config.joy=t.joy}})},runJoy:function(){this.$emit("run",this.joy)},stopJoy:function(){this.$emit("stop")}}},Qt=Zt,en=(n("27e7"),Object(it["a"])(Qt,Yt,Xt,!1,null,null,null));en.options.__file="Joy.vue";var tn=en.exports,nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"plugin-list"},[e.title?n("md-subheader",[e._v(e._s(e.title)+" "),e.name?n("span",[e._v(e._s(e.name))]):e._e()]):e._e(),e.description?n("p",[e._v(e._s(e.description))]):e._e(),n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("md-field",{staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[e._v("search")]),n("md-input",{attrs:{placeholder:"Search by name..."},on:{input:e.searchPlugin},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("md-button",{directives:[{name:"show",rawName:"v-show",value:!e.search&&e.pm&&e.pm.installPlugin,expression:"!search && pm && pm.installPlugin"}],staticClass:"md-button md-primary",attrs:{disabled:e.loading},on:{click:function(t){e.updateAll()}}},[n("md-icon",[e._v("update")]),n("span",{staticClass:"md-small-hide"},[e._v("Update All")])],1)],1),e.loading?n("div",{staticClass:"loading loading-lg floating",staticStyle:{left:"-30px"}}):e._e(),n("md-list",{staticClass:"md-triple-line md-dense"},e._l(e.searched_plugins,function(t,i){return n("div",{key:i},[n("md-list-item",[n("md-avatar",{staticClass:"md-xsmall-hide"},[n("plugin-icon",{attrs:{icon:t.icon}})],1),n("div",{staticClass:"md-list-item-text"},[n("span",[e._v(e._s(t.name+" "+t.badges))]),n("p",[e._v(e._s(t.description))]),n("p",e._l(t.tags,function(t){return n("span",{key:t},[e._v(e._s(t)+", ")])}))]),n("span",[e.pm&&e.pm.removePlugin&&t.installed?n("md-button",{staticClass:"md-icon-button md-list-action md-accent",attrs:{disabled:e.loading},on:{click:function(n){e.plugin2_remove_=t,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),n("md-tooltip",[e._v("Delete "+e._s(t.name))])],1):e._e(),e.pm&&e.pm.installPlugin&&!t.installed&&t.tags&&t.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action md-primary",attrs:{"md-menu-trigger":"",disabled:e.loading}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Install "+e._s(t.name))])],1),n("md-menu-content",e._l(t.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){e.install(t,i)}}},[n("md-icon",[e._v("cloud_download")]),e._v(e._s(i)+"\n              ")],1)}))],1):!t.installed&&e.pm&&e.pm.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",attrs:{disabled:e.loading},on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Install "+e._s(t.name))])],1):e._e(),t.installed&&e.pm&&e.pm.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",attrs:{disabled:e.loading},on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("update")]),n("md-tooltip",[e._v("Update "+e._s(t.name))])],1):e._e()],1),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{disabled:e.loading,"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[e._v("more_horiz")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){e.showDocs(t)}}},[n("md-icon",[e._v("description")]),e._v("Docs\n            ")],1),t.installed&&e.pm&&e.pm.installPlugin?n("md-menu-item",{on:{click:function(n){e.install(t)}}},[n("md-icon",[e._v("update")]),e._v("Update\n            ")],1):e._e(),t.installed&&e.pm&&e.pm.removePlugin?n("md-menu-item",{on:{click:function(n){e.plugin2_remove_=t.config,e.showRemoveConfirmation=!0}}},[n("md-icon",[e._v("delete_forever")]),e._v("Delete\n            ")],1):e._e(),n("md-menu-item",{on:{click:function(n){e.showCode(t)}}},[n("md-icon",[e._v("code")]),e._v("Code\n            ")],1)],1)],1)],1),n("md-divider")],1)})),n("md-dialog-confirm",{attrs:{"md-active":e.showRemoveConfirmation,"md-title":"Removing Plugin","md-content":"Do you really want to <strong>delete</strong> this plugin","md-confirm-text":"Yes","md-cancel-text":"Cancel"},on:{"update:mdActive":function(t){e.showRemoveConfirmation=t},"md-cancel":function(t){e.showRemoveConfirmation=!1},"md-confirm":function(t){e.remove(e.plugin2_remove_),e.showRemoveConfirmation=!1}}}),n("md-dialog",{staticClass:"editor-dialog",attrs:{"md-active":e.showEditor},on:{"update:mdActive":function(t){e.showEditor=t}}},[n("md-dialog-title",[e._v(e._s(e.plugin_name))]),n("md-dialog-content",[e.showEditor?n("plugin-editor",{staticClass:"code-editor",attrs:{title:"Plugin Editor"},model:{value:e.editorCode,callback:function(t){e.editorCode=t},expression:"editorCode"}}):e._e()],1),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.downloadCode()}}},[e._v("Download")]),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showEditor=!1}}},[e._v("Exit")])],1)],1),n("md-dialog",{attrs:{"md-active":e.showDocsDialog},on:{"update:mdActive":function(t){e.showDocsDialog=t}}},[n("md-dialog-content",[e.docs&&""!=e.docs.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px"},domProps:{innerHTML:e._s(e.sanitizedMarked(e.docs))}}):n("h3",[e._v("Oops, this plugin has no documentation!")])]),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.showDocsDialog=!1}}},[e._v("OK")])],1)],1)],1)},on=[],an=(n("386d"),n("0e54")),rn=n.n(an),sn={name:"plugin-list",props:{name:{type:String,default:null},description:{type:String,default:null},configUrl:{type:String,default:null},pluginManager:{type:[Ne,Object],default:null},workspace:{type:String,default:"default"},title:{type:String,default:null},initSearch:{type:String,default:null},center:{type:Boolean,default:!0},plugins:{type:Array,default:function(){return null}}},data:function(){return{loading:!1,search:"",editorCode:"",editorPlugin:null,showEditor:!1,plugin_name:"",containerWidth:500,uri_root:null,plugin_dir:null,manifest:null,available_plugins:[],searched_plugins:[],showRemoveConfirmation:!1,plugin2_remove_:null,showDocsDialog:!1,docs:null,pm:null}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus;var e=new rn.a.Renderer;e.link=function(e,t,n){var i=rn.a.Renderer.prototype.link.call(this,e,t,n);return i.replace("<a","<a target='_blank' ")},rn.a.setOptions({renderer:e}),O.a.addHook("afterSanitizeAttributes",function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}),this.sanitizedMarked=function(e){return O.a.sanitize(rn()(e))}},mounted:function(){var e=this;if(this.search=this.initSearch||"",this.containerWidth=this.$refs.container.offsetWidth,this.event_bus.on("resize",this.updateSize),this.pm=this.pluginManager,this.plugins)this.available_plugins=this.plugins,this.searched_plugins=this.plugins,this.search&&this.searchPlugin();else if(this.configUrl){var t=this.configUrl;(t.startsWith("https://raw.githubusercontent.com")||t.startsWith("https://gist.githubusercontent.com"))&&-1===t.indexOf("?")&&(t=t+"?"+Object(j["l"])()),p.a.get(t).then(function(t){if(t&&t.data&&t.data.plugins){e.manifest=t.data,e.available_plugins=e.manifest.plugins,e.searched_plugins=e.manifest.plugins;var n=e.manifest.uri_root;n.startsWith("http")||(n=e.configUrl.replace(new RegExp("manifest.imjoy.json$"),S.a.trim(n,"/")));for(var i=0;i<e.available_plugins.length;i++){var o=e.available_plugins[i];o.uri=o.uri||o.name+".html",o.uri.startsWith(n)||o.uri.startsWith("http")||(o.uri=n+"/"+o.uri),o._id=o._id||o.name.replace(/ /g,"_")}e.plugin_dir=e.manifest.uri_root,e.plugin_dir?(e.uri_root=location.protocol+"//"+location.host,e.plugin_dir.startsWith("http")||(e.plugin_dir=e.uri_root+e.plugin_dir)):(e.uri_root="",e.plugin_dir=""),e.search&&e.searchPlugin()}})}},beforeDestroy:function(){this.event_bus.off("resize",this.updateSize)},watch:{plugins:{handler:function(e){this.$data.available_plugins=e,this.$data.searched_plugins=e},deep:!0}},methods:{toLower:function(e){return e.toString().toLowerCase()},searchByName:function(e,t){var n=this;return t?e.filter(function(e){return n.toLower(e.name+" "+e.description).includes(n.toLower(t))}):e},searchPlugin:function(){this.searched_plugins=this.searchByName(this.available_plugins,this.search)},updateSize:function(){this.containerWidth=this.$refs.container.offsetWidth},downloadCode:function(){this.$emit("input",this.codeValue);var e=this.window&&this.window.plugin&&this.window.plugin.name?this.window.plugin.name+"_"+Object(j["l"])()+".imjoy.html":"plugin_"+Object(j["l"])()+".imjoy.html",t=new Blob([this.codeValue],{type:"text/plain;charset=utf-8"});Object(u["saveAs"])(t,e)},showDocs:function(e){var t=this;if(e.installed)this.pm.getPluginDocs(e._id).then(function(e){t.docs=e,t.showDocsDialog=!0,t.$forceUpdate()}).catch(function(t){console.log("error occured when editing ",e.name,t)});else{var n=e.uri;(n.startsWith("https://raw.githubusercontent.com")||n.startsWith("https://gist.githubusercontent.com"))&&-1===n.indexOf("?")&&(n=n+"?"+Object(j["l"])()),p.a.get(n).then(function(e){if(e&&e.data){var i=ge(e.data);t.docs=i.docs&&i.docs[0]&&i.docs[0].content,t.showDocsDialog=!0,t.$forceUpdate()}else alert("failed to get plugin code from "+n)})}},showCode:function(e){var t=this;if(e.installed)this.pm.getPluginSource(e._id).then(function(n){t.editorCode=n,t.editorPlugin=e,t.plugin_name="Plugin Source Code:"+e.name,t.showEditor=!0,t.$forceUpdate()}).catch(function(t){console.log("error occured when editing ",e.name,t)});else{var n=e.uri;(n.startsWith("https://raw.githubusercontent.com")||n.startsWith("https://gist.githubusercontent.com"))&&-1===n.indexOf("?")&&(n=n+"?"+Object(j["l"])()),p.a.get(n).then(function(i){i&&i.data?(t.editorCode=i.data,t.editorPlugin=e,t.plugin_name="Plugin Source Code",t.showEditor=!0,t.$forceUpdate()):alert("failed to get plugin code from "+n)})}},updateAll:function(){var e=this,t=[],n=!0,i=!1,o=void 0;try{for(var a,r=this.available_plugins[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;s.installed&&t.push(this.install(s,s.tag))}}catch(c){i=!0,o=c}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}Promise.all(t).then(function(){console.log("All plugins updated successfully."),e.$emit("message","All plugins updated successfully.")}).catch(function(t){console.error("Plugins updated with error.",t),e.$emit("message","Plugins updated with error.")})},install:function(e,t){var n=this;this.pm&&this.pm.installPlugin&&(this.loading=!0,this.$forceUpdate(),this.pm.installPlugin(e,t).then(function(){n.$forceUpdate()}).catch(function(e){n.$emit("message",e),n.$forceUpdate()}).finally(function(){n.loading=!1,n.$forceUpdate()}))},remove:function(e){var t=this;if(this.pm){var n=this.pm.removePlugin(e);n&&n.then(function(){t.$forceUpdate()}).catch(function(e){t.$emit("message",e),t.$forceUpdate()})}}}},cn=sn,ln=(n("f560"),Object(it["a"])(cn,nn,on,!1,null,"7ca9e2cb",null));ln.options.__file="PluginList.vue";var un=ln.exports,dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"plugin-editor"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loading loading-lg floating"}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"floating-text"},[e._v("Loading code...")]),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_form"},[n("input",{ref:"file_select",staticClass:"md-file",attrs:{type:"file",multiple:""},on:{change:e.fileSelected}})]),e.window?n("md-toolbar",{staticClass:"md-dense editor-toolbar md-layout",attrs:{"md-elevation":"1"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-menu",{attrs:{"md-size":"big"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("folder_open")]),n("md-tooltip",{staticClass:"md-medium-hide"},[e._v("Open File")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){e.$refs.file_form.reset(),e.$refs.file_select.click()}}},[n("md-icon",[e._v("insert_drive_file")]),e._v("Open Local File\n          ")],1),n("md-menu-item",{attrs:{disabled:e.window.engine_manager.engines.length<=0},on:{click:function(t){e.openEngineFile()}}},[n("md-icon",[e._v("add_to_queue")]),e._v("Open Engine File\n            "),n("md-tooltip",[e._v("Load files through Plugin Engine")])],1)],1)],1),e.code_origin||e.lastModified?n("md-switch",{on:{change:e.watchModeChanged},model:{value:e.watch_file,callback:function(t){e.watch_file=t},expression:"watch_file"}},[n("md-tooltip",{staticClass:"md-medium-hide"},[e._v("Watch content change automatically.\n        ")]),e._v("\n        Watch\n      ")],1):e._e(),e.watch_file?n("md-switch",{model:{value:e.run_changed_file,callback:function(t){e.run_changed_file=t},expression:"run_changed_file"}},[n("md-tooltip",{staticClass:"md-medium-hide"},[e._v("Run automatically when code changes.\n        ")]),e._v("\n        AutoRun\n      ")],1):e._e(),n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.run()}}},[n("md-icon",[e._v("play_arrow")]),n("md-tooltip",{staticClass:"md-medium-hide"},[e._v("Save and run this plugin (Ctrl+E)")])],1),n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.save()}}},[n("md-icon",[e._v("save")]),n("md-tooltip",{staticClass:"md-medium-hide"},[e._v("Save this plugin (Ctrl+S)")])],1),n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.saveAs()}}},[n("md-icon",[e._v("cloud_download")]),n("md-tooltip",[e._v("Export this plugin")])],1),e.window&&e.window.config&&e.window.config._id?n("md-button",{staticClass:"md-icon-button",on:{click:function(t){e.remove()}}},[n("md-icon",[e._v("delete")]),n("md-tooltip",[e._v("Remove this plugin")])],1):e._e(),this.editor&&e.window&&e.window.config&&e.window.config.tags&&e.window.config.tags.length>0?n("md-field",{staticStyle:{"max-width":"100px"}},[n("md-select",{attrs:{id:"tag",name:"tag"},on:{"md-selected":function(t){e.window.config.tags.includes(e.window.config.tag)&&e.reload()}},model:{value:e.window.config.tag,callback:function(t){e.$set(e.window.config,"tag",t)},expression:"window.config.tag"}},e._l(e.window.config.tags,function(t){return n("md-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),n("md-tooltip",[e._v("Select a tag for testing, the plugin will be reloaded.")])],1):e._e(),this.editor&&e.window&&e.window.config&&e.window.config.engine_mode&&e.window.engine_manager?n("md-field",{staticStyle:{"max-width":"220px"}},[n("md-select",{attrs:{id:"engine_mode",name:"tag"},on:{"md-selected":function(t){e.reload()}},model:{value:e.window.config.engine_mode,callback:function(t){e.$set(e.window.config,"engine_mode",t)},expression:"window.config.engine_mode"}},[n("md-option",{attrs:{value:"auto"}},[e._v("auto")]),e._l(e.window.engine_manager.matchEngineByType(e.window.config.type),function(t){return n("md-option",{key:t.name,attrs:{value:t.name}},[e._v(e._s(t.name))])})],2),n("md-tooltip",[e._v("Select an engine, the plugin will be reloaded.")])],1):e._e()],1)]):e._e(),n("div",{ref:"code_editor",staticClass:"code_editor",class:e.window?"editor-with-toolbar":"editor-without-toolbar",staticStyle:{}})],1)},pn=[],mn=n("c2c6");window.MonacoEnvironment={getWorkerUrl:function(){var e=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");return"data:text/javascript;charset=utf-8,".concat(encodeURIComponent("\n      self.MonacoEnvironment = {\n        baseUrl: '".concat(e,"/static'\n      };\n      try {\n        importScripts('").concat(e,"/static/vs/base/worker/workerMain.js');\n      } catch (e) {\n        console.error(e)\n      } finally {\n\n      }\n      ")))}};var hn={name:"joy",props:["value","title","pluginId","window"],data:function(){return{codeValue:"",editor:null,saved:!1,code_origin:null,watch_file:!1,run_changed_file:!1,loading:!1,watch_timer:null,lastModified:null,local_file:null}},created:function(){this.store=this.$root.$data.store,this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.event_bus&&this.event_bus.on("resize",this.updateSize)},beforeDestroy:function(){this.event_bus&&this.event_bus.off("resize",this.updateSize),this.watch_timer&&window.clearInterval(this.watch_timer)},mounted:function(){var e=this;this.$el.addEventListener("touchmove",function(e){e.preventDefault()}),this.codeValue=this.value,this.editor=mn["editor"].create(this.$refs.code_editor,{value:this.codeValue,language:"html",minimap:{enabled:this.$el.clientWidth>500}}),this.window.api.on("refresh",function(){e.editor.layout()}),this.window&&this.window.api.on("resize",function(){e.$nextTick(e.updateSize)}),this.updateSize(),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_S,function(){e.save()}),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_E,function(){e.run()}),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_L,function(){e.loadCodeFromURL()})},methods:{updateSize:function(){var e=this;if(this.editor){var t=this.$el.clientWidth>500,n=this.$el.clientWidth>900;this.editor.updateOptions({minimap:{enabled:n},lineNumbers:t?"on":"off",folding:t,lineDecorationsWidth:t?5:2}),this.editor.layout(),setTimeout(function(){e.editor.layout(),e.window.refresh()},200),setTimeout(function(){e.editor.layout(),e.window.refresh()},500)}},save:function(){var e=this;return Object(j["c"])(this.window.plugin_manager),new Promise(function(t,n){e.editor?(e.codeValue=e.editor.getValue(),e.$emit("input",e.codeValue),e.window.plugin_manager.savePlugin({pluginId:e.pluginId,code:e.codeValue,tag:e.window.config&&e.window.config.tag,origin:e.window.config&&e.window.config.origin}).then(function(n){e.window.data.config=n,e.saved=!0,e.reload().catch(function(){e.window.config=n}).finally(function(){e.window.data._id=n._id,e.window.name="Edit-"+n.name,e.window.data._name=n.name,e.$forceUpdate(),t()})})):n("editor is not available")})},fileSelected:function(){this.lastModified=null,this.$refs.file_select.files&&(this.local_file=this.$refs.file_select.files[0],this.loadCodeFromFile(this.local_file,!1))},watchModeChanged:function(){var e=this;this.watch_file?(this.editor.updateOptions({readOnly:!0}),this.lastModified="old",this.watch_timer=setInterval(function(){e.$forceUpdate(),e.code_origin?e.loadCodeFromURL():e.loadCodeFromFile(e.local_file,!0)},1e3)):(this.editor.updateOptions({readOnly:!1}),this.watch_timer&&(window.clearInterval(this.watch_timer),this.watch_timer=null),this.loading=!1,this.run_changed_file=!1,this.$forceUpdate())},loadCodeFromFile:function(e,t){var n=this;if(e=e||this.local_file,e){this.code_origin=null;var i=new FileReader;i.onload=function(){n.local_file=e;try{var o=i.result;n.lastModified==e.lastModified&&W.a.hash(o)===W.a.hash(n.editor.getValue())||(n.lastModified=e.lastModified,n.loading=!0,n.$forceUpdate(),n.window.plugin_manager.parsePluginCode(o),n.editor.setValue(o),n.run_changed_file?n.run():t&&n.save())}catch(a){n.window.plugin_manager.showMessage("Failed to load plugin source code, error: ".concat(a))}finally{n.loading&&setTimeout(function(){n.loading=!1,n.$forceUpdate()},1e3)}},i.onerror=function(e){console.error(e),n.window.plugin_manager.showMessage("Failed to load plugin source code, error: ".concat(e)),n.watch_timer&&clearInterval(n.watch_timer),n.watch_file=!1,n.$forceUpdate()},i.readAsText(e)}},openEngineFile:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.window.plugin_manager.imjoy_api,e.prev=1,e.t0=t,e.t0){e.next=7;break}return e.next=6,n.showFileDialog(null,{title:"Load plugin source file",uri_type:"url",mode:"single",type:"file"});case 6:e.t0=e.sent;case 7:i=e.t0,this.code_origin=i,this.$refs.file_select.value="",this.loadCodeFromURL(),e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](1),this.window.plugin_manager.showMessage("Failed to load plugin source code, error: ".concat(e.t1));case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}(),loadCodeFromURL:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n,i,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.code_origin&&this.code_origin.url){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,p.a.get(this.code_origin.url+"?"+Object(j["l"])());case 5:t=e.sent,t&&t.data?(n=t.data,W.a.hash(n)!==W.a.hash(this.editor.getValue())&&(this.loading=!0,this.$forceUpdate(),i=this.window.plugin_manager.parsePluginCode(n),this.window.name=i.name,this.editor.setValue(n),this.run_changed_file?this.run():this.save())):this.window.plugin_manager.showMessage("Failed to load plugin source code."),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.window.plugin_manager.showMessage("Failed to load plugin source code, error: ".concat(e.t0));case 12:return e.prev=12,this.loading&&setTimeout(function(){o.loading=!1,o.$forceUpdate()},1e3),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[2,9,12,15]])}));return function(){return e.apply(this,arguments)}}(),run:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return Object(j["c"])(this.window.plugin_manager),e.next=3,this.save();case 3:if(t={},n=this.window.plugin,n&&n.api){e.next=8;break}return console.error("plugin is not loaded."),e.abrupt("return");case 8:if(this.window_plugin_id&&!this.window.plugin_manager.wm.window_ids[this.window_plugin_id]&&(this.window_plugin_id=null),this.window_plugin_id||!n.config||!n.config.ui){e.next=19;break}if(!(n.config.ui.indexOf("{")>-1)){e.next=16;break}return e.next=13,this.window.plugin_manager.imjoy_api.showDialog(n,n.config);case 13:t=e.sent,e.next=17;break;case 16:t={};case 17:e.next=20;break;case 19:t=this.window_plugin_config;case 20:return this.window_plugin_id&&(i=document.getElementById("iframe_"+this.window_plugin_id),i&&i.parentNode.removeChild(i)),e.next=23,n.api.run({id:this.window_plugin_id,config:t,data:{}});case 23:o=e.sent,(n.config&&"window"===n.config.type||"web-python-window"===n.config.type)&&(this.window_plugin_id=o&&o.__id__,this.window_plugin_config=t);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),remove:function(){var e=this;Object(j["c"])(this.window.plugin_manager),this.codeValue=this.editor.getValue(),this.$emit("input",this.codeValue),this.window.data._id=null,this.window.plugin_manager.removePlugin(this.window.config).then(function(){e.window.config={},e.window.plugin=null})},reload:function(){var e=this;return Object(j["c"])(this.window.plugin_manager),this.$forceUpdate(),new Promise(function(t,n){if(e.editor){if(e.codeValue=e.editor.getValue(),e.codeValue){e.$emit("input",e.codeValue),e.window.config&&(e.window.config.code=e.codeValue);var i=e.window.config.tag,o=e.window.data&&e.window.data.config;o&&e.window.config&&e.window.config.tag&&(e.window.data.config.tags.includes(e.window.config.tag)||(i=e.window.data.config.tags[0]));var a=e.window.config&&e.window.config.engine_mode;e.window.plugin_manager.reloadPlugin({_id:e.window.data._id,engine_mode:a,tag:i,name:e.window.data._name,code:e.codeValue,origin:e.window.config&&e.window.config.origin}).then(function(n){e.window.config=n.config,e.window.plugin=n,e.$forceUpdate(),t()}).catch(function(e){n(e)})}}else n("editor is not available.")})},saveAs:function(){this.codeValue=this.editor.getValue(),this.$emit("input",this.codeValue);var e=this.window&&this.window.config&&this.window.config.name?this.window.config.name+"_"+Object(j["l"])()+".imjoy.html":"plugin_"+Object(j["l"])()+".imjoy.html",t=new Blob([this.codeValue],{type:"text/plain;charset=utf-8"});Object(u["saveAs"])(t,e)}}},fn=hn,gn=(n("5865"),Object(it["a"])(fn,dn,pn,!1,null,"bd2d5016",null));gn.options.__file="PluginEditor.vue";var _n=gn.exports,vn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"plugin-icon"},[e.icon?e.icon.startsWith("http")?n("img",{staticClass:"icon-image",attrs:{src:e.icon}}):n("md-icon",[e._v(e._s(e.icon)+" ")]):n("md-icon",[e._v("extension")])],1)},wn=[],bn={name:"plugin-icon",props:{icon:{type:String,default:""}},created:function(){}},yn=bn,kn=(n("2733"),Object(it["a"])(yn,vn,wn,!1,null,"5b5c9f74",null));kn.options.__file="PluginIcon.vue";var xn=kn.exports,jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("div",[e.isFolder?n("span",{on:{click:e.toggle}},[e._v("["+e._s(e.open?"-":"+")+"]")]):e._e(),n("span",{staticClass:"noselect",on:{click:function(t){(e.root===e.selected||e.selected&&Array.isArray(e.selected)&&e.selected.indexOf(e.root)>=0)&&"file"!==e.model.type?e.load():e.select({target:e.model,path:e.root},t.shiftKey)},dblclick:function(t){e.load()}}},["file"===e.model.type?n("md-icon",[e._v("insert_drive_file")]):n("md-icon",[e._v("folder_open")]),n("span",{staticClass:"noselect",class:{bold:e.isFolder,selected:e.root===e.selected||e.selected&&Array.isArray(e.selected)&&e.selected.indexOf(e.root)>=0}},[e._v(e._s(e.isFolder?e.root:e.model.name))])],1),e.isFolder||e.model.children&&0===e.model.children.length?n("span",{staticClass:"item",on:{click:function(t){e.up()}}},[n("md-icon",[e._v("arrow_upward")])],1):e._e(),e.model.drives?n("div",{staticClass:"drives"},e._l(e.model.drives,function(t){return n("span",{key:t,staticClass:"noselect",on:{click:function(n){e.select({target:e.model,path:t}),e.load({target:e.model,path:t})}}},[n("md-icon",[e._v("storage")]),n("span",{staticClass:"noselect",class:{bold:e.isFolder,selected:t===e.selected||e.selected&&Array.isArray(e.selected)&&e.selected.indexOf(t)>=0}},[e._v(e._s(t))])],1)})):e._e()]),e.open&&e.isFolder?n("ul",[e._l(e.sortedFiles,function(t){return n("file-item",{key:t.name,staticClass:"item",attrs:{root:e.root+"/"+t.name,model:t,selected:e.selected},on:{load:function(t){e.load(t)},select:function(t){e.select(t)},select_append:function(t){e.select(t,!0)}}})}),e.model.children.length>e.max_files?n("md-button",{staticClass:"md-primary",on:{click:function(t){e.max_files=e.max_files+200}}},[e._v("Load more ...")]):e._e()],2):e._e()])},Cn=[],On=(n("55dd"),200),Pn={name:"file-item",props:{model:Object,selected:[String,Array],root:{type:String,default:"."},file_manager:Object},data:function(){return{open:!0,max_files:On}},mounted:function(){},computed:{isFolder:function(){return this.model.children&&this.model.children.length},sortedFiles:function(){function e(e,t){return e.name<t.name?-1:e.name>t.name?1:0}return this.model.children.slice(0,this.max_files).sort(e)}},methods:{up:function(e){this.$emit("load",e||{target:this.model,path:this.root+"/../"})},load:function(e){this.$emit("load",e||{target:this.model,path:this.root,file_manager:this.file_manager}),this.max_files=On},select:function(e,t){t?this.$emit("select_append",e||{target:this.model,path:this.root+"/"+this.model.name}):this.$emit("select",e||{target:this.model,path:this.root+"/"+this.model.name})},toggle:function(){this.isFolder&&(this.open=!this.open)}}},En=Pn,Dn=(n("9a0e"),Object(it["a"])(En,jn,Cn,!1,null,"6d744f41",null));Dn.options.__file="FileItem.vue";var Rn=Dn.exports,In=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-dialog",{attrs:{"md-active":e.show_,"md-click-outside-to-close":!1,"md-close-on-esc":!1},on:{"update:mdActive":function(t){e.show_=t}}},[n("md-dialog-title",[e._v(e._s(this.options.title||"ImJoy File Dialog")+"\n    "),n("md-button",{staticClass:"md-accent",staticStyle:{position:"absolute",top:"8px",right:"5px"},on:{click:function(t){e.show_=!1,e.reject("file dialog canceled by the user.")}}},[n("md-icon",[e._v("clear")])],1)],1),n("md-dialog-content",[e._l(e.file_managers,function(t){return n("md-button",{directives:[{name:"show",rawName:"v-show",value:e.show_all_file_managers&&t.connected,expression:"show_all_file_managers && file_manager.connected"}],key:t.id,class:e.selected_file_manager===t?"md-raised":"",staticStyle:{"text-transform":"none"},on:{click:function(n){e.selectFileManager(t)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])}),n("div",{staticClass:"loading-info"},[e.dropping?n("h5",[e._v("Drop files to upload to "+e._s(e.root))]):e._e()]),e.selected_file_manager&&e.file_tree?n("ul",{class:e.dropping?"dropping-files":"",attrs:{disabled:!e.selected_file_manager||!e.selected_file_manager.connected}},[n("file-item",{attrs:{model:e.file_tree,file_manager:e.selected_file_manager,root:e.root,selected:e.file_tree_selection},on:{load:e.loadFile,select:e.fileTreeSelected,select_append:e.fileTreeSelectedAppend}})],1):e.selected_file_manager&&e.selected_file_manager.connected?n("div",{staticClass:"loading loading-lg"}):n("p",[e._v("\n      No file manager is available.\n    ")])],2),n("md-dialog-actions",[n("md-menu",{staticStyle:{flex:"auto"}},[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("menu")]),e._v("options\n      ")],1),n("md-menu-content",[n("md-menu-item",{staticClass:"md-primary",on:{click:function(t){e.go()}}},[n("md-icon",[e._v("forward")]),e._v(" Go to Folder\n        ")],1),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.file_tree_selection_info,expression:"file_tree_selection_info"}],staticClass:"md-primary",on:{click:function(t){e.downloadFiles()}}},[n("md-icon",[e._v("cloud_download")]),e._v(" Download\n        ")],1),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.file_tree_selection_info,expression:"file_tree_selection_info"}],staticClass:"md-accent",on:{click:function(t){e.remove()}}},[n("md-icon",[e._v("delete")]),e._v(" Delete\n        ")],1)],1)],1),e.status_text?n("p",{staticClass:"md-small-hide",staticStyle:{flex:"auto"}},[e._v("\n      "+e._s(e.status_text.slice(0,100))+"\n    ")]):e._e(),n("md-button",{staticClass:"md-primary",attrs:{disabled:!e.file_tree_selection},on:{click:function(t){e.show_=!1,e.resolve(e.file_tree_selection)}}},[e._v("OK\n      "),e.file_tree_selection?n("md-tooltip",{staticClass:"md-small-hide"},[e._v("Selected: "+e._s(e.file_tree_selection))]):e._e()],1),n("md-button",{staticClass:"md-primary",on:{click:function(t){e.show_=!1,e.reject("file dialog canceled by the user.")}}},[e._v("Cancel")])],1),n("md-progress-bar",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{"md-mode":"determinate","md-value":e.loading_progress}})],1)},Wn=[],Mn={name:"file-dialog",props:{file_managers:Array,uploadFileToUrl:Function},data:function(){return{root:null,options:{},show_:!1,file_tree_selection:null,file_tree_selection_info:null,file_tree:null,resolve:null,reject:null,selected_file_manager:null,show_all_file_managers:!0,dropping:!1,loading:!1,status_text:"Drag and drop here to upload files",loading_progress:0}},created:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.event_bus&&(this.event_bus.on("drag_upload_enter",this.showDropping),this.event_bus.on("drag_upload_leave",this.hideDropping),this.event_bus.on("drag_upload",this.uploadFiles))},beforeDestroy:function(){this.event_bus&&(this.event_bus.off("drag_upload_enter",this.showDropping),this.event_bus.off("drag_upload_leave",this.hideDropping),this.event_bus.off("drag_upload",this.uploadFiles))},computed:{no_file_manager_available:function(){if(this.file_managers){var e=!1,t=!0,n=!1,i=void 0;try{for(var o,a=this.file_managers[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(r.connected){e=!0;break}}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return!e}return!0}},methods:{upload:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.show_){e.next=2;break}return e.abrupt("return");case 2:return this.status_text="requesting upload url from the file_manager...",e.next=5,this.selected_file_manager.requestUploadUrl({dir:this.root,path:t.relativePath,overwrite:!0,file_manager:this.selected_file_manager.url});case 5:return i=e.sent,console.log("loading file to url",i),this.status_text=n,e.next=10,this.uploadFileToUrl(null,{file:t,url:i,progress:function(e,t){a.loading_progress=100*e/t,a.status_text=n+" (".concat(Math.round(a.loading_progress),"%)"),a.$forceUpdate()}});case 10:o=e.sent,this.status_text="file uploaded to ".concat(o.path,".");case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),uploadFiles:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.status_text="Uploading...",this.loading=!0,e.prev=2,n=0;case 4:if(!(n<t.length)){e.next=19;break}if(!t[n].name.startsWith(".")){e.next=8;break}return console.log("skipping file: "+t[n].relativePath),e.abrupt("continue",16);case 8:if(!this.selected_file_manager.putFile){e.next=14;break}return this.status_text="Uploading ".concat(n+1,"/").concat(t.length,": ").concat(t[n].name),e.next=12,this.selected_file_manager.putFile(t[n],Object(j["k"])(this.root,t[n].name));case 12:e.next=16;break;case 14:return e.next=16,this.upload(t[n],"Uploading ".concat(n+1,"/").concat(t.length,": ").concat(t[n].name));case 16:n++,e.next=4;break;case 19:this.status_text="ðUploaded ".concat(t.length," files."),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](2),this.status_text="Failed to upload, error:"+(e.t0?e.t0.toString():"undefined");case 25:return e.prev=25,this.loading=!1,this.refreshList(),e.finish(25);case 29:case"end":return e.stop()}},e,this,[[2,22,25,29]])}));return function(t){return e.apply(this,arguments)}}(),showDropping:function(){this.dropping=!0,this.$forceUpdate()},hideDropping:function(){this.dropping=!1,this.$forceUpdate()},fileTreeSelected:function(e){"file"===this.options.type&&"dir"===e.target.type||(this.file_tree_selection=e.path,this.file_tree_selection_info=e,this.$forceUpdate())},fileTreeSelectedAppend:function(e){Array.isArray(this.file_tree_selection)||(this.file_tree_selection=this.file_tree_selection?[this.file_tree_selection]:[],this.file_tree_selection_info=this.file_tree_selection_info?[this.file_tree_selection_info]:[]),this.file_tree_selection.push(e.path),this.file_tree_selection_info.push(e),this.$forceUpdate()},refreshList:function(){var e=this;this.selected_file_manager.listFiles(this.root,this.options.type,this.options.recursive).then(function(t){e.root=t.path,e.file_tree=t,e.$forceUpdate()})},go:function(){var e=this,t=prompt("Go to the folder",this.root);t&&t!=this.root&&this.selected_file_manager.listFiles(t,"dir",!1).then(function(t){e.root=t.path,e.file_tree=t,e.selected_file_manager.listFiles(t.path,e.options.type,e.options.recursive).then(function(t){e.root=t.path,e.file_tree=t,e.$forceUpdate()}),e.$forceUpdate()}).catch(function(e){alert(e.toString())})},loadFile:function(e){var t=this;if("file"!=e.target.type){if(e.path===this.root)return void this.go();this.selected_file_manager.listFiles(e.path,this.options.type,this.options.recursive).then(function(e){t.root=e.path,t.file_tree=e,t.$forceUpdate()})}else this.show_=!1,"single"===this.options.mode&&"object"===Object(l["a"])(this.file_tree_selection)?this.resolve(this.file_tree_selection[0]):"multiple"===this.options.mode&&"string"===typeof this.file_tree_selection?this.resolve([this.file_tree_selection]):this.resolve(this.file_tree_selection)},showDialog:function(e,t){var n=this;return this.show_=!0,this.options=t,this.options.title=this.options.title||"ImJoy File Dialog",this.options.root=this.options.root||"./",this.options.mode=this.options.mode||"single|multiple",this.options.uri_type=this.options.uri_type||"path",this.options.return_object=void 0===this.options.return_object||this.options.return_object,this.$nextTick(function(){n.options.file_manager?n.selected_file_manager=n.options.file_manager:n.selected_file_manager=n.file_managers[0],n.refreshList()}),"file"!=this.options.type&&this.options.root?this.file_tree_selection=this.options.root:this.file_tree_selection=null,new Promise(function(e,t){if("path"===n.options.uri_type?(n.resolve=function(t){n.options.return_object?e({path:t,file_manager:n.selected_file_manager.url}):e(t)},n.reject=function(){n.options.return_object?e(null):t("User cancelled selection.")}):"url"===n.options.uri_type?(n.reject=function(){n.options.return_object?e(null):t("User cancelled selection.")},n.resolve=function(i){if("string"===typeof i)n.selected_file_manager.getFileUrl({path:i,file_manager:n.selected_file_manager.url}).then(function(t){n.options.return_object?e({type:"imjoy/url",url:t,file_manager:n.selected_file_manager.url,path:i}):e(t)}).catch(t);else{var o=[],a=!0,r=!1,s=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;o.push(n.selected_file_manager.getFileUrl({path:u,file_manager:n.selected_file_manager.url}))}}catch(d){r=!0,s=d}finally{try{a||null==l.return||l.return()}finally{if(r)throw s}}Promise.all(o).then(function(t){n.options.return_object?e({type:"imjoy/url",url:t,file_manager:n.selected_file_manager.url,path:i}):e(t)}).catch(t)}}):t("unsupported uri_type: "+n.options.uri_type),n.root=n.options.root,n.show_all_file_managers){var i=!0,o=!1,a=void 0;try{for(var r,s=n.file_managers[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var c=r.value;if(c.connected){n.selectFileManager(c);break}}}catch(l){o=!0,a=l}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}}else n.selectFileManager(n.selected_file_manager);n.dropping=!1,n.loading_progress=0,n.status_text="Drag and drop here to upload files"})},selectFileManager:function(e){var t=this;return new Promise(function(n,i){t.selected_file_manager=e,t.file_tree=null,t.$forceUpdate(),t.selected_file_manager.listFiles(t.options.root,t.options.type,t.options.recursive).then(function(e){t.root=e.path,t.file_tree=e,t.$forceUpdate(),n()}).catch(i)})},remove:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n,i,o,a,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,this.file_tree_selection_info){e.next=4;break}throw"no file selected";case 4:t=Array.isArray(this.file_tree_selection_info)?this.file_tree_selection_info:[this.file_tree_selection_info],this.file_tree_selection=null,this.file_tree_selection_info=null,n=!0,i=!1,o=void 0,e.prev=10,a=t[Symbol.iterator]();case 12:if(n=(r=a.next()).done){e.next=20;break}return s=r.value,e.next=16,this.selected_file_manager.removeFile(s.path,s.target.type,this.options.recursive);case 16:this.status_text='"'.concat(s.target.name,'" has been removed.');case 17:n=!0,e.next=12;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e["catch"](10),i=!0,o=e.t0;case 26:e.prev=26,e.prev=27,n||null==a.return||a.return();case 29:if(e.prev=29,!i){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:this.refreshList(),e.next=40;break;case 37:e.prev=37,e.t1=e["catch"](1),this.status_text="Error occured when removing file or folder: ".concat(e.t1);case 40:case"end":return e.stop()}},e,this,[[1,37],[10,22,26,34],[27,,29,33]])}));return function(){return e.apply(this,arguments)}}(),downloadFiles:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],this.file_tree_selection_info){e.next=3;break}throw"no file selected";case 3:for(t=Array.isArray(this.file_tree_selection_info)?this.file_tree_selection_info:[this.file_tree_selection_info],n=0;n<t.length;n++)"file"===t[n].target.type?this.download(t[n],"downloading ".concat(n+1,"/").concat(t.length,": ").concat(t[n].target.name)):this.status_text="Folder cannot be downloaded, please select files.";case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),download:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.show_){e.next=2;break}return e.abrupt("return");case 2:return this.status_text="requesting upload url from the file_manager...",e.next=5,this.selected_file_manager.getFileUrl({path:t.path,file_manager:this.selected_file_manager});case 5:i=e.sent,this.status_text=n,o=document.createElement("a"),o.href=i,o.target="_blank",o.download=t.name,o.click();case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}},Sn=Mn,An=(n("7a61"),Object(it["a"])(Sn,In,Wn,!1,null,"0cbe86cc",null));An.options.__file="FileDialog.vue";var $n=An.exports,Un=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.w?n("md-card",[e.w.standalone?e._e():n("md-card-actions",{class:{"drag-handle":e.withDragHandle,"window-selected":e.w.selected,"window-header":!e.w.selected},attrs:{"md-alignment":"space-between"},nativeOn:{click:function(t){e.selectWindow(e.w,t)},dblclick:function(t){e.w.fullscreen?e.normalSize(e.w):e.fullScreen(e.w)}}},[n("md-button",{staticClass:"md-icon-button md-accent no-drag",on:{click:function(t){e.close(e.w)}}},[n("md-icon",[e._v("close")]),n("md-tooltip",[e._v("Close window")])],1),n("div",{staticClass:"window-title noselect"},[e._v("\n      "+e._s(e.w.name.slice(0,30)+"(#"+(e.w.index||"")+")")+"\n    ")]),n("div",{staticClass:"no-drag"},[n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end","md-active":e.options_menu_open},on:{"update:mdActive":function(t){e.options_menu_open=t}}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_vert")])],1),n("md-menu-content",[n("md-menu-item",{on:{click:function(t){e.options_menu_open=!1}}},[n("md-icon",[e._v("highlight_off")]),n("span",[e._v("Cancel")])],1),!e.w.standalone&&e.w.fullscreen?n("md-menu-item",{on:{click:function(t){e.normalSize(e.w)}}},[n("md-icon",[e._v("fullscreen")]),n("span",[e._v("Normal view")])],1):e.w.standalone?e._e():n("md-menu-item",{on:{click:function(t){e.fullScreen(e.w)}}},[n("md-icon",[e._v("fullscreen")]),n("span",[e._v("Fullscreen")])],1),e.w.standalone?e._e():n("md-menu-item",{on:{click:function(t){e.detach(e.w)}}},[n("md-icon",[e._v("launch")]),n("span",[e._v("Detach")])],1),n("md-menu-item",{on:{click:function(t){e.duplicate(e.w)}}},[n("md-icon",[e._v("filter")]),n("span",[e._v("Duplicate")])],1),n("md-menu-item",{on:{click:function(t){e.close(e.w)}}},[n("md-icon",[e._v("close")]),n("span",[e._v("Close")])],1),n("md-menu-item",{on:{click:function(t){e.printObject(e.w.type,e.w.data,e.w)}}},[n("md-icon",[e._v("bug_report")]),n("span",[e._v("Console.log")])],1),e._l(e.w.loaders,function(t,i){return n("md-menu-item",{key:i,on:{click:function(n){e.loaders&&e.loaders[t](e.w.data)}}},[n("md-icon",[e._v("play_arrow")]),n("span",[e._v(e._s(i))])],1)})],2)],1)],1)],1),n("md-card-content",{staticClass:"plugin-iframe-container allow-scroll",class:e.w.standalone?"taller-container":"shorter-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.w.loading,expression:"w.loading"}],staticClass:"loading loading-lg floating"}),e.componentNames[e.w.type]&&e.w.type.startsWith("imjoy/")?n(e.componentNames[e.w.type],{ref:"window-content",tag:"component",attrs:{w:e.w,loaders:e.loaders},on:{init:e.setAPI}}):e.w.type.startsWith("imjoy/")?n("md-empty-state",{ref:"window-content",attrs:{"md-icon":"hourglass_empty","md-label":"IMJOY.IO","md-description":""}}):n("div",{staticClass:"plugin-iframe"},[n("div",{staticClass:"plugin-iframe",attrs:{id:e.w.iframe_container}})])],1)],1):e._e()},Tn=[],Fn=n("6dd8"),Ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-list",{staticClass:"allow-scroll"},[e.loaders&&e.w.loaders&&Object.keys(e.w.loaders).length>0?n("md-list-item",{staticClass:"md-primary",on:{click:function(t){e.loaders[e.w.loaders[Object.keys(e.w.loaders)[0]]](e.w.data)}}},[n("span",{staticClass:"md-list-item-text md-primary"},[e._v('Open with "'+e._s(Object.keys(e.w.loaders)[0])+'"')]),n("md-tooltip",[e._v('click to open with "'+e._s(Object.keys(e.w.loaders)[0])+'".')])],1):n("md-list-item",[n("span",{staticClass:"md-list-item-text"},[e._v(e._s(e.dataSummary(e.w)))])]),e._l(e.w.data,function(t,i){return n("md-list-item",{directives:[{name:"show",rawName:"v-show",value:!e.isTypedArray(e.w.data)&&(!i.startsWith||!i.startsWith("_"))&&e.w.data&&!e.w.data.length||(e.w.data.length||e.w.data.byteLength)&&(e.w.data.length||e.w.data.byteLength)>0&&i<=20,expression:"\n      (!isTypedArray(w.data) &&\n        (!k.startsWith || !k.startsWith('_')) &&\n        w.data &&\n        !w.data.length) ||\n        ((w.data.length || w.data.byteLength) &&\n          (w.data.length || w.data.byteLength) > 0 &&\n          k <= 20)\n    "}],key:i},[n("md-icon",[e._v("insert_drive_file")]),n("span",{staticClass:"md-list-item-text",on:{click:function(n){e.printObject(i,t)}}},[e._v(e._s(i))])],1)}),e.w.data&&(e.w.data.length||e.w.data.byteLength)&&(e.w.data.length||e.w.data.byteLength)>20?n("md-list-item",{on:{click:function(t){e.printObject(e.w.data)}}},[n("md-icon",[e._v("insert_drive_file")]),n("span",{staticClass:"md-list-item-text"},[e._v("...")]),n("md-tooltip",[e._v("click to print the data in your console.")])],1):e._e()],2)},Nn=[],qn={name:"generic-window",type:"imjoy/generic",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")},methods:{dataSummary:function(e){return Array.isArray(e.data)?"".concat(e.type,", ").concat(Object(l["a"])(e.data),", length: ").concat(e.data.length):e.data.buffer&&"[object ArrayBuffer]"===Object.prototype.toString.call(e.data.buffer)?"".concat(e.type,", typedarray, length: ").concat(e.data.length):"object"===Object(l["a"])(e.data)?"".concat(e.type,", ").concat(Object(l["a"])(e.data),", length: ").concat(Object.keys(e.data).length):"".concat(e.type)},printObject:function(e,t,n){console.log(e,t,n)},isTypedArray:function(e){return!!e&&void 0!==e.byteLength}}},zn=qn,Bn=(n("0529"),Object(it["a"])(zn,Ln,Nn,!1,null,"7eb14dc3",null));Bn.options.__file="GenericWindow.vue";var Jn=Bn.exports,Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fill-container"},[e.w.data&&e.w.data.src?n("img",{staticStyle:{height:"100%",width:"100%","object-fit":"contain"},attrs:{src:e.w.data.src}}):n("p",[e._v("No image available for display.")])])},Hn=[],Vn={name:"image-window",type:"imjoy/image",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")}},Gn=Vn,Yn=(n("9efd"),Object(it["a"])(Gn,Kn,Hn,!1,null,"f44818a6",null));Yn.options.__file="ImageWindow.vue";var Xn=Yn.exports,Zn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"allow-scroll fill-container"},[e.w.data&&e.w.data.images&&0!=e.w.data.images.length?e._l(e.w.data.images,function(e,t){return n("img",{key:t,staticStyle:{height:"100%",width:"100%","object-fit":"contain"},attrs:{src:e}})}):n("p",[e._v("\n    No image available for display.\n  ")])],2)},Qn=[],ei={name:"image-list-window",type:"imjoy/images",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")}},ti=ei,ni=(n("ceea"),Object(it["a"])(ti,Zn,Qn,!1,null,"85bf7dcc",null));ni.options.__file="ImageListWindow.vue";var ii=ni.exports,oi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("joy",{attrs:{config:e.w.config}})},ai=[],ri={name:"panel-window",type:"imjoy/panel",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")}},si=ri,ci=(n("84f3"),Object(it["a"])(si,oi,ai,!1,null,"7bc13713",null));ci.options.__file="PanelWindow.vue";var li=ci.exports,ui=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.plugin_info?n("md-card",[e.plugin_info.cover&&"string"===typeof e.plugin_info.cover?n("md-card-media",{attrs:{"md-ratio":"16:9"}},[n("img",{attrs:{src:e.plugin_info.cover,alt:"plugin-cover"}})]):e.plugin_info.cover?n("div",{staticClass:"carousel"},[e._l(e.plugin_info.cover,function(e,t){return n("input",{key:t,staticClass:"carousel-locator",attrs:{id:"slide-"+t,type:"radio",name:"carousel-radio",hidden:""}})}),n("div",{staticClass:"carousel-container"},e._l(e.plugin_info.cover,function(e,t){return n("figure",{key:t,staticClass:"carousel-item"},[n("img",{staticClass:"img-responsive rounded",attrs:{src:e,alt:"plugin cover"}})])})),n("div",{staticClass:"carousel-nav"},e._l(e.plugin_info.cover,function(t,i){return n("label",{key:i,staticClass:"nav-item text-hide c-hand",attrs:{for:"slide-"+i}},[e._v(e._s(i))])}))],2):e._e(),n("md-card-header",[n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("div",[n("h2",[n("plugin-icon",{attrs:{icon:e.plugin_info.icon}}),e._v("\n            "+e._s(e.plugin_info.name+" "+e.plugin_info.badges)+"\n          ")],1)]),n("div",{staticClass:"md-toolbar-section-end"},[n("p",[e._v("version:"+e._s(e.plugin_info.version))])])])],1),n("md-card-content",[e.w.data&&e.w.data.source&&""!=e.w.data.source.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px",overflow:"auto"},domProps:{innerHTML:e._s(e.sanitizedMarked(e.w.data.source))}}):n("h4",[e._v("\n        "+e._s(e.plugin_info&&e.plugin_info.description)+"\n        "),n("br"),e._v("\n        This plugin has no documentation!\n      ")])])],1):e._e()],1)},di=[],pi={name:"markdown-window",type:"imjoy/markdown",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{plugin_info:null}},created:function(){var e=new rn.a.Renderer;e.link=function(e,t,n){var i=rn.a.Renderer.prototype.link.call(this,e,t,n);return i.replace("<a","<a target='_blank' ")},rn.a.setOptions({renderer:e}),O.a.addHook("afterSanitizeAttributes",function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}),this.sanitizedMarked=function(e){return O.a.sanitize(rn()(e))}},mounted:function(){this.plugin_info=this.w&&this.w.data&&this.w.data.plugin_info,this.$emit("init")}},mi=pi,hi=(n("a6c7"),Object(it["a"])(mi,ui,di,!1,null,"3575b5fc",null));hi.options.__file="MarkdownWindow.vue";var fi=hi.exports,gi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("plugin-editor",{ref:"code_editor",staticClass:"no-drag fill-container",attrs:{pluginId:e.w.data.id,window:e.w,editorId:"editor_"+e.w.data.id},model:{value:e.w.data.code,callback:function(t){e.$set(e.w.data,"code",t)},expression:"w.data.code"}})},_i=[],vi={name:"plugin-editor-window",type:"imjoy/plugin-editor",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.w.data.engine_file_obj?this.$refs.code_editor.openEngineFile(this.w.data.engine_file_obj):this.w.data.local_file_obj&&this.$refs.code_editor.loadCodeFromFile(this.w.data.local_file_obj,!1),this.$emit("init")},methods:{dataSummary:function(e){return Array.isArray(e.data)?"".concat(e.type,", ").concat(Object(l["a"])(e.data),", length: ").concat(e.data.length):e.data.buffer&&"[object ArrayBuffer]"===Object.prototype.toString.call(e.data.buffer)?"".concat(e.type,", typedarray, length: ").concat(e.data.length):"object"===Object(l["a"])(e.data)?"".concat(e.type,", ").concat(Object(l["a"])(e.data),", length: ").concat(Object.keys(e.data).length):"".concat(e.type)},printObject:function(e,t,n){console.log(e,t,n)}}},wi=vi,bi=(n("8307"),Object(it["a"])(wi,gi,_i,!1,null,"b88a3cbe",null));bi.options.__file="PluginEditorWindow.vue";var yi=bi.exports,ki=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"log-content"},[n("ul",e._l(e.log_history,function(t,i){return n("li",{key:i},["image"===t.type?n("img",{attrs:{src:t.value}}):n("p",{class:"error"===t.type?"error":"info"},[e._v("\n        "+e._s(t.value||t)+"\n      ")])])})),e.log_history&&e.log_history.length>0?n("md-button",{staticClass:"md-mini",on:{click:function(t){e.clearLog()}}},[n("md-icon",[e._v("clear")]),e._v("Clear\n  ")],1):e._e(),e.log_history&&e.log_history.length>0?n("md-button",{staticClass:"md-mini",on:{click:function(t){e.exportLog()}}},[n("md-icon",[e._v("cloud_download")]),e._v("Export\n  ")],1):n("p",[e._v("\n    No log available.\n  ")])],1)},xi=[],ji={name:"log-window",type:"imjoy/log",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{log_history:null}},mounted:function(){this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus,this.event_bus&&this.event_bus.on("plugin_loaded",this.fetchLog),this.log_history=this.w.data.log_history,this.plugin_id=this.w.data.plugin_id,this.plugin_name=this.w.data.plugin_name,this.$emit("init")},beforeDestroy:function(){this.event_bus&&this.event_bus.off("plugin_loaded",this.fetchLog)},methods:{fetchLog:function(e){e.name==this.w.data.plugin_name&&(this.log_history=e._log_history,this.plugin_id=e.id,this.plugin_name=e.name),this.$forceUpdate()},clearLog:function(){var e=this.log_history;e.splice(0,e.length),e._error="",e._info="",this.$forceUpdate()},exportLog:function(){var e=this.log_history,t=this.plugin_id||this.plugin_name+"_log.txt",n="",i=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var c=r.value;n=c.type+":"+n+c.value+"\n"}}catch(d){o=!0,a=d}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}var l=new Blob([n],{type:"text/plain;charset=utf-8"});Object(u["saveAs"])(l,t)}}},Ci=ji,Oi=(n("f94b"),Object(it["a"])(Ci,ki,xi,!1,null,"d9b93984",null));Oi.options.__file="LogWindow.vue";var Pi=Oi.exports,Ei=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("md-list",{staticClass:"files-window"},e._l(e.w.data,function(t,i){return n("md-list-item",{key:t.name+t.relativePath},[e.w.data&&e.w.data.length>1?n("md-radio",{attrs:{value:i},model:{value:e.w.data.select,callback:function(t){e.$set(e.w.data,"select",t)},expression:"w.data.select"}}):n("md-icon",[e._v("insert_drive_file")]),n("span",{staticClass:"md-list-item-text",staticStyle:{cursor:"pointer"},on:{click:function(n){e.loaders&&t.loaders&&Object.keys(t.loaders).length>0&&e.loaders[t.loaders[Object.keys(t.loaders)[0]]](t)}}},[e._v(e._s(t.name))]),t.loaders&&Object.keys(t.loaders).length>0?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[e._v("more_horiz")])],1),n("md-menu-content",e._l(t.loaders,function(i,o){return n("md-menu-item",{key:o,on:{click:function(n){e.loaders&&e.loaders[i](t)}}},[n("span",[e._v(e._s(o))]),n("md-icon",[e._v("play_arrow")])],1)}))],1):e._e()],1)}))},Di=[],Ri={name:"files-window",type:"imjoy/files",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")}},Ii=Ri,Wi=(n("0d19"),Object(it["a"])(Ii,Ei,Di,!1,null,"59839dee",null));Wi.options.__file="FilesWindow.vue";var Mi=Wi.exports,Si=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.w.data&&e.w.data.length&&e.w.data.length>0?n("ul",e._l(e.w.data,function(t){return n("li",{key:t.url||t},[n("a",{attrs:{href:t.url||t,target:"_blank"}},[e._v(e._s(t.text||t))])])})):n("p",[e._v("No url.")])},Ai=[],$i={name:"url-list-window",type:"imjoy/url_list",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){this.$emit("init")}},Ui=$i,Ti=(n("7dd5"),Object(it["a"])(Ui,Si,Ai,!1,null,"35dd28c2",null));Ti.options.__file="UrlListWindow.vue";var Fi=Ti.exports,Li=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.w.data&&e.w.data.first&&e.w.data.second?n("comparify",{ref:"compare",staticClass:"bg-white h-64 w-full",attrs:{value:e.w.data.offset||50}},[n("img",{staticClass:"h-64 object-fit-first h-full w-full",attrs:{slot:"first",src:e.w.data.first,alt:""},slot:"first"}),n("img",{staticClass:"object-fit-second h-full w-full",attrs:{slot:"second",src:e.w.data.second,alt:""},slot:"second"})]):n("p",[e._v("No image available for display.")])},Ni=[],qi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"compare-wrapper"},[n("div",{staticClass:"compare"},[n("div",{staticClass:"compare__content",style:{width:e.width}},[e._t("first")],2),n("div",{staticClass:"handle-wrap",style:{left:"calc("+e.compareWidth+"% - var(--handle-line-width) / 2 "}},[n("div",{staticClass:"handle"},[n("svg",{staticClass:"handle__arrow handle__arrow--l feather feather-chevron-left",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[n("polyline",{attrs:{points:"15 18 9 12 15 6"}})]),n("svg",{staticClass:"handle__arrow handle__arrow--r feather feather-chevron-right",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[n("polyline",{attrs:{points:"9 18 15 12 9 6"}})])]),n("span",{staticClass:"handle-line"})]),n("div",{staticClass:"compare-overlay ",style:{width:"calc("+e.compareWidth+"%)"}},[n("div",{staticClass:"compare-overlay__content",style:{width:e.width}},[e._t("second")],2)])]),n("input",{staticClass:"compare__range",attrs:{type:"range",min:"0",max:"100",step:e.step,tabindex:"-1"},domProps:{value:e.compareWidth},on:{input:e.handleInput}})])},zi=[],Bi={name:"comparify",props:{value:{default:50},step:{default:".1"}},data:function(){return{width:null,compareWidth:this.value}},watch:{value:function(){this.compareWidth=this.value}},mounted:function(){var e=this;this.$nextTick(function(){e.handleResize()}),this.$emit("init")},methods:{handleInput:function(e){this.compareWidth=e.target.value,this.$emit("input",e.target.value)},handleResize:function(){var e=this.getContainerWidth();e!==this.width&&(this.width=e)},getContainerWidth:function(){return window.getComputedStyle(this.$el,null).getPropertyValue("width")}}},Ji=Bi,Ki=(n("f77d"),Object(it["a"])(Ji,qi,zi,!1,null,null,null));Ki.options.__file="Comparify.vue";var Hi=Ki.exports,Vi=n("5118"),Gi={name:"image-compare-window",type:"imjoy/image-compare",components:{Comparify:Hi},props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},mounted:function(){var e=this;this.w.api.on("resize",function(){Object(Vi["setTimeout"])(function(){e.$refs.compare&&e.$refs.compare.handleResize()},0)}),this.w.api.on("refresh",function(){Object(Vi["setTimeout"])(function(){e.$refs.compare&&e.$refs.compare.handleResize()},0)}),this.$emit("init")}},Yi=Gi,Xi=(n("2a06"),Object(it["a"])(Yi,Li,Ni,!1,null,"65c7d5b8",null));Xi.options.__file="ImageCompareWindow.vue";var Zi=Xi.exports,Qi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"terminal-window"},[e._l(this.buttons||[],function(t){return n("md-button",{key:t.event_id,on:{click:function(n){e.button_click(t)}}},[t.icon?n("md-icon",[e._v(e._s(t.icon))]):e._e(),e._v(" "+e._s(t.label)+"\n  ")],1)}),n("div",{ref:"terminal_container",staticClass:"terminal-container",style:{height:e.window_height}})],2)},eo=[],to=n("59bf"),no=(n("7449"),n("941b")),io=n("c554"),oo=n("95db"),ao=n("6a49");function ro(e,t){var n;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var r=this;clearTimeout(n),n=setTimeout(function(){return e.apply(r,o)},t)}}var so={name:"terminal-window",type:"imjoy/terminal",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{error:!1,window_height:"500px",buttons:[]}},created:function(){},mounted:function(){var e=this;to["Terminal"].applyAddon(no),to["Terminal"].applyAddon(io),to["Terminal"].applyAddon(oo),to["Terminal"].applyAddon(ao);var t=new to["Terminal"]({cursorBlink:!0,macOptionIsMeta:!0,scrollback:!0});t.open(this.$refs.terminal_container),this.term=t,this.$nextTick(function(){e.fitToscreen()}),this.w.api.on("write",function(t){e.term.write(t)}),this.w.api.on("error",function(t){e.error=t}),this.term.on("key",function(t){e.w.api.emit("key",t)}),this.term.on("paste",function(t){e.w.api.emit("paste",t)}),this.term.focus(),this.w.api.on("show_buttons",function(t){e.buttons=t,e.$forceUpdate()});var n=50,i=ro(this.fitToscreen,n);window.addEventListener("resize",i),document.addEventListener("orientationchange",i),this.w.api.on("resize",i),this.w.api.on("refresh",i),this.buttons=this.w.data.buttons||[],this.$emit("init")},beforeDestroy:function(){},methods:{fitToscreen:function(){var e=this;this.window_height=this.$el.clientHeight+"px",this.$forceUpdate(),this.$nextTick(function(){e.term.focus(),e.term.fit(),e.w.api.emit("fit",{cols:e.term.cols,rows:e.term.rows}),e.$forceUpdate()})},button_click:function(e){this.w.api.emit("button_clicked",e)}}},co=so,lo=(n("1eb5"),Object(it["a"])(co,Qi,eo,!1,null,"425d4a2b",null));lo.options.__file="TerminalWindow.vue";var uo=lo.exports,po=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"joy-window"},[e.plugin_dialog_config?n("joy",{ref:"plugin_dialog_joy",attrs:{config:e.plugin_dialog_config,showHeader:!1,controlButtons:!1}}):e._e(),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(t){e.w.ok()}}},[e._v("OK")]),n("md-button",{staticClass:"md-accent",on:{click:function(t){e.w.cancel()}}},[e._v("Cancel")])],1)],1)},mo=[],ho={name:"joy-window",type:"imjoy/joy",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{plugin_dialog_config:null}},mounted:function(){var e=this;this.w&&(this.plugin_dialog_config=this.w,this.w.get_config=function(){return e.$refs.plugin_dialog_joy.joy.get_config()}),this.$emit("init")},methods:{getConfig:function(){}}},fo=ho,go=(n("151e"),Object(it["a"])(fo,po,mo,!1,null,null,null));go.options.__file="JoyWindow.vue";var _o=go.exports,vo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"schema-io"},e._l(e.ioPanels,function(t){return n("div",{key:t.id},["form"===t.type?[t.title?n("div",{staticClass:"panel-heading"},[e._v(e._s(t.title))]):e._e(),t.description?n("div",{staticStyle:{"padding-left":"1px","padding-right":"1px","padding-bottom":"10px",overflow:"auto"},domProps:{innerHTML:e._s(e.sanitizedMarked(t.description))}}):e._e(),n("vue-form-generator",{attrs:{schema:t.schema,model:t.data,options:t.options}}),e._l(t.buttons,function(i){return n("md-button",{key:i.label,class:i.class,on:{click:function(n){e.onSubmit(n,i.event_id,t.data)}}},[e._v("\n        "+e._s(i.label)+"\n      ")])})]:e._e(),"vega"===t.type?[t.title?n("div",{staticClass:"panel-heading"},[e._v(e._s(t.title))]):e._e(),n("div",{staticClass:"overflow-auto"},[t.description?n("div",{staticStyle:{"padding-left":"1px","padding-right":"1px","padding-bottom":"10px",overflow:"auto"},domProps:{innerHTML:e._s(e.sanitizedMarked(t.description))}}):e._e(),n("vega",{ref:t.id,refInFor:!0,attrs:{schema:t.schema,options:t.options}}),n("br"),e._l(t.buttons,function(i){return n("md-button",{key:i.label,class:i.class,on:{click:function(n){e.onSubmit(n,i.event_id,t.data)}}},[e._v("\n          "+e._s(i.label)+"\n        ")])})],2)]:e._e()],2)}))},wo=[],bo=n("4309"),yo=n.n(bo),ko=(n("92bd"),n("037c")),xo=n("7ad3");o["default"].use(yo.a),o["default"].component("vega",{props:["schema","options"],mounted:function(){var e=this;Object(xo["a"])(this.$el,this.schema,this.options||{actions:!1}).then(function(t){e.embed=t,e.view=t.view})},data:function(){return{view:null,embed:null}},methods:{updateView:function(e,t){var n=ko["changeset"]().insert(t);this.view.change(e,n).run()}},template:"<div></div>"});var jo={name:"schema-io-window",type:"imjoy/schema-io",props:{w:{type:Object,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{ioPanels:[]}},mounted:function(){if(this.w.data)if(Array.isArray(this.w.data)){var e=!0,t=!1,n=void 0;try{for(var i,o=this.w.data[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.ioPanels.push(a)}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}else this.ioPanels.push(this.w.data);this.$emit("init")},created:function(){var e=new rn.a.Renderer;e.link=function(e,t,n){var i=rn.a.Renderer.prototype.link.call(this,e,t,n);return i.replace("<a","<a target='_blank' ")},rn.a.setOptions({renderer:e}),O.a.addHook("afterSanitizeAttributes",function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}),O.a.addHook("afterSanitizeAttributes",function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}),this.sanitizedMarked=function(e){return O.a.sanitize(rn()(e))}},methods:{onSubmit:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n,i){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.preventDefault(),this.w.api.emit(n,i);case 2:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}(),append:function(e){if(Array.isArray(e)){var t=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;this.ioPanels.push(r)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}}else this.ioPanels.push(e)},remove:function(e){var t=this;this.ioPanels.filter(function(n,i){n.id===e&&t.ioPanels.splice(i,1)})},appendDataPoint:function(e,t,n){this.$refs[e][0].updateView(t,n)},getData:function(e){if(e)return this.ioPanels[e].data;var t={};for(var n in this.ioPanels)t[n]=this.ioPanels[n].data;return t}}},Co=jo,Oo=(n("77b0"),Object(it["a"])(Co,vo,wo,!1,null,null,null));Oo.options.__file="SchemaIOWindow.vue";var Po=Oo.exports,Eo={};for(var Do in i)Eo[i[Do].name]=i[Do];var Ro={name:"window",components:Eo,props:{w:{type:Object,default:function(){return null}},withDragHandle:{type:Boolean,default:function(){return!1}},loaders:{type:Object,default:function(){return null}}},data:function(){return{componentNames:{},options_menu_open:!1}},created:function(){for(var e in Eo)this.componentNames[Eo[e].type]=Eo[e].name},mounted:function(){var e=this;this.w&&(this.w.$el=this.$el,this.w.api.on("refresh",function(){e.refresh()}),this.w.api.on("focus",function(){e.w.standalone||e.$el.scrollIntoView(!0)}),this.w.fullscreen&&this.fullScreen(this.w));var t=new Fn["a"](function(t){e.w.api.emit("resize",t[0].contentRect)});t.observe(this.$el),setTimeout(function(){if(e.$refs["window-content"]){var t=e.$refs["window-content"],n=new Fn["a"](function(){setTimeout(function(){t.$el&&e.w.api.emit("window_size_changed",t.$el.getBoundingClientRect())},500)});n.observe(t.$el)}},100)},beforeDestroy:function(){this.w.closed=!0},watch:{w:function(){var e=this;this.w.api.on("refresh",function(){e.refresh()}),this.w.api.on("focus",function(){e.w.standalone||e.$el.scrollIntoView(!0)}),this.w.api.on("fullscreen",function(){e.fullScreen(e.w)}),this.w.standalone||this.$el.scrollIntoView(!0),this.w.fullscreen&&this.fullScreen(this.w)}},methods:{setAPI:function(){var e=this.$refs["window-content"];if(e)for(var t in this.w.api=this.w.api||{},e)!e.hasOwnProperty(t)||t.startsWith("$")||t.startsWith("_")||"function"!==typeof e[t]||(this.w.api[t]=e[t]);this.w.api.emit("ready")},refresh:function(){this.$forceUpdate()},close:function(e){this.$emit("close",e)},fullScreen:function(e){this.$emit("fullscreen",e)},detach:function(e){this.$emit("detach",e)},normalSize:function(e){this.$emit("normalsize",e)},duplicate:function(e){this.$emit("duplicate",e)},selectWindow:function(e,t){this.$emit("select",e,t)},printObject:function(e,t,n){console.log(e,t,n)}}},Io=Ro,Wo=(n("c0e0"),Object(it["a"])(Io,Un,Tn,!1,null,"4dd5ce1d",null));Wo.options.__file="Window.vue";var Mo=Wo.exports,So=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"engine-control-panel"},[n("md-menu",{attrs:{"md-size":"big","md-direction":"top-start"},on:{"md-closed":function(t){e.collapseProcesses()}}},[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":"",disabled:!e.engineManager||0==e.engineManager.engine_factories.length&&0==e.engineManager.engines.length}},[n("md-icon",[e._v("ð")]),n("md-tooltip",[e._v("ImJoy Plugin Engines")])],1),n("md-menu-content",{staticClass:"engine-panel"},[e._l(e.engineManager.engine_factories,function(t){return n("md-menu-item",{key:t.name,on:{click:function(e){t.addEngine()}}},[n("md-button",{staticClass:"md-icon-button md-primary median-icon-button"},[n("md-icon",[e._v("add")])],1),n("span",[e._v("Add "+e._s(t.name)+" ð")])],1)}),e._l(e.engineManager.engines,function(t){return[n("md-divider",{key:t.name+"_start_divider"}),t.connected&&t.getEngineStatus?n("md-menu-item",{key:t.name+t.url},[n("span",{staticClass:"md-list-item-content",staticStyle:{cursor:"pointer"},on:{click:function(n){n.stopPropagation(),t.show_processes?e.hide(t):e.expand(t)}}},[t.show_processes?n("md-icon",[e._v("remove")]):t.connected?n("md-icon",{staticClass:"md-primary"},[e._v("autorenew")]):t.connecting?n("div",{staticClass:"loading loading-lg"}):n("md-icon",[e._v("sync_disabled")]),n("span",[e._v(e._s(t.name.slice(0,20)))]),t.connected?n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.disconnectEngine(t)}}},[n("md-icon",[e._v("clear")]),n("md-tooltip",[e._v("Disconnect engine "+e._s(t.name)+"\n              ")])],1):e._e()],1)]):t.getEngineStatus?n("md-menu-item",{key:t.name,on:{click:function(e){e.stopPropagation(),t.connect(!1)}}},[n("span",{staticClass:"md-list-item-content",staticStyle:{cursor:"pointer"}},[n("md-icon",[e._v("sync_disabled")]),e._v(" "+e._s(t.name)+"\n            "),n("md-tooltip",[e._v("Connect to "+e._s(t.name)+" ")]),t.connected?e._e():n("md-button",{staticClass:"md-icon-button",on:{click:function(n){n.stopPropagation(),e.removeEngine(t)}}},[n("md-icon",[e._v("delete_forever")]),n("md-tooltip",[e._v("Remove engine "+e._s(t.name.slice(0,20))+"\n              ")])],1)],1)]):e._e(),t.connected&&t.show_processes?[n("md-menu-item",{key:t.name+"_show_info",on:{click:function(n){e.showAbout(t)}}},[e._v("\n            Â Â "),n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[e._v("info")])],1),e._v("\n            About Engine\n          ")],1),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:t.engine_status.plugin_processes,expression:"engine.engine_status.plugin_processes"}],key:t.name+"_start_terminal",on:{click:function(n){e.startTerminal(t)}}},[e._v("\n            Â Â "),n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[e._v("code")])],1),e._v("\n            Open terminal\n          ")],1),n("md-menu-item",{key:t.name+"_remove_engine",staticClass:"md-accent",on:{click:function(n){e.removeEngine(t)}}},[e._v("\n            Â Â "),n("md-button",{staticClass:"md-icon-button md-accent"},[n("md-icon",[e._v("delete_forever")])],1),e._v("Remove Engine\n          ")],1),e._l(t.engine_status.plugin_processes,function(i){return n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:t.engine_status.plugin_processes,expression:"engine.engine_status.plugin_processes"}],key:t.name+i.pid},[e._v("\n            Â Â "),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.kill(t,i)}}},[n("md-icon",[e._v("clear")])],1),e._v("\n            "+e._s(i.name)+" (#"+e._s(i.pid)+")\n          ")],1)}),t.engine_status.plugin_processes?e._e():n("md-menu-item",{key:t.name+"_processes"},[n("md-button",[n("div",{staticClass:"loading loading-lg"})])],1),t.engine_status.plugin_num>1?n("md-menu-item",{key:t.name+"_running_plugins",attrs:{disabled:!0}},[e._v("\n            Â Â Â Â  Â "),n("span",[e._v("Running Plugins: "+e._s(t.engine_status.plugin_num)+"\n            ")]),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),e.kill(t)}}},[n("md-icon",[e._v("clear")]),n("md-tooltip",[e._v("Kill all the running plugins")])],1)],1):e._e(),n("md-divider",{key:t.name+"_end_divider"})]:e._e()]})],2)],1),n("md-dialog",{attrs:{"md-active":e.showEngineInfoDialog,"md-click-outside-to-close":!0,"md-close-on-esc":!0},on:{"update:mdActive":function(t){e.showEngineInfoDialog=t}}},[n("md-dialog-title",[e._v("About Plugin Engine\n      "),n("md-button",{staticClass:"md-accent",staticStyle:{position:"absolute",top:"8px",right:"5px"},on:{click:function(t){e.showEngineInfoDialog=!1}}},[n("md-icon",[e._v("clear")])],1)],1),e.selected_engine?n("md-dialog-content",[n("h4",[n("a",{attrs:{href:e.selected_engine.url,target:"_blank"}},[e._v("\n          "+e._s(e.selected_engine.url.replace(e.local_engine_url,"My computer ("+e.local_engine_url+")"))+"\n        ")])]),n("md-field",[n("label",{attrs:{for:"connection_token"}},[e._v("Connection Token")]),n("md-input",{attrs:{type:"password",name:"connection_token"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.connectEngine(e.selected_engine)}},model:{value:e.selected_engine.config.token,callback:function(t){e.$set(e.selected_engine.config,"token",t)},expression:"selected_engine.config.token"}})],1),e.selected_engine.connected?n("md-button",{staticClass:"md-accent",on:{click:function(t){e.disconnectEngine(e.selected_engine)}}},[n("md-icon",[e._v("sync_disabled")]),e._v("Disconnect")],1):n("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.connectEngine(e.selected_engine)}}},[n("md-icon",[e._v("sync")]),e._v(" Connect")],1),n("md-button",{staticClass:"md-primary",attrs:{disabled:!e.selected_engine.connected},on:{click:function(t){e.expand(e.selected_engine)}}},[n("md-icon",[e._v("autorenew")]),e._v(" Processes\n      ")],1),e.selected_engine.connected?n("md-button",{staticClass:"md-primary",attrs:{disabled:!e.selected_engine.connected},on:{click:function(t){e.startTerminal(e.selected_engine),e.showEngineInfoDialog=!1}}},[n("md-icon",[e._v("code")]),e._v(" Terminal\n      ")],1):e._e(),n("md-menu",[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[e._v("more_horiz")])],1),n("md-menu-content",[n("md-menu-item",{attrs:{disabled:!e.selected_engine.connected||e.show_sys_info,target:"_blank"},on:{click:function(t){t.stopPropagation(),e.show_sys_info=!0,e.hide(e.selected_engine)}}},[n("md-icon",[e._v("info")]),e._v(" System Information\n          ")],1),n("md-menu-item",{attrs:{target:"_blank"},on:{click:function(t){t.stopPropagation(),e.openEngineUrl(e.selected_engine.url)}}},[n("md-icon",[e._v("launch")]),e._v(" Open Engine Site\n          ")],1),e.selected_engine.connected?n("md-menu-item",{staticClass:"md-accent",on:{click:function(t){t.stopPropagation(),e.resetEngine(e.selected_engine)}}},[n("md-icon",[e._v("restore")]),e._v(" Reset\n          ")],1):e._e(),n("md-menu-item",{staticClass:"md-accent",on:{click:function(t){e.removeEngine(e.selected_engine),e.showEngineInfoDialog=!1,e.selected_engine=null}}},[n("md-icon",[e._v("delete_forever")]),e._v("Remove\n          ")],1)],1)],1),n("md-divider"),e.selected_engine.connected&&e.selected_engine.engine_info?n("div",[n("br"),n("code",[e._v("\n          ImJoy Plugin Engine (v"+e._s(e.selected_engine.engine_info.version)+",\n          api: v"+e._s(e.selected_engine.engine_info.api_version)+")\n        ")])]):e._e(),e.selected_engine.connected&&e.show_sys_info&&e.selected_engine.engine_info.platform?n("div",{staticClass:"platform-info"},[n("div",[n("br"),n("code",[e._v("## Platform")]),n("br"),e._l(e.selected_engine.engine_info.platform,function(t,i){return n("code",{key:i},[e._v("\n            - "+e._s(i)+": "+e._s(t)+"\n            "),n("br")])})],2),e._l(e.selected_engine.engine_info.GPUs,function(t){return n("div",{key:t.id},[n("br"),n("code",[e._v("## GPU "+e._s(t.id))]),n("br"),e._l(t,function(t,i){return n("code",{key:i},[e._v("- "+e._s(i)+": "+e._s(t)),n("br")])})],2)})],2):e._e(),e.selected_engine.connected&&e.selected_engine.show_processes?n("div",[n("br"),n("md-divider"),n("ul",[e._l(e.selected_engine.engine_status.plugin_processes,function(t){return n("li",{directives:[{name:"show",rawName:"v-show",value:e.selected_engine.engine_status.plugin_processes,expression:"selected_engine.engine_status.plugin_processes"}],key:t.pid},[e._v("\n            Â "),n("md-button",{staticClass:"md-icon-button md-accent small-icon-button",on:{click:function(n){n.stopPropagation(),e.kill(e.selected_engine,t)}}},[n("md-icon",[e._v("clear")])],1),e._v("\n            "+e._s(t.name)+" (#"+e._s(t.pid)+")\n          ")],1)}),e.selected_engine.engine_status.plugin_processes?e._e():n("li",[n("md-button",[n("div",{staticClass:"loading loading-lg"})])],1),e.selected_engine.engine_status.plugin_num>1?n("li",{attrs:{disabled:!0}},[n("md-button",{staticClass:"md-accent ",on:{click:function(t){t.stopPropagation(),e.kill(e.selected_engine)}}},[n("md-icon",[e._v("clear")]),e._v(" Kill All ("+e._s(e.selected_engine.engine_status.plugin_num)+"\n              Running Plugins)\n            ")],1)],1):e._e()],2)],1):e._e()],1):e._e()],1)],1)},Ao=[],$o={name:"engine-control-panel",props:["engineManager"],data:function(){return{engine_url:"",local_engine_url:"http://127.0.0.1:9527",engine_url_list:[],connection_token:null,showEngineInfoDialog:!1,selected_engine:null,show_sys_info:!1,showAddEngineDialog:!1,url_type:"localhost"}},created:function(){this.is_mobile_or_tablet=Object(j["j"])(),this.event_bus=this.$root.$data.store&&this.$root.$data.store.event_bus},mounted:function(){this.is_mobile_or_tablet&&(this.url_type="remote",this.engine_url="")},beforeDestroy:function(){},methods:{showDialog:function(e){e.engine?(this.showAddEngineDialog=!1,this.selected_engine=e.engine,this.showEngineInfoDialog=e.show):(this.showEngineInfoDialog=!1,this.showAddEngineDialog=e.show)},forceUpdate:function(){this.$forceUpdate()},expand:function(e){this.show_sys_info=!1,e.show_processes=!0,this.$forceUpdate(),this.update(e)},hide:function(e){e.show_processes=!1,this.$forceUpdate()},update:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.engine_status.plugin_processes=null,this.$forceUpdate(),e.next=4,t.getEngineStatus();case 4:t.engine_status=e.sent,this.$forceUpdate();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),kill:function(e,t){var n=this;e.engine_status.plugin_processes=null,e.killPluginProcess(t).finally(function(){n.update(e)})},collapseProcesses:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=this.engineManager.engines[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.show_processes=!1}}catch(r){t=!0,n=r}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.$forceUpdate()},showAddEngine:function(){this.showAddEngineDialog=!0},hideAddEngine:function(){this.showAddEngineDialog=!1},removeEngine:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.engineManager.getFactory(t.factory),!n){e.next=10;break}return e.next=4,n.removeEngine({name:t.name,url:t.url});case 4:if(i=e.sent,!i){e.next=8;break}return e.next=8,this.engineManager.unregister(t);case 8:e.next=11;break;case 10:throw"Engine factory not found for "+t.name;case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),connectEngine:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.connected){e.next=5;break}return t.connecting=!0,e.next=5,t.connect();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error(e.t0);case 10:return e.prev=10,t.connecting=!1,e.finish(10);case 13:case"end":return e.stop()}},e,this,[[0,7,10,13]])}));return function(t){return e.apply(this,arguments)}}(),disconnectEngine:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.connected){e.next=4;break}return e.next=3,t.disconnect();case 3:t.connected=!1;case 4:this.$forceUpdate();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),startTerminal:function(e){this.$emit("start-terminal",e)},showToken:function(e){this.engine_url=e.config.url,this.connection_token=e.config.token},resetEngine:function(e){e.resetEngine()},showAbout:function(e){e.about?e.about():(this.show_sys_info=!1,this.selected_engine=e,this.showEngineInfoDialog=!0)},openEngineUrl:function(e){window.open(e,"_blank")}}},Uo=$o,To=(n("32c4"),Object(it["a"])(Uo,So,Ao,!1,null,"16a37a3e",null));To.options.__file="EngineControlPanel.vue";var Fo=To.exports,Lo=n("9483");Object(Lo["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(e){console.log("New content is available; please refresh.");var t=e.waiting;t.postMessage({action:"skipWaiting"})},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),o["default"].config.productionTip=!1,o["default"].use(yt.a),o["default"].component("navbar",Ut),o["default"].component("imjoy",at),o["default"].component("main-footer",zt),o["default"].component("about",dt),o["default"].component("whiteboard",Gt),o["default"].component("joy",tn),o["default"].component("plugin-list",un),o["default"].component("plugin-editor",_n),o["default"].component("plugin-icon",xn),o["default"].component("file-item",Rn),o["default"].component("file-dialog",$n),o["default"].component("window",Mo),o["default"].component("grid-layout",Dt.a.GridLayout),o["default"].component("grid-item",Dt.a.GridItem),o["default"].component("engine-control-panel",Fo);var No=function(e,t,n){n=n||"...";var i=document.createElement("div");i.innerHTML=e;var o=i.textContent;return o.length>t?o.slice(0,t)+n:o};o["default"].filter("truncate",No),new o["default"]({el:"#imjoy-app",router:wt,data:{store:It,router:wt},template:"<App/>",components:{App:Pt}})},5865:function(e,t,n){"use strict";var i=n("fd0e"),o=n.n(i);o.a},"5e6b":function(e,t,n){},"659e":function(e,t,n){},"65d2":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return s});n("55dd"),n("7f7f"),n("6c7b"),n("6b54"),n("4917"),n("34ef"),n("3b2b"),n("386d"),n("28a5"),n("a481"),n("7514"),n("96cf");var i=n("1da1"),o=n("53ca"),a=(n("ac4d"),n("8a81"),n("ac6a"),n("c0c4")),r=n.n(a);function s(e){var t=this==window?{}:this;if(e.modules)for(var n=0;n<e.modules.length;n++)s.loadModule(e.modules[n]);return s.Op.call(t,e),s.initReferences(t),void 0==t.previewOps&&(t.previewOps=!1),void 0==t.previewNumbers&&(t.previewNumbers=!1),t.activePreview=null,t.canPreview=function(e){e=e.charAt(0).toUpperCase()+e.slice(1);var n=t["preview"+e];return n&&!t.activePreview},t.createWidget(),t.container&&("string"===typeof t.container&&(t.container=document.body.querySelector(t.container)),t.container.appendChild(t.dom)),s.ui.init(t),s.modal.init(t),t}s.normalizeUI=function(e){if(!e)return"";var t="";if(Array.isArray(e)){var n=!0,i=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var c=r.value;if("string"===typeof c)t=t+c+"<br>";else if("object"===Object(o["a"])(c))for(var l in c)t="string"===typeof c[l]?t+l+": "+c[l]+"<br>":t+l+": "+JSON.stringify(c[l])+"<br>";else t=t+JSON.stringify(c)+"<br>"}}catch(u){i=!0,a=u}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}else{if("object"===Object(o["a"])(e))throw"ui can not be an object, you can only use a string or an array.";"string"===typeof e?t=e.trim():(t="",console.log("Warning: removing ui string."))}return t},s.Op=function(e,t,n){var a=this;if(a._class_="Op",a.options=e,a.parent=t,a.top=a.parent?a.parent.top:a,a.type=e.type,a.type){var r=s.getTemplateByType(a.type);l(a,r)}if(l(a,a.options),t&&"object"==Object(o["a"])(t.onupdate)&&t.onupdate[a.id]&&(a.onupdate=t.onupdate[a.id]),a.children=[],a.addChild=function(e,t){return"object"==Object(o["a"])(a.onupdate)&&a.onupdate[e.id]&&(e.onupdate=a.onupdate[e.id]),"Op"!=e._class_&&(e=new s.Op(e,a,t)),a.children.push(e),e.id&&(a[e.id]=e),e},a.removeChild=function(e){u(a.children,e),e.kill()},a.onkill=a.onkill||function(){},a.kill=function(){a.dom&&a.dom.parentNode&&a.dom.parentNode.removeChild(a.dom);while(a.children.length>0)a.removeChild(a.children[0]);a.onkill(a)},void 0===a.placeholder&&(a.placeholder={}),"function"===typeof a.placeholder&&(a.placeholder=a.placeholder()),("object"!==Object(o["a"])(a.placeholder)||Array.isArray(a.placeholder))&&(a.placeholder={value:c(a.placeholder)}),a.placeholder.type||(a.placeholder.type=a.type),a.data=a.data||n,!a.data){t=a.parent;var d=a.dataID;t&&d?(t.data[d]||(t.data[d]=c(a.placeholder)),a.data=t.data[d]):a.data=c(a.placeholder)}a.getData=function(e){return a.data[e]},a.setData=function(e,t,n){!0,void 0===t?delete a.data[e]:a.data[e]=t,setTimeout(function(){!1},1),n||a.update()},a.dom=null,a.initWidget=a.initWidget||function(){a.dom=document.createElement("span"),a.dom.innerHTML="[todo: define ui for '"+a.type+"']"},a.createWidget=function(){return a.initWidget(a),a.dom},a.previewData=null,a.onexecute=a.onexecute||function(){console.log("no execute function found.")},a.execute=function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=n?c(n):a.previewData?c(a.previewData):c(a.data),a.children.forEach(function(e){var n=e.dataID;if(n){var o=e.get(t);i[n]=o}}),e.next=4,a.onexecute({op:a,target:t,data:i});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),a.update=function(){if(a.parent&&a.parent.update(),a.onupdate&&"function"===typeof a.onupdate){var e;e=a.previewData?c(a.previewData):c(a.data),a.children.forEach(function(t){var n=t.dataID;if(n){var i=t.get({});e[n]=i}});a.onupdate({data:e})}},a.get_config=function(e){var t;return e=e||{},t=a.previewData?c(a.previewData):c(a.data),a.children.forEach(function(n){var i=n.dataID;if(i&&e){var o=n.get(e);t[i]=o}}),t},a.onget=a.onget||function(e){return e.data},a.get=function(e){var t=a.previewData?a.previewData:a.data;return t=c(t),a.onget({op:a,target:e,data:t})},a.init&&("string"===typeof a.init&&s.initializeWithString(a,a.init),"function"===typeof a.init&&a.init(a))},s.templates=[],s.add=function(e){var t=s.templates.filter(function(t){return void 0!==t.type&&void 0!==e.type&&t.type===e.type});if(t.length<=0)s.templates.push(e);else{for(var n=0;n<t.length;n++)u(s.templates,t[n]);s.templates.push(e)}},s.remove=function(e){var t=s.templates.filter(function(t){if(t.type===e)return!0});if(t.length>0)for(var n=0;n<t.length;n++)u(s.templates,t[n])},s.reset=function(){s.templates=[]},s.getTemplateByType=function(e){var t=s.templates.find(function(t){return t.type===e});if(!t)throw Error("No op template of type '"+e+"'!");return t},s.getTemplatesByTag=function(e){return s.templates.filter(function(t){return t.tags&&t.tags.indexOf(e)>=0})},s.modify=function(){var e,t,n;2==arguments.length?(e=arguments[0],n=arguments[1]):(e=arguments[0],t=arguments[1],n=arguments[2]);var i={},o=s.getTemplateByType(e);l(i,o);var a=n(o);l(i,a),t?o.type=t:u(s.templates,o),s.add(i)},s.initializeWithString=function(e,t){try{t=r.a.sanitize(t)}catch(d){console.log("Failed to sanitize the ui string",d)}for(var n=[],i=t,o=-1,a=-1,s=0,c=0;c<i.length;c++){var l=i[c];if(0==s&&"{"==l&&(o=c),"{"==l&&s++,"}"==l&&s--,0==s&&"}"==l){a=c+1;var u=i.slice(o,a);u=u.replace(/(\w+)\:/g,"'$1':"),u=u.replace(/\'/g,'"'),u=JSON.parse(u),u.dataID=u.dataID||u.id,n.push(u),i=i.substr(0,o)+"<span id='widget_"+u.id+"'></span>"+i.substr(a),c=0,o=-1,a=-1,s=0}}n.forEach(function(t){e.addChild(t)}),e.createWidget=function(){return e.dom=document.createElement("span"),e.dom.innerHTML=i,e.children.forEach(function(t){t.createWidget();var n="#widget_"+t.id,i=e.dom.querySelector(n);e.dom.replaceChild(t.dom,i)}),e.dom}},s.modules={},s.module=function(e,t){s.modules[e]=t},s.loadModule=function(e){var t=s.modules[e];if(!t)throw Error("There's no module called '"+e+"'!");t()},s.initReferences=function(e){var t=e.top.data;for(var n in t._references||(t._references={}),t._references){var i=t._references[n];i.connected=0}},s.createReference=function(e,t,n){var i=e.top.data,o={id:w(i._references),tags:b(t),data:n,connected:0};return i._references[o.id]=o,o},s.getReferenceById=function(e,t){var n=e.top.data;return n._references[t]},s.getReferencesByTag=function(e,t){var n=e.top.data,i=[];for(var o in n._references){var a=n._references[o];a.tags.indexOf(t)>=0&&i.push(a)}return i},s.connectReference=function(e,t){var n=s.getReferenceById(e,t);n.connected++},s.disconnectReference=function(e,t){var n=s.getReferenceById(e,t);n.connected--,0==n.connected&&s.deleteReference(e,t)},s.deleteReference=function(e,t){var n=e.top.data;n._references[t];delete n._references[t]},s.encodeWorkflow=function(e){var t=JSON.stringify(e),n=D.compressToEncodedURIComponent(t);return n},s.decodeWorkflow=function(e){var t=D.decompressFromEncodedURIComponent(e);if(t){var n=JSON.parse(t);return n}return null},s.saveToURL=function(e){var t=JSON.stringify(e),n=D.compressToEncodedURIComponent(t),i=window.location.origin+window.location.pathname+"#/app?workflow="+n;return i},s.loadFromURL=function(){var e=k("workflow"),t=D.decompressFromEncodedURIComponent(e);if(t){var n=JSON.parse(t);return n}return null},Math.TAU=2*Math.PI;var c=function(e){return JSON.parse(JSON.stringify(e))},l=function(e,t){for(var n in t){var i=t[n];e[n]=i}},u=function(e,t){var n=e.indexOf(t);return!(n<0)&&(e.splice(n,1),!0)},d=function(e){if(!+e)return NaN;var t=String(+e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",o=3;while(o--)i=(n[+t.pop()+10*o]||"")+i;var a=Array(+t.join("")+1).join("M")+i;return a.toLowerCase()},p=function(e){var t="abcdefghijklmnopqrstuvwxyz",n=0,i=1;while(e>=i)n++,e-=i,i*=26;for(var o="",a=0;a<n;a++)o=t.charAt(e%26)+o,e=Math.floor(e/26);return o},m=function(e){var t,n;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(n=t.getRangeAt(0),n.deleteContents(),n.insertNode(document.createTextNode(e)))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=e)},h=function(e){e.addEventListener("paste",function(e){if(e.preventDefault(),e.clipboardData&&e.clipboardData.getData){var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}else if(window.clipboardData&&window.clipboardData.getData){t=window.clipboardData.getData("Text");m(t)}})},f=function(e,t){var n=document.createRange();n.selectNodeContents(e),t&&n.collapse(!1);var i=window.getSelection();i.removeAllRanges();try{i.addRange(n)}catch(o){}},g=function(){var e=window.getSelection();e.removeAllRanges()},_=function(e){""==e.innerText&&(e.innerHTML="&nbsp;",f(e)),e.innerHTML.search("<br>")>=0&&(e.innerHTML=e.innerHTML.replace(/(\<br\>)+/g,"&nbsp;"),f(e,!0))},v=function(e){e.addEventListener("keypress",function(t){13===t.which&&(t.preventDefault(),e.blur())})},w=function(e){var t,n=0;do{t="id"+n,n++}while(e[t]);return t},b=function(e){return Array.isArray(e)?e:[e]},y=function(e){while(e.hasChildNodes())e.removeChild(e.lastChild)},k=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null};function x(e,t,n){var i,o,a,r,s,c,l,u;switch(1===arguments.length&&(t=e.s,n=e.v,e=e.h),e/=360,r=Math.floor(6*e),s=6*e-r,c=n*(1-t),l=n*(1-s*t),u=n*(1-(1-s)*t),r%6){case 0:i=n,o=u,a=c;break;case 1:i=l,o=n,a=c;break;case 2:i=c,o=n,a=u;break;case 3:i=c,o=l,a=n;break;case 4:i=u,o=c,a=n;break;case 5:i=n,o=c,a=l;break}return[Math.round(255*i),Math.round(255*o),Math.round(255*a)]}function j(e,t,n){1===arguments.length&&(t=e[1],n=e[2],e=e[0]);var i=x(e,t,n);return"rgb("+i[0]+","+i[1]+","+i[2]+")"}var C=0,O=[[0,.6,1],[30,.8,1],[210,.8,1],[260,.7,1],[310,.6,1]];function P(){var e=O[C];return C=(C+1)%O.length,e}function E(e){return Array.isArray(e)&&(e=j(e[0],e[1],e[2])),e}var D=function(){function e(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},a={compressToBase64:function(e){if(null==e)return"";var t=a._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,function(i){return e(n,t.charAt(i))})},compressToUTF16:function(e){return null==e?"":a._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),i=0,o=t.length;o>i;i++){var r=t.charCodeAt(i);n[2*i]=r>>>8,n[2*i+1]=r%256}return n},decompressFromUint8Array:function(e){if(null===e||void 0===e)return a.decompress(e);for(var n=new Array(e.length/2),i=0,o=n.length;o>i;i++)n[i]=256*e[2*i]+e[2*i+1];var r=[];return n.forEach(function(e){r.push(t(e))}),a.decompress(r.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,function(e){return i.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,function(n){return e(i,t.charAt(n))}))},compress:function(e){return a._compress(e,16,function(e){return t(e)})},_compress:function(e,t,n){if(null==e)return"";var i,o,a,r={},s={},c="",l="",u="",d=2,p=3,m=2,h=[],f=0,g=0;for(a=0;a<e.length;a+=1)if(c=e.charAt(a),Object.prototype.hasOwnProperty.call(r,c)||(r[c]=p++,s[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(r,l))u=l;else{if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,g==t-1?(g=0,h.push(n(f)),f=0):g++;for(o=u.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o=0;for(o=u.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}d--,0==d&&(d=Math.pow(2,m),m++),delete s[u]}else for(o=r[u],i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;d--,0==d&&(d=Math.pow(2,m),m++),r[l]=p++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,g==t-1?(g=0,h.push(n(f)),f=0):g++;for(o=u.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o=0;for(o=u.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1}d--,0==d&&(d=Math.pow(2,m),m++),delete s[u]}else for(o=r[u],i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;d--,0==d&&(d=Math.pow(2,m),m++)}for(o=2,i=0;m>i;i++)f=f<<1|1&o,g==t-1?(g=0,h.push(n(f)),f=0):g++,o>>=1;for(;;){if(f<<=1,g==t-1){h.push(n(f));break}g++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(e,n,i){var o,a,r,s,c,l,u,d=[],p=4,m=4,h=3,f="",g=[],_={val:i(0),position:n,index:1};for(o=0;3>o;o+=1)d[o]=o;for(r=0,c=Math.pow(2,2),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;switch(r){case 0:for(r=0,c=Math.pow(2,8),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;u=t(r);break;case 1:for(r=0,c=Math.pow(2,16),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;u=t(r);break;case 2:return""}for(d[3]=u,a=u,g.push(u);;){if(_.index>e)return"";for(r=0,c=Math.pow(2,h),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;switch(u=r){case 0:for(r=0,c=Math.pow(2,8),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;d[m++]=t(r),u=m-1,p--;break;case 1:for(r=0,c=Math.pow(2,16),l=1;l!=c;)s=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=i(_.index++)),r|=(s>0?1:0)*l,l<<=1;d[m++]=t(r),u=m-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,h),h++),d[u])f=d[u];else{if(u!==m)return null;f=a+a.charAt(0)}g.push(f),d[m++]=a+f.charAt(0),p--,a=f,0==p&&(p=Math.pow(2,h),h++)}}};return a}();"function"==typeof define&&n("3c35")&&define(function(){return D}),function(){var e={};s.ui=e,e.init=function(e){e.dom.classList.add("joy-master"),e.container.addEventListener("wheel",function(t){var n=t.deltaY;return e.container.scrollTop+=n,!1})},e.Button=function(e){var t=this,n=document.createElement("div");n.className="joy-button",t.dom=n,e.label=e.label||"",t.label=document.createElement("span"),n.appendChild(t.label),t.setLabel=function(e){t.label.innerHTML=e},t.setLabel(e.label),n.onclick=function(){e.onclick()},t.styles=e.styles||[];for(var i=0;i<t.styles.length;i++)n.classList.add(t.styles[i])},e.ChooserButton=function(t){var n=this;n.value=t.value,n.options=t.options,n.onchange=t.onchange,n.value||(n.value=n.options[0].value),e.Button.call(n,{label:void 0===t.staticLabel?"":t.staticLabel,onclick:function(){s.modal.Chooser({source:n.dom,options:n.options,onchange:function(e){n.value=e,i(),n.onchange(e)},position:t.position})},styles:t.styles});var i=function(){if(void 0===t.staticLabel){var e=n.options.find(function(e){return e.value==n.value}).label;n.setLabel(e)}};i()},e.Scrubber=function(e){var t=this,n=e.min,i=e.max;t.value=e.value;var o=document.createElement("div");o.className="joy-scrubber",t.dom=o,t.setLabel=function(e){o.innerHTML=e.toFixed(t.sigfigs)};var a,r,s=function(n){n=parseFloat(n.toFixed(t.sigfigs)),e.onchange(n)},c=!1,l=!1,u=0,d=function(n){c=!0,a=n.clientX,r=t.value,u=0,e.onstart&&e.onstart()},p=function(e){if(c){l=!0;var n=Math.pow(.1,t.sigfigs);n=parseFloat(n.toPrecision(1));var i=e.clientX-a;a=e.clientX;var o=Math.abs(i/10);o<1&&(o=1),o>3&&(o=3),u+=i*o;var d=Math.floor(u/2),p=r+d*n;p=m(p),t.value!=p&&(t.value=p,t.setLabel(p),s(p))}},m=function(e){return void 0!==n&&e<n&&(e=n),void 0!==i&&e>i&&(e=i),e},w=function(){c=!1,e.onstop&&e.onstop(),setTimeout(function(){l=!1},1)};o.addEventListener("mousedown",d),window.addEventListener("mousemove",p),window.addEventListener("mouseup",w),t.kill=function(){o.removeEventListener("mousedown",d),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",w)};var b=!1;o.onblur=function(){b&&(b=!1,o.contentEditable=!1,g(),k(o.innerText),t.value=y(),t.setLabel(t.value),s(t.value),e.onstop&&e.onstop())},h(o),v(o),o.onclick=function(){l||(b=!0,o.contentEditable=!0,o.spellcheck=!1,f(o),e.onstart&&e.onstart())},o.oninput=function(e){if(b){var t=/[^0-9.\-]/g;o.innerText.match(t)&&(o.innerText=o.innerText.replace(t,"")),_(o),s(y())}};var y=function(){var e=parseFloat(o.innerText);return isNaN(e)&&(e=0),e=m(e),e};t.sigfigs=0;var k=function(e){var n;e=e.toString();var i=e.search(/\./);n=i>=0?e.length-1-i:0,t.sigfigs=n};k(t.value),t.setLabel(t.value)},e.String=function(e){var t=this,n=document.createElement("div");n.className="joy-string",t.dom=n;var i=document.createElement("span");i.contentEditable=!0,i.spellcheck=!1;var o=document.createElement("span"),a=document.createElement("span");o.innerHTML=e.prefix||"",a.innerHTML=e.suffix||"",n.appendChild(o),n.appendChild(i),n.appendChild(a),i.oninput=function(t){_(i);var n=i.innerText;e.onchange(n)},i.onfocus=function(){f(i)},i.onblur=function(){g()},h(i),i.onkeypress=function(e){return 13!=e.which||(i.blur(),!1)},t.setString=function(e){i.innerText=e,_(i)},t.setColor=function(e){e=E(e),n.style.color=e,n.style.borderColor=e},e.color&&t.setColor(e.color),t.styles=e.styles||[];for(var r=0;r<t.styles.length;r++)n.classList.add(t.styles[r]);t.setString(e.value)},e.TextBox=function(e){var t,n=this;e.multiline?t=document.createElement("textarea"):(t=document.createElement("input"),t.type="text"),e.placeholder&&(t.placeholder=e.placeholder),t.spellcheck=!1,t.className="joy-textbox",n.dom=t;var i=n.dom;e.readonly?(t.setAttribute("readonly",1),t.addEventListener("click",function(){n.select()})):t.oninput=function(n){e.onchange(t.value)},e.width&&(t.style.width="number"===typeof e.width?e.width+"px":e.width),n.getValue=function(){return t.value},n.setValue=function(e){t.value=e},n.select=function(){t.select()},n.styles=e.styles||[];for(var o=0;o<n.styles.length;o++)i.classList.add(n.styles[o]);if(e.value&&n.setValue(e.value),e.multiline){var a=function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"};i.addEventListener("input",a,!1),setTimeout(function(){i.setAttribute("style","height:"+i.scrollHeight+"px; overflow-y:hidden;")},1)}}}(),function(){var e={};s.modal=e,e.init=function(t){for(var n=document.querySelectorAll("#joy-modal"),i=0;i<n.length;i++)n[i].parentNode.removeChild(n[i]);e.dom=document.createElement("div"),e.dom.id="joy-modal",document.body.appendChild(e.dom),e.bg=document.createElement("div"),e.bg.id="joy-bg",e.bg.onclick=function(){e.currentUI.kill()},e.dom.appendChild(e.bg),e.box=document.createElement("div"),e.box.id="joy-box",e.box.className="arrow_box",e.dom.appendChild(e.box),e.dom.addEventListener("wheel",function(t){return"auto"==e.box.style.overflow||(t.preventDefault(),!1)})},e.show=function(t){e.dom.style.display="block",e.currentUI=t,e.box.appendChild(t.dom);var n=t.config.position||"below",i=e.box.getBoundingClientRect(),o=t.config.source.getBoundingClientRect(),a=e.bg.getBoundingClientRect(),r=20;if("below"==n){var s=o.top+o.height+r;s+i.height>document.body.clientHeight&&(n="left")}switch(e.box.setAttribute("position",n),n){case"below":var c=o.left+o.width/2;s=o.top+o.height+r;c-=i.width/2;break;case"left":c=o.left-r,s=o.top+o.height/2;c-=i.width,s-=i.height/2;break}c<0&&(c=1),s+i.height>a.height&&(s=a.height-i.height-1),e.box.style.left=c+"px",e.box.style.top=s+"px",e.currentUI.config.onopen&&e.currentUI.config.onopen()},e.hide=function(){y(e.box),e.dom.style.display="none",e.currentUI.config.onclose&&e.currentUI.config.onclose()},e.Chooser=function(t){var n={};n.config=t;var i=document.createElement("div");i.className="joy-modal-chooser",n.dom=i;var o=document.createElement("div");i.appendChild(o),n.options=[],n.categories={};var a="_placeholder_",r=function(e){var t=document.createElement("div");o.appendChild(t),n.categories[e]=t};n.populate=function(){for(var e=0;e<t.options.length;e++){var i=t.options[e],o=i.category;o?n.categories[o]||r(o):n.categories[a]||r(a)}for(e=0;e<t.options.length;e++){i=t.options[e];var s=document.createElement("div");s.innerHTML=i.label,i.color&&(s.style.color=i.color);o=i.category||a;n.categories[o].appendChild(s),function(e){s.onclick=function(t){n.onchange(e.value),t.stopPropagation()}}(i)}},n.populate(),n.onchange=function(e){n.kill(),t.onchange(e)},n.kill=function(){e.hide()},e.show(n)},e.Color=function(t){var n={};n.config=t;var i=document.createElement("div");i.className="joy-modal-color",n.dom=i,t.value=t.value||[0,1,1],n.h=t.value[0],n.s=t.value[1],n.v=t.value[2];var o=150,a=15,r=10,s=10,c=10,l=r+o+s+a+c,u=r+o+c;n.dom.style.width=l+"px",n.dom.style.height=u+"px";var d=document.createElement("canvas");d.id="joy-color-wheel";var p=d.getContext("2d");d.width=2*o,d.height=2*o,d.style.width=d.width/2+"px",d.style.height=d.height/2+"px",i.appendChild(d),d.style.top=r+"px",d.style.left=r+"px";var m=function(){var e=p;e.clearRect(0,0,e.canvas.width,e.canvas.height);for(var t=d.width,i=d.height,o=e.createImageData(t,i),a=o.data,r=t/2,s=i/2,c=t/2,l=c+2,u=0;u<t;u++)for(var m=0;m<i;m++){var h=u-r,f=m-s,g=Math.sqrt(h*h+f*f);if(g<l){g>=c&&(g=c);var _=Math.atan2(f,h);_=360*(_/Math.TAU+.5),g/=c;var v=_,w=g,b=n.v,y=x(v,w,b),k=4*(u+m*t);a[k]=y[0],a[k+1]=y[1],a[k+2]=y[2],a[k+3]=255}}e.putImageData(o,0,0),e.save(),e.globalCompositeOperation="destination-in",e.beginPath(),e.fillStyle="#fff",e.arc(r,s,c,0,Math.TAU),e.fill(),e.restore()};m();var h=document.createElement("canvas");h.id="joy-color-value";var f=h.getContext("2d");h.width=2*a,h.height=2*o,h.style.width=h.width/2+"px",h.style.height=h.height/2+"px",i.appendChild(h),h.style.top=r+"px",h.style.right=c+"px";var g=function(){var e=f;e.clearRect(0,0,e.canvas.width,e.canvas.height);for(var t=h.width,i=h.height,o=e.createImageData(t,i),a=o.data,r=0;r<t;r++)for(var s=0;s<i;s++){var c=n.h,l=n.s,u=1-s/i,d=x(c,l,u),p=4*(r+s*t);a[p]=d[0],a[p+1]=d[1],a[p+2]=d[2],a[p+3]=255}e.putImageData(o,0,0)};g();var _=document.createElement("canvas");_.id="joy-color-picker";var v=_.getContext("2d");_.width=2*l,_.height=2*u,_.style.width=_.width/2+"px",_.style.height=_.height/2+"px",i.appendChild(_);var w,b=function(){var e,t,i=v;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.fillStyle=j(n.h,n.s,n.v),i.strokeStyle="#fff",i.lineWidth=2;var o=2*r+d.width/2,c=2*r+d.height/2,l=n.h*(Math.TAU/360),u=n.s*(d.width/2);e=o-Math.cos(l)*u,t=c-Math.sin(l)*u,i.beginPath(),i.arc(e,t,a,0,Math.TAU),i.fill(),i.stroke();var p=2*r+d.width+2*s+h.width/2,m=2*r;e=p,t=m+h.height*(1-n.v),i.beginPath(),i.arc(e,t,a,0,Math.TAU),i.fill(),i.stroke()};b();var y=!1,k=function(e){if(e.target==_){var t=2*e.offsetX,n=2*e.offsetY;"hs"==w?(t-=2*r,n-=2*r,C(t,n)):(t-=2*r+d.width+2*s,n-=2*r,O(t,n)),R()}},C=function(e,t){var i=d.width/2,o=e-i,a=t-i,r=Math.atan2(a,o),s=Math.sqrt(o*o+a*a);r=360*(r/Math.TAU+.5),r<0&&(r=0),r>360&&(r=360),s/=i,s<0&&(s=0),s>1&&(s=1),n.h=r,n.s=s,g(),b()},O=function(e,t){n.v=1-t/h.height,n.v<0&&(n.v=0),n.v>1&&(n.v=1),m(),b()},P=function(e){y=!0,w=2*e.offsetX<2*r+d.width+s?"hs":"v",k(e)},E=function(e){y&&k(e)},D=function(){y=!1};_.addEventListener("mousedown",P),window.addEventListener("mousemove",E),window.addEventListener("mouseup",D);var R=function(){var e=[n.h,n.s,n.v];e[0]=parseFloat(e[0].toFixed(0)),e[1]=parseFloat(e[1].toFixed(2)),e[2]=parseFloat(e[2].toFixed(2)),t.onchange(e)};n.kill=function(){i.removeEventListener("mousedown",P),window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",D),e.hide()},e.show(n)}}(),s.add({type:"number",tags:["ui"],initWidget:function(e){var t=e.options,n=new s.ui.Scrubber({min:t.min,max:t.max,step:t.step,value:e.getData("value"),onstart:function(){e.top.activePreview=e},onstop:function(){e.top.activePreview=null},onchange:function(t){e.setData("value",t)}});e.dom=n.dom;var i=null,o=30;e.dom.onmouseenter=function(){if(e.top.canPreview("numbers")){e.previewData=c(e.data);var t=Math.abs(.05*e.data.value);0==t&&(t=1);var n=0;i=setInterval(function(){if(!e.top.canPreview("numbers"))return a();n+=Math.TAU/o/.25,e.previewData.value=e.data.value+Math.sin(n)*t,e.update(),n>Math.TAU&&a()},1e3/o)}};var a=function(){i&&clearInterval(i),e.previewData=null};e.dom.onmouseleave=a},onget:function(e){return e.data.value},placeholder:{value:3}}),s.add({type:"button",tags:["ui"],initWidget:function(e){var t=document.createElement("div");t.className="joy-save",e.dom=t,e.saveButton=new s.ui.Button({label:e.options.label||"--",onclick:function(){e.update()}}),t.appendChild(e.saveButton.dom)}}),s.add({type:"color",tags:["ui"],initWidget:function(e){var t=new s.ui.Button({label:"&nbsp;",onclick:function(){s.modal.Color({source:e.dom,value:e.getData("value"),onchange:function(t){e.setData("value",t),n()},onopen:function(){e.top.activePreview=e},onclose:function(){e.top.activePreview=null}})},styles:["joy-color"]});e.dom=t.dom;var n=function(){var n=e.getData("value");t.dom.style.background=j(n)};n();var i,o,a=null,r=30;e.dom.onmouseenter=function(){e.top.canPreview("numbers")&&(e.data.value[2],e.previewData=c(e.data),o=0,i=2/r*2,a=setInterval(function(){if(!e.top.canPreview("numbers"))return l();var t=e.previewData.value;t[2]+=i,t[2]>1&&(t[2]=1,i*=-1),t[2]<0&&(t[2]=0,i*=-1),e.update(),o+=2/r,o>=1&&l()},1e3/r))};var l=function(){a&&clearInterval(a),e.previewData=null,e.update()};e.dom.onmouseleave=l},onget:function(e){return j(e.data.value)},placeholder:function(){var e=Math.floor(360*Math.random());return[e,.8,1]}}),s.add({type:"choose",tags:["ui"],initWidget:function(e){for(var t=e.data,n=e.options,i=0;i<n.length;i++){var o=n[i];void 0!==o.label&&void 0!==o.value||(n[i]={label:o.toString(),value:o})}var a=new s.ui.ChooserButton({value:t.value,options:n,onchange:function(n){t.value=n,e.update()},styles:e.styles});e.dom=a.dom},onget:function(e){return e.data.value}}),s.add({type:"string",tags:["ui"],initWidget:function(e){var t=e.options;e.stringUI=new s.ui.String({prefix:t.prefix,suffix:t.suffix,color:t.color,value:e.getData("value"),onchange:function(t){e.setData("value",t)}}),e.dom=e.stringUI.dom,e.onDataChange=function(){var t=e.getData("value");e.stringUI.setString(t)}},onget:function(e){return e.data.value},placeholder:"???"}),s.add({type:"save",tags:["ui"],initWidget:function(e){var t=document.createElement("div");t.className="joy-save",e.dom=t,e.saveButton=new s.ui.Button({label:"save",onclick:function(){var t=s.saveToURL(e.top.data);e.url.setValue(t),e.url.select();t.length;e.info.innerHTML="P.S: you can shorten your link with <a href='http://tinyurl.com/' target='_blank'>TinyURL</a>!"}}),t.appendChild(e.saveButton.dom),e.url=new s.ui.TextBox({readonly:!0}),t.appendChild(e.url.dom),e.info=document.createElement("div"),e.info.id="joy-save-info",t.appendChild(e.info)}}),s.add({type:"ops",tags:["ui"],init:function(e){void 0!==e.resetVariables&&(e.data.resetVariables=e.resetVariables)},initWidget:function(e){var t=e.data,n=t.ops,i=document.createElement("div");i.className="joy-ops",e.dom=i;var o=document.createElement("list");o.id="joy-list",i.appendChild(o);var a=[{label:"Add op above",value:"op_above"},{label:"Add op below",value:"op_below"},{label:"Delete",value:"delete"}],r=function(t,i){var a=0;if("op_above"==i&&(a=-1),"op_below"==i&&(a=1),0!=a){var r=e.entries.indexOf(t);a>0&&(r+=1),s.modal.Chooser({position:"below",source:t.bullet.dom,options:v,onchange:function(t){_(t,r),e.update(),h()}})}"delete"==i&&(u(e.entries,t),u(n,t.opData),e.removeChild(t.op),o.removeChild(t.dom),e.update(),h())},l=function(e){var t=new s.ui.ChooserButton({position:"below",staticLabel:m(e),options:a,onchange:function(t){r(e,t)},styles:["joy-bullet"]});return t.dom.id="joy-bullet",t},m=function(t){var n,i=e.entries.indexOf(t)+1,o=0,a=e.parent;while(a)"ops"==a.type&&o++,a=a.parent;switch(o%3){case 0:n=i;break;case 1:n=p(i);break;case 2:n=d(i);break}return n},h=function(){for(var t=0;t<e.entries.length;t++){var n=e.entries[t],i=n.bullet,o=m(n);i.setLabel(o)}};e.entries=[];for(var f=function(t,n){var a={},r=document.createElement("div");void 0===n&&(n=e.entries.length),e.entries.splice(n,0,a),o.insertBefore(r,o.children[n]);var s=l(a),u=document.createElement("div");u.id="joy-bullet-container",r.appendChild(u),u.appendChild(s.dom);var d=e.addChild({type:t.type},t),p=d.createWidget();p.id="joy-widget",r.appendChild(p),a.dom=r,a.bullet=s,a.op=d,a.widget=p,a.opData=t;var m,h,f=function(t){var n=t.offsetY/s.dom.getBoundingClientRect().height;n<0&&(n=0),n>1&&(n=1),m._PREVIEW=n,e.update()};return u.onmouseenter=function(t){if(e.top.canPreview("ops")){e.top.activePreview=e,e.previewData=c(e.data);var n=e.entries.indexOf(a);m=e.previewData.ops[n],e.previewData.ops.splice(n+1,0,{STOP:!0}),f(t),h=document.createElement("style"),document.head.appendChild(h),h.sheet.insertRule(".joy-ops.joy-previewing > #joy-list > div:nth-child(n+"+(n+2)+") { opacity:0.1; }"),h.sheet.insertRule(".joy-ops.joy-previewing > div.joy-bullet { opacity:0.1; }"),i.classList.add("joy-previewing")}},u.onmousemove=function(t){e.previewData&&f(t)},u.onmouseleave=function(){e.previewData&&(e.previewData=null,e.top.activePreview=null,e.update(),document.head.removeChild(h),i.classList.remove("joy-previewing"))},a},g=0;g<n.length;g++)f(n[g]);var _=function(e,t){var i={type:e};void 0===t?n.push(i):n.splice(t,0,i);f(i,t)},v=[];if(e.onlyOps)for(g=0;g<e.onlyOps.length;g++){var w=e.onlyOps[g],b=s.getTemplateByType(w),y=b.tags.filter(function(e){return"op"!=e})[0];v.push({label:b.name,value:w,category:y})}else{var k=s.getTemplatesByTag("op");for(g=0;g<k.length;g++){var x=k[g];y=x.tags.filter(function(e){return"op"!=e})[0];v.push({label:x.name,value:x.type,category:y})}}var j=new s.ui.ChooserButton({staticLabel:"+",options:v,onchange:function(t){_(t),e.update()},styles:["joy-bullet"]});i.appendChild(j.dom)},onexecute:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.target._variables||(t.target._variables={}),t.data.resetVariables&&(t.target._variables={}),n=0;case 3:if(!(n<t.data.ops.length)){e.next=30;break}if(i=t.data.ops[n],!i.STOP){e.next=7;break}return e.abrupt("return","STOP");case 7:return o=t.op.entries[n].op,e.next=10,o.execute(t.target,i);case 10:if(a=e.sent,!a||!a.target){e.next=15;break}t.target=a.target,e.next=27;break;case 15:if(!a||!a.error){e.next=20;break}return console.error("ops stopped with error: ",a),e.abrupt("return",a);case 20:if(!a||!a.stop){e.next=25;break}return console.log("ops interrupted at step ",n,a),e.abrupt("return",a);case 25:if("STOP"!=a){e.next=27;break}return e.abrupt("return",a);case 27:n++,e.next=3;break;case 30:return e.abrupt("return",t);case 31:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),placeholder:{ops:[],resetVariables:!0}}),s.module("instructions",function(){s.add({name:"Repeat the following...",type:"instructions/repeat",tags:["instructions","op"],init:"Repeat the following {id:'count', type:'number', min:1, placeholder:3} times: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,i,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=1,void 0!==t.data._PREVIEW&&(n=t.data._PREVIEW),i=Math.floor(t.data.count*n),o=0;case 4:if(!(o<i)){e.next=27;break}return e.next=7,t.op.ops.execute(t.target);case 7:if(a=e.sent,!a||!a.target){e.next=12;break}t.target=a.target,e.next=24;break;case 12:if(!a.error){e.next=17;break}return console.error("op stopped with error: ",a),e.abrupt("return",a);case 17:if(!a.stop){e.next=22;break}return console.log("op interrupted at step ",o,a),e.abrupt("return",a);case 22:if("STOP"!=a){e.next=24;break}return e.abrupt("return",a);case 24:o++,e.next=4;break;case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}),s.add({name:"// Write a note",type:"instructions/comment",tags:["instructions","op"],initWidget:function(e){e.dom=document.createElement("div"),e.box=new s.ui.TextBox({multiline:!0,placeholder:"// your notes here",value:e.getData("value"),onchange:function(t){e.setData("value",t)},styles:["box"]}),e.dom.appendChild(e.box.dom)}})}),s.add({type:"variableName",tags:["ui"],init:function(e){var t=e.variableType,n=function(){var n=s.getReferencesByTag(e,t).map(function(e){return e.data.value}),i=0;return n.forEach(function(e){var t;"variable"==e&&(t=1);var n=e.match(/variable\s(\d+)/);n&&(t=parseInt(n[1])),i<t&&(i=t)}),0==i?"variable":"variable "+(i+1)};e._createNewReference=function(){var i={value:n(),color:P()},o=s.createReference(e,t,i);e.setData("refID",o.id,!0),s.connectReference(e,o.id)};var i=e.getData("refID");if(i)s.connectReference(e,i);else{var o=s.getReferencesByTag(e,t);if(e.startWithExisting&&o.length>0){var a=o[o.length-1];i=a.id,e.setData("refID",i,!0),s.connectReference(e,i)}else e._createNewReference()}e._switchReference=function(t){var n=e.getData("refID");s.disconnectReference(e,n),e.setData("refID",t),s.connectReference(e,t)}},initWidget:function(e){e.dom=document.createElement("span");var t=e.getData("refID"),n=s.getReferenceById(e,t).data,i=e.addChild({type:"string",prefix:"[",suffix:"]",color:n.color},n),o=i.createWidget();e.dom.appendChild(o);var a=i.onDataChange;i.onDataChange=function(){a();var e=i.getData("color");i.stringUI.setColor(e)};var r=e.variableType,c=function(){var t=[],n=s.getReferencesByTag(e,r),o=e.getData("refID");n.forEach(function(e){if(e.id!=o){var n=e.data.color;n=j(n[0],n[1],n[2]),t.push({label:"["+e.data.value+"]",value:e.id,color:n})}}),t.push({category:"meta",label:"(+new)",value:"NEW"}),t.push({category:"meta",label:"(change color)",value:"CHANGE_COLOR"}),s.modal.Chooser({source:e.dom,options:t,onchange:function(t){if("CHANGE_COLOR"==t)s.modal.Color({source:e.dom,value:i.getData("color"),onchange:function(e){i.setData("color",e),i.stringUI.setColor(e)}});else{if("NEW"==t){var n=e.getData("refID");s.disconnectReference(e,n),e._createNewReference(),e.update()}else e._switchReference(t);var o=e.getData("refID"),a=s.getReferenceById(e,o);i.switchData(a.data)}}})};e.noChooser||(e.dom.onclick=c)},onget:function(e){var t=e.data.refID,n=s.getReferenceById(e.op,t);return n.data.value},onkill:function(e){var t=e.getData("refID");s.disconnectReference(e,t)}}),s.module("math",function(){s.modify("number","number_raw",function(e){return{init:function(e){if(!e.noVariables){var t=e.getData("value");"number"===typeof t&&(e.setData("value",void 0,!0),e.setData("chain",[{type:"number_raw",min:e.min,max:e.max,step:e.step,value:t}],!0)),e._makeNewChainOp=function(t,n){var i,o=t.type;switch(o){case"number_raw":i=e.addChild({type:o,min:t.min,max:t.max,step:t.step},t);break;case"variableName":i=e.addChild({type:o,variableType:"number",noChooser:!0},t);break;case"choose":i=e.addChild({type:o,options:[{label:"+",value:"+"},{label:"-",value:"-"},{label:"&times;",value:"*"},{label:"&divide;",value:"/"}],styles:["joy-math"]},t);break}var a=e.getData("chain");return void 0!==n?(e.chainOps.splice(n,0,i),a.splice(n,0,t)):(e.chainOps.push(i),a.push(t)),i},e.chainOps=[];var n=e.getData("chain"),i=c(n);n.splice(0,n.length);for(var o=0;o<i.length;o++)e._makeNewChainOp(i[o]);e._replaceChainOp=function(t,n){var i=e._deleteChainOp(t),o=e._makeNewChainOp(n,i);return e.update(),o},e._deleteChainOp=function(t){var n=e.chainOps.indexOf(t);u(e.chainOps,t),e.removeChild(t);var i=e.getData("chain");return i.splice(n,1),n}}},initWidget:function(t){if(t.noVariables)e.initWidget(t);else{t.dom=document.createElement("span"),t.dom.className="joy-number";var n=function(e){var n=[];if("number_raw"!=e.type){var i=t.placeholder.value;"number"===typeof i&&n.push({label:i,value:{type:"number_raw",value:i}})}var o,a=s.getReferencesByTag(t,"number");"variableName"==e.type&&(o=e.getData("refID")),a.forEach(function(e){if(e.id!=o){var t=e.data.color;t=j(t[0],t[1],t[2]),n.push({label:"["+e.data.value+"]",value:{type:"variableName",refID:e.id},color:t})}}),n.length>0&&s.modal.Chooser({source:e.dom,options:n,onchange:function(n){var i=t._replaceChainOp(e,n);t._replaceChainEntry(e,i)}})};t._chainEntries=[],t._makeChainEntry=function(e,o){var a=document.createElement("span");if(e.createWidget(),a.appendChild(e.dom),"choose"!=e.type){var r,c=new s.ui.Button({onclick:function(){i(r)},styles:["joy-more"]});a.appendChild(c.dom)}if(void 0!==o)if(o<t.dom.childNodes.length){var l=t.dom.childNodes[o];t.dom.insertBefore(a,l)}else t.dom.appendChild(a);else t.dom.appendChild(a);"choose"!=e.type&&function(e){var t;e.dom.addEventListener("mousedown",function(){t=+new Date}),e.dom.addEventListener("mouseup",function(){var i=+new Date;i-t<500&&n(e)})}(e),r={widget:a,op:e},void 0!==o?t._chainEntries.splice(o,0,r):t._chainEntries.push(r)},t._deleteChainEntry=function(e){var n=t._chainEntries.find(function(t){return t.op==e}),i=t._chainEntries.indexOf(n),o=n.widget;return t.dom.removeChild(o),u(t._chainEntries,n),i},t._replaceChainEntry=function(e,n){var i=t._deleteChainEntry(e);t._makeChainEntry(n,i)};for(var i=function(e){var n=e.widget.innerText,i=[{label:n+" + 2",value:"+"},{label:n+" - 2",value:"-"},{label:n+" &times; 2",value:"*"},{label:n+" &divide; 2",value:"/"}],o=t._chainEntries.indexOf(e);if(t._chainEntries.length>1){var a,r;a=0==o?o+1:o-1;var c=t._chainEntries[a].widget.innerText;r=0==o?n+" "+c:c+" "+n;var l=[o,a].sort();i.push({category:"meta",label:"(delete â"+r+"â)",value:l})}s.modal.Chooser({source:e.widget,options:i,onchange:function(n){if("string"===typeof n){var i=t._chainEntries.indexOf(e);i++;var o=t._makeNewChainOp({type:"choose",value:n},i);t._makeChainEntry(o,i),i++;var a=t._makeNewChainOp({type:"number_raw",value:2},i);t._makeChainEntry(a,i)}else for(var r=n,s=r.length-1;s>=0;s--){var c=r[s],l=t._chainEntries[c].op;t._deleteChainOp(l),t._deleteChainEntry(l)}t.update()}})},o=0;o<t.chainOps.length;o++){var a=t.chainOps[o];t._makeChainEntry(a)}}},onget:function(t){if(t.op.noVariables)return e.onget(t);for(var n=[],i=0;i<t.data.chain.length;i+=2){var o,a=t.op.chainOps[i];switch(a.type){case"number_raw":o=a.get(t.target);break;case"variableName":var r=t.target._variables,s=a.get(t.target);o=r[s];break}if(i>0){var c=t.op.chainOps[i-1],l=c.get();n.push(l)}n.push(o)}for(i=1;i<n.length;i+=2){l=n[i];if("*"==l||"/"==l){var u=n[i-1],d=n[i+1];p="*"==l?u*d:u/d,n.splice(i-1,3,p),i-=2}}for(i=1;i<n.length;i+=2){l=n[i];if("+"==l||"-"==l){var p;u=n[i-1],d=n[i+1];p="+"==l?u+d:u-d,n.splice(i-1,3,p),i-=2}}return n[0]}}}),s.add({name:"Set [number]",type:"math/set",tags:["math","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to {id:'value', type:'number'}",onexecute:function(e){var t=e.target._variables,n=e.data.varname;t[n]=e.data.value}}),s.add({name:"Do math to [number]",type:"math/operation",tags:["math","op"],init:JSON.stringify({id:"operation",type:"choose",placeholder:"+",options:[{label:"+ Increase",value:"+"},{label:"- Decrease",value:"-"},{label:"&times; Multiply",value:"*"},{label:"&divide; Divide",value:"/"}]})+" {id:'varname', type:'variableName', variableType:'number', startWithExisting:true} by {id:'value', type:'number'}",onexecute:function(e){var t=e.target._variables,n=e.data.varname;switch(void 0===t[n]&&(t[n]=0),e.data.operation){case"+":t[n]+=e.data.value;break;case"-":t[n]-=e.data.value;break;case"*":t[n]*=e.data.value;break;case"/":t[n]/=e.data.value;break}}}),s.add({name:"If [math] then...",type:"math/if",tags:["math","op"],init:"If {id:'value1', type:'number'} {id:'test', type:'choose', options:['<','â¤','=','â¥','>'], placeholder:'='} {id:'value2', type:'number'}, then: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(e){var t,n=e.data.value1,i=e.data.value2;switch(e.data.test){case"<":t=n<i;break;case"â¤":t=n<=i;break;case"=":t=n==i;break;case"â¥":t=n>=i;break;case">":t=n>i;break}if(t){var o=e.op.ops.execute(e.target);if("STOP"==o)return o}}})}),s.module("random",function(){s.add({name:"With a X% chance...",type:"random/if",tags:["random","op"],init:"With a {id:'chance', type:'number', min:0, max:100, placeholder:50}% chance, do:{id:'ops', type:'ops', resetVariables:false}",onexecute:function(e){var t=e.data.chance/100;if(Math.random()<t){var n=e.op.ops.execute(e.target);if("STOP"==n)return n}}}),s.add({name:"Set random [number]",type:"random/set",tags:["random","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to a random {id:'numtype', type:'choose', options:['number','integer'], placeholder:'number'} between {id:'min', type:'number', placeholder:1} and {id:'max', type:'number', placeholder:100}",onexecute:function(e){var t,n=e.target._variables,i=e.data.varname,o=e.data.min,a=e.data.max,r=Math.min(o,a),s=Math.max(o,a);t="integer"==e.data.numtype?r+Math.floor(Math.random()*(s-r+1)):r+Math.random()*(s-r),n[i]=t}})})}).call(this,n("dd40")(e))},"6b72":function(e,t,n){},"6e89":function(e,t,n){},"733d":function(e){e.exports={BrowserFS:{uri:"https://imjoy-team.github.io/imjoy-core-plugins/BrowserFS.imjoy.html",startup:!1},"Jupyter-Engine-Manager":{uri:"https://imjoy-team.github.io/jupyter-engine-manager/Jupyter-Engine-Manager.imjoy.html",startup:!0},"Jupyter-Notebook":{uri:"https://imjoy-team.github.io/jupyter-engine-manager/Jupyter-Notebook.imjoy.html",startup:!1}}},"735f":function(e,t,n){},"77b0":function(e,t,n){"use strict";var i=n("f51c"),o=n.n(i);o.a},"7a61":function(e,t,n){"use strict";var i=n("5e6b"),o=n.n(i);o.a},"7c77":function(e,t,n){},"7dba":function(e,t,n){},"7dd5":function(e,t,n){"use strict";var i=n("3de5"),o=n.n(i);o.a},"7f55":function(e,t,n){"use strict";var i=n("f397"),o=n.n(i);o.a},8307:function(e,t,n){"use strict";var i=n("cade"),o=n.n(i);o.a},"84f3":function(e,t,n){"use strict";var i=n("11a5"),o=n.n(i);o.a},8848:function(e,t,n){},9224:function(e){e.exports={a:"0.10.25"}},9428:function(e,t,n){},"9a0e":function(e,t,n){"use strict";var i=n("8848"),o=n.n(i);o.a},"9e742":function(e,t,n){"use strict";var i=n("21f5"),o=n.n(i);o.a},"9efd":function(e,t,n){"use strict";var i=n("735f"),o=n.n(i);o.a},a4ec:function(e,t){e.exports='<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "web-python",\n  "version": "0.1.0",\n  "description": "[TODO: describe this plugin with one sentence.]",\n  "tags": [],\n  "ui": "",\n  "cover": "",\n  "inputs": null,\n  "outputs": null,\n  "flags": [],\n  "icon": "extension",\n  "api_version": "0.1.7",\n  "env": "",\n  "permissions": [],\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="python">\nfrom imjoy import api\n\nclass ImJoyPlugin():\n    def setup(self):\n        api.log(\'initialized\')\n\n    def run(self, ctx):\n        api.alert(\'hello world.\')\n\napi.export(ImJoyPlugin())\n<\/script>\n'},a6c7:function(e,t,n){"use strict";var i=n("d4d1"),o=n.n(i);o.a},a773:function(e,t,n){},ad7a:function(e,t,n){},c0e0:function(e,t,n){"use strict";var i=n("c146"),o=n.n(i);o.a},c146:function(e,t,n){},ca41:function(e,t){e.exports='<docs lang="markdown">\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "window",\n  "tags": [],\n  "ui": "",\n  "version": "0.1.0",\n  "cover": "",\n  "description": "[TODO: describe this plugin with one sentence.]",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "api_version": "0.1.7",\n  "env": "",\n  "permissions": [],\n  "requirements": [],\n  "dependencies": [],\n  "defaults": {"w": 20, "h": 10}\n}\n</config>\n\n<script lang="javascript">\nclass ImJoyPlugin {\n  async setup() {\n    api.log(\'initialized\')\n  }\n\n  async run(ctx) {\n\n  }\n}\n\napi.export(new ImJoyPlugin())\n<\/script>\n\n<window lang="html">\n  <div>\n    <p>\n    Hello World\n    </p>\n  </div>\n</window>\n\n<style lang="css">\n\n</style>\n'},ca44:function(e,t,n){},cade:function(e,t,n){},cb3a:function(e,t){e.exports='<docs>\n[TODO: write documentation for this plugin.]\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "type": "web-worker",\n  "tags": [],\n  "ui": "",\n  "version": "0.1.0",\n  "cover": "",\n  "description": "[TODO: describe this plugin with one sentence.]",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "api_version": "0.1.7",\n  "env": "",\n  "permissions": [],\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="javascript">\nclass ImJoyPlugin {\n  async setup() {\n    api.log(\'initialized\')\n  }\n\n  async run(ctx) {\n    api.alert(\'hello world.\')\n  }\n}\n\napi.export(new ImJoyPlugin())\n<\/script>\n'},ceea:function(e,t,n){"use strict";var i=n("9428"),o=n.n(i);o.a},d4d1:function(e,t,n){},f397:function(e,t,n){},f51c:function(e,t,n){},f560:function(e,t,n){"use strict";var i=n("3d32"),o=n.n(i);o.a},f77d:function(e,t,n){"use strict";var i=n("0798"),o=n.n(i);o.a},f94b:function(e,t,n){"use strict";var i=n("fba3"),o=n.n(i);o.a},f9cf:function(e,t,n){},fb5a:function(e,t,n){"use strict";var i=n("6e89"),o=n.n(i);o.a},fba3:function(e,t,n){},fd0e:function(e,t,n){}});
//# sourceMappingURL=app.84cc8297.js.map